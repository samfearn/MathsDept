<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Analysis in Many Variables II – Lecture Notes Michaelmas 2022</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <link rel="stylesheet" href="https://samfearn.github.io/latex.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <script type="text/x-mathjax-config">
  	MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "ams"} } });
  	// I need to wait until MathJax has finished before running the numbering script
  	MathJax.Hub.Register.StartupHook("End",function(){doNumbering()});
  </script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Analysis in Many Variables II – Lecture Notes Michaelmas 2022</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#sec:differentiabilityofscalarfields"><span class="toc-section-number">0</span> Differentiability of scalar fields</a>
<ul>
<li><a href="#sub:continuity"><span class="toc-section-number">0.1</span> Continuity</a></li>
<li><a href="#sub:opensets"><span class="toc-section-number">0.2</span> Open sets</a></li>
<li><a href="#sub:differentiablemapsfromrntor"><span class="toc-section-number">0.3</span> Differentiable maps <span class="math inline">\(\mathbb{R}^n\to \mathbb{R}\)</span></a></li>
<li><a href="#sub:continuous_differentiability"><span class="toc-section-number">0.4</span> Continuous Differentiability</a></li>
<li><a href="#sub:thechainrulerevisited"><span class="toc-section-number">0.5</span> The chain rule revisited</a></li>
<li><a href="#the-implicit-function-theorem"><span class="toc-section-number">0.6</span> The implicit function theorem</a></li>
<li><a href="#implicit-function-theorem-for-surfaces">Implicit function theorem for surfaces</a></li>
</ul></li>
</ul>
</nav>
<p> </p>
<p><span>Michaelmas AMV Notes<br />
<br />
</span> The lecture notes for this term were originally prepared by Drs. Emma Coutts and Ian Vernon and Professor Patrick Dorey, and have been edited slightly since. If you find any typos, please let me know.<br />
</p>
<section id="sec:differentiabilityofscalarfields" class="level1" data-number="1">
<h1 data-number="0"><span class="header-section-number">0</span> Differentiability of scalar fields</h1>
<p>We first met <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu {}\)</span> in Section <a href="#sec:gradientofascalarfield" data-reference-type="ref" data-reference="sec:gradientofascalarfield">[sec:gradientofascalarfield]</a>, when trying to work out how a scalar field <span class="math inline">\(f(\underline{x})\)</span> varied as we moved along a parametric curve <span class="math inline">\(\underline{x}(t)\)</span>, <span class="math display">\[\frac{d f(\underline{x}(t))}{d t} = \frac{d \underline{x}(t)}{d t}. \underline{\nabla\mkern-2mu}\mkern 3mu {}f.\]</span> This follows from the chain rule, which as we noted at the end of Subsection <a href="#sub:partial_derivatives_and_the_chain_rule" data-reference-type="ref" data-reference="sub:partial_derivatives_and_the_chain_rule">[sub:partial_derivatives_and_the_chain_rule]</a>, holds for differentiable functions <span class="math inline">\(f\)</span>. So, when are our scalar fields differentiable?</p>
<p>In the Epiphany term of Calculus I, you saw that a function of two variables <span class="math inline">\(f(x,y)\)</span> was differentiable at a point <span class="math inline">\(\underline{x}_0=(x_0,y_0)\in D\)</span>, if <span class="math inline">\(\exists\; \delta &gt; 0\)</span> such that <span class="math inline">\(|\underline{x}- \underline{x}_0| &lt; \delta \implies \underline{x}\in D\)</span> and <span class="math display">\[\begin{equation} \label{eq:differentiablefuncoftwovars}
	f(x,y) = f(x_0,y_0) + M (x-x_0) + N (y - y_0) + R(x,y), \end{equation}\]</span> such that <span class="math display">\[\lim_{\underline{x}\to \underline{x}_0 }\frac{R(x,y)}{|\underline{x}- \underline{x}_0|} = 0.\]</span> You also saw that the constants <span class="math inline">\(M\)</span> and <span class="math inline">\(N\)</span> were given by the partial derivatives <span class="math inline">\(\frac{\partial f}{\partial x}(x_0,y_0)\)</span> and <span class="math inline">\(\frac{\partial f}{\partial y}(x_0,y_0)\)</span> respectively, and hence Equation <span class="math inline">\(\eqref{eq:differentiablefuncoftwovars}\)</span> can be written as <span class="math display">\[\begin{equation} \label{eq:differentiablefuncoftwovarspartials}
	f(x,y) - f(x_0,y_0) =  (x-x_0) \frac{\partial f}{\partial x}(x_0,y_0) + (y - y_0) \frac{\partial f}{\partial y}(x_0,y_0) + R(x,y), \end{equation}\]</span> where as before <span class="math display">\[\lim_{\underline{x}\to \underline{x}_0 }\frac{R(x,y)}{|\underline{x}- \underline{x}_0|} = 0.\]</span></p>
<p>We can understand this as saying that a function of two variables <span class="math inline">\(f(x,y)\)</span> is differentiable at a point <span class="math inline">\(\underline{x}_0\)</span>, if the function is ‘flat’ in a small neighbourhood of <span class="math inline">\(\underline{x}_0\)</span>. That is, if <span class="math inline">\(f\)</span> looks like a plane near <span class="math inline">\(\underline{x}_0\)</span>. This is because Equation <span class="math inline">\(\eqref{eq:differentiablefuncoftwovars}\)</span> (or equivalently Equation <span class="math inline">\(\eqref{eq:differentiablefuncoftwovarspartials}\)</span>) is linear in both the change in the <span class="math inline">\(x\)</span>-directional and in the <span class="math inline">\(y\)</span>-direction.</p>
<p>We now want to generalise this using vector notation to define when scalar fields <span class="math inline">\(f:\mathbb{R}^n \to \mathbb{R}\)</span> are differentiable.</p>
<div class="center">
<figure>
<img src="differentiablesurface.png" id="fig:differentiablesurface" style="width:50.0%" alt="" /><figcaption>In a small neighbourhood of the origin, the function <span class="math inline">\(f(x,y)=x^2 + y^2\)</span> looks like the plane <span class="math inline">\(z=0\)</span>.</figcaption>
</figure>
</div>
<section id="sub:continuity" class="level2" data-number="1.1">
<h2 data-number="0.1"><span class="header-section-number">0.1</span> Continuity</h2>
<p>Note that the definition of differentiability for a function of two variables requires us to define the limit <span class="math inline">\(\lim_{\underline{x}\to \underline{x}_0}\)</span>.</p>
<div id="def:limitinrn" class="definition">
<p> We say that a scalar field <span class="math inline">\(f(\underline{x}):\mathbb{R}^n \to \mathbb{R}\)</span> <em>tends to</em> <span class="math inline">\(L\)</span> as <span class="math inline">\(\underline{x}\)</span> <em>tends to</em> <span class="math inline">\(\underline{a}\)</span>, if the difference between <span class="math inline">\(f\)</span> and <span class="math inline">\(L\)</span> can be made as small as we please by taking <span class="math inline">\(\underline{x}\)</span> sufficiently close to <span class="math inline">\(\underline{a}\)</span> (without being equal to <span class="math inline">\(\underline{a}\)</span>).</p>
<p>We can phrase this more precisely, as <span class="math display">\[\begin{aligned}
			\lim_{\underline{x}\to \underline{a}} f(\underline{x}) &amp;= L  \quad  \text{ if } \quad  \forall \epsilon &gt; 0,\quad  \exists  \delta &gt; 0  \quad s.t. \nonumber \\
			|f(\underline{x}) -L| &amp;&lt; \epsilon \quad  \forall \underline{x}\quad  s.t. \quad  0 &lt; | \underline{x}- \underline{a}| &lt; \delta.
		\end{aligned}\]</span></p>
</div>
<p>We can now define what it means for a scalar field <span class="math inline">\(f\)</span> to be continuous in terms of this definition of the limit.</p>
<div id="def:continuityofscalarfield" class="definition">
<p> <span class="math inline">\(f(\underline{x})\)</span> is <u>continuous</u> at <span class="math inline">\(\underline{a}\)</span> if <span class="math inline">\(\lim_{\underline{x}\to \underline{a}} f(\underline{x})\)</span> exists and is equal to <span class="math inline">\(f(\underline{a})\)</span>.</p>
</div>
<div id="eg:limitsandcontinuity1" class="example">
<p> If <span class="math inline">\(f(\underline{x}) = x^2 + y^2\)</span> show that <span class="math inline">\(f(\underline{x})\)</span> is continuous at the origin.</p>
<p>Given <span class="math inline">\(\epsilon\)</span> pick <span class="math inline">\(\delta = \sqrt{\epsilon}\)</span>. Then <span class="math display">\[\begin{aligned}
			| \underline{x}| &amp;&lt; \delta  \\
			\Rightarrow\quad \quad\sqrt{x^2+y^2} &amp;&lt; \sqrt{\epsilon} \\
			\Rightarrow x^2+y^2 &amp;&lt; \epsilon.
		\end{aligned}\]</span></p>
<p>So for all <span class="math inline">\(\underline{x}\)</span> with <span class="math inline">\(0&lt;|\underline{x}| &lt; \delta\)</span> we have <span class="math display">\[\begin{aligned}
			|f(x)| &amp;= |f(x) -0| \;&lt;\; \epsilon  \\
			\Rightarrow\quad \quad\lim_{\underline{x}\to \underline{0}} f(\underline{x}) &amp;= 0.
		\end{aligned}\]</span></p>
<p>Since <span class="math inline">\(f(\underline{0})=0 = \lim_{\underline{x}\to \underline{0}}\)</span>, <span class="math inline">\(f(\underline{x})\)</span> is continuous at the origin.</p>
</div>
<div id="eg:limitsandcontinuity2" class="example">
<p> Show that <span class="math inline">\(f(\underline{x}) = \frac{xy}{x^2+y^2}\)</span> has no limit as <span class="math inline">\(\underline{x}\to \underline{0}\)</span> even though <span class="math inline">\(\lim_{x\to 0 } f(x,0)\)</span> and <span class="math inline">\(\lim_{y\to 0} f(0,y)\)</span> both exist (this illustrates the difference between limits in <span class="math inline">\(\mathbb{R}\)</span> and <span class="math inline">\(\mathbb{R}^2\)</span>).</p>
<p>For <span class="math inline">\(x \ne 0, f(x,0)=0\)</span> and for <span class="math inline">\(y\ne 0, f(0,y)\)</span> <span class="math display">\[\Rightarrow\quad \quad\lim_{x\to 0 } f(x,0) =0 \quad\text{ and } \quad\lim_{y\to 0} f(0,y) = 0,\]</span> so we would need <span class="math inline">\(\lim_{\underline{x}\to \underline{0}} f(\underline{x}) = 0\)</span>. To prove this we would need to show that for any <span class="math inline">\(\epsilon\)</span> (in particular small values), there’s a <span class="math inline">\(\delta\)</span> such that <span class="math display">\[\left| \frac{xy}{x^2+y^2} \right| \;&lt;\; \epsilon \quad\forall \underline{x}\quad s.t. \quad 0 &lt; | \underline{x}| &lt; \delta.\]</span></p>
<p>But if <span class="math inline">\(y=x\)</span> then <span class="math display">\[\left| \frac{xy}{x^2+y^2} \right| \;=\; \left| \frac{x^2}{x^2+x^2} \right| \;=\; \frac{1}{2} \quad\text{ for all $x$, (even very small!)}\]</span> so the condition can’t be fulfilled. Therefore, <span class="math inline">\(f(\underline{x})\)</span> is not continuous at the origin.</p>
</div>
<p>However, the following results help to prove when functions <u>are</u> continuous:</p>
<div id="thm:continuousfunctions" class="theorem">
<ol>
<li><p>If <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are continuous functions at <span class="math inline">\(\underline{a}\)</span> then so are</p>
<ul>
<li><p><span class="math inline">\(f+g\)</span>,</p></li>
<li><p><span class="math inline">\(fg\)</span>,</p></li>
<li><p>and <span class="math inline">\(\frac{f}{g}\)</span>, provided that <span class="math inline">\(g(\underline{a}) \ne 0\)</span>.</p></li>
</ul></li>
<li><p>Both <span class="math display">\[\begin{aligned}
				f(\underline{x}) &amp;= \text{constant},  \\
				\text{and} \quad \quad f(\underline{x}) &amp;= f(x_1,x_2,\dots, x_n) \;=\; x_a, \quad a=1,\dots, n
			\end{aligned}\]</span> are continuous at all points in <span class="math inline">\(\mathbb{R}^n\)</span>.</p></li>
</ol>
<p>The proof of this theorem is left as an exercise.</p>
</div>
<div id="eg:continuitytheorem" class="example">
<p> <span class="math inline">\(f(x,y)=x\)</span> and <span class="math inline">\(g(x,y) = y\)</span> are both continuous at the origin by part 2 of Theorem <a href="#thm:continuousfunctions" data-reference-type="ref" data-reference="thm:continuousfunctions">[thm:continuousfunctions]</a>, and so by repeated use of part 1 of the theorem, so is <span class="math display">\[h(x,y) \;=\; \frac{x^3 - y^3}{1+x^2}.\]</span></p>
</div>
</section>
<section id="sub:opensets" class="level2" data-number="1.2">
<h2 data-number="0.2"><span class="header-section-number">0.2</span> Open sets</h2>
<p>The definition of the limit of <span class="math inline">\(f\)</span> as <span class="math inline">\(\underline{x}\to \underline{a}\)</span> (Definition <a href="#def:limitinrn" data-reference-type="ref" data-reference="def:limitinrn">[def:limitinrn]</a>) requires us to consider the set of all points <span class="math inline">\(\underline{x}\)</span> such that <span class="math inline">\(0 &lt; |\underline{x}- \underline{a} | &lt; \delta\)</span> for a <span class="math inline">\(\delta &gt; 0\)</span>. To define differentiability for our scalar fields, we therefore want to introduce the notion of an <em>open set</em>, where the assumption that such points exist in the domain of our function <span class="math inline">\(f\)</span> is satisfied.</p>
<p>We therefore make the following definitions, each of which may be well understood by the accompanying figure.</p>
<div id="def:openball" class="definition">
<p> An <u>open ball</u> with centre <span class="math inline">\(\underline{a}\in \mathbb{R}^n\)</span> and radius <span class="math inline">\(\delta &gt;0\)</span> is the set of points <span class="math display">\[B_\delta (\underline{a}) \;=\; \{\underline{x}\in \mathbb{R}^n: |\underline{x}- \underline{a}| &lt; \delta \}.\]</span> An example of an open ball of radious <span class="math inline">\(\delta\)</span> about the point <span class="math inline">\(\underline{a}\in \mathbb{R}^n\)</span> is shown in Figure <a href="#fig:openball" data-reference-type="ref" data-reference="fig:openball">2</a>.</p>
</div>
<div class="center">
<figure>
<img src="openball.jpeg" id="fig:openball" style="width:50.0%" alt="" /><figcaption>An open ball of radius <span class="math inline">\(\delta\)</span> about the point <span class="math inline">\(\underline{a} \in \mathbb{R}^n\)</span>.</figcaption>
</figure>
</div>
<div id="def:openset" class="definition">
<p> A subset <span class="math inline">\(S\)</span> of <span class="math inline">\(\mathbb{R}^n\)</span> is <u>open</u> (<span class="math inline">\(S\)</span> is an <u>open set</u>) if for each point <span class="math inline">\(\underline{a}\in S\)</span> there is an open ball <span class="math inline">\(B_\delta (\underline{a})\)</span> which is also in <span class="math inline">\(S\)</span> (where <span class="math inline">\(\delta\)</span> might depend on <span class="math inline">\(\underline{a}\)</span>).</p>
<p>An example of an open set <span class="math inline">\(S\)</span> is shown in Figure <a href="#fig:openset" data-reference-type="ref" data-reference="fig:openset">3</a>, where an open ball around a point <span class="math inline">\(\underline{a}\)</span> is shown.</p>
</div>
<div class="center">
<figure>
<img src="openset.jpeg" id="fig:openset" style="width:50.0%" alt="" /><figcaption>An open set <span class="math inline">\(S \subset \mathbb{R}^n\)</span>, with the open ball around a point <span class="math inline">\(\underline{a} \in S\)</span> shown.</figcaption>
</figure>
</div>
<div id="def:neighbourhood" class="definition">
<p> A <u>neighbourhood</u> <span class="math inline">\(N\)</span> of a point <span class="math inline">\(\underline{a}\in \mathbb{R}^n\)</span> is a subset of <span class="math inline">\(\mathbb{R}^n\)</span> which includes an open set containing <span class="math inline">\(\underline{a}\)</span>.</p>
<p>A neighbourhood <span class="math inline">\(N\)</span> of a point <span class="math inline">\(\underline{a} \in \mathbb{R}^n\)</span> is shown in Figure <a href="#fig:neighbourhood" data-reference-type="ref" data-reference="fig:neighbourhood">4</a>, where an open set <span class="math inline">\(S\)</span> around <span class="math inline">\(\underline{a}\)</span> is shown.</p>
</div>
<div class="center">
<figure>
<img src="neighbourhood.jpeg" id="fig:neighbourhood" style="width:50.0%" alt="" /><figcaption>A neighbourhood <span class="math inline">\(N\)</span> of a point <span class="math inline">\(\underline{a} \in \mathbb{R}^n\)</span>, with an open set <span class="math inline">\(S\)</span> around <span class="math inline">\(\underline{a}\)</span> shown.</figcaption>
</figure>
</div>
<div id="def:closedset" class="definition">
<p> A set <span class="math inline">\(S\subseteq \mathbb{R}^n\)</span> is <u>closed</u> if its complement in <span class="math inline">\(\mathbb{R}^n\)</span> (<span class="math inline">\(S^c \equiv \mathbb{R}^n\setminus S\)</span>, points not in <span class="math inline">\(S\)</span>) is open e.g. <span class="math display">\[\bar{B}_\delta (\underline{a}) \;=\; \{\underline{x}\in \mathbb{R}^n: |\underline{x}- \underline{a}| \le \delta \}\]</span> is the closed ball. The complement of the closed ball, <span class="math display">\[\bar{B}^c_\delta (\underline{a}) \;=\; \{\underline{x}\in \mathbb{R}^n: |\underline{x}- \underline{a}| &gt; \delta \}\]</span> is an open set, and so the closed ball is closed.</p>
</div>
<div id="eg:openandclosedsets" class="example">
<ul>
<li><p><span class="math inline">\(D= \{ (x,y) \in \mathbb{R}^2 : x&gt;0\}\)</span> is open, as given <span class="math inline">\(\underline{a}=(a_1,a_2) \in D\)</span>, pick <span class="math inline">\(\delta=a_1/2\)</span> then <span class="math inline">\(B_\delta (\underline{a})\)</span> is in <span class="math inline">\(D\)</span>. This is demonstrated in Figure <a href="#fig:opensetD" data-reference-type="ref" data-reference="fig:opensetD">6</a>.</p>
<table id="fig:opensetD" class="imageTable">
<caption>The set <span class="math inline">\(D= \{ (x,y) \in \mathbb{R}^2 : x&gt;0\}\)</span> is an open set, as we can find an open ball around every point in <span class="math inline">\(D\)</span>.</caption>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="setd.jpeg" title="fig:" id="fig:opensetD" style="width:40.0%" alt="The set D= \{ (x,y) \in \mathbb{R}^2 : x&gt;0\} is an open set, as we can find an open ball around every point in D." />  </td>
<td style="text-align: center;">  <img src="ballinD.jpeg" title="fig:" id="fig:opensetD" style="width:40.0%" alt="The set D= \{ (x,y) \in \mathbb{R}^2 : x&gt;0\} is an open set, as we can find an open ball around every point in D." /></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">The open set <span class="math inline">\(D\)</span></td>
<td style="text-align: center;">An open ball in <span class="math inline">\(D\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table></li>
<li><p><span class="math inline">\(E=\{(x,y) \in \mathbb{R}^2: x\ge 0 \}\)</span> is <u>not</u> open, as e.g. the point <span class="math inline">\((0,0)\)</span> is in <span class="math inline">\(E\)</span>, but for all <span class="math inline">\(\delta&gt;0\)</span> there are points in <span class="math inline">\(B_\delta (\underline{0})\)</span> not in <span class="math inline">\(E\)</span>. This is demonstrated in Figure <a href="#fig:closedsetE" data-reference-type="ref" data-reference="fig:closedsetE">8</a>. Set <span class="math inline">\(E\)</span> is a closed set, as the complement of <span class="math inline">\(E\)</span>, <span class="math inline">\(E^c = \{ (x,y) \in \mathbb{R}^2: x&lt;0 \}\)</span> is an open set.</p>
<table id="fig:closedsetE" class="imageTable">
<caption>The set <span class="math inline">\(E= \{ (x,y) \in \mathbb{R}^2 : x\ge 0\}\)</span> is not an open set, as we can find a point which isn’t contained in any open ball. This set is a closed set, as it is the complement of an open set.</caption>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="setE.jpeg" title="fig:" id="fig:closedsetE" style="width:40.0%" alt="The set E= \{ (x,y) \in \mathbb{R}^2 : x\ge 0\} is not an open set, as we can find a point which isn’t contained in any open ball. This set is a closed set, as it is the complement of an open set." />  </td>
<td style="text-align: center;">  <img src="ballinE.jpeg" title="fig:" id="fig:closedsetE" style="width:40.0%" alt="The set E= \{ (x,y) \in \mathbb{R}^2 : x\ge 0\} is not an open set, as we can find a point which isn’t contained in any open ball. This set is a closed set, as it is the complement of an open set." /></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">The set <span class="math inline">\(E\)</span></td>
<td style="text-align: center;">The origin in <span class="math inline">\(E\)</span> isn’t contained in any open ball</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table></li>
<li><p>Likewise <span class="math inline">\(F = \{(x,y)\in \mathbb{R}^2: 1&lt;x&lt;3,1&lt;y&lt;2\}\)</span> is open, but <span class="math inline">\(G = \{(x,y)\in \mathbb{R}^2: 1 \le x \le 3,1&lt;y&lt;2\}\)</span> is not (but <span class="math inline">\(G\)</span> is <u>not</u> closed either!). This is demonstrated in Figure <a href="#fig:setsFG" data-reference-type="ref" data-reference="fig:setsFG">10</a></p>
<table id="fig:setsFG" class="imageTable">
<caption>The set <span class="math inline">\(F= \{ (x,y) \in \mathbb{R}^2 : 1&lt;x&lt;3, 1&lt;y&lt;2\}\)</span> is an open set, but the set <span class="math inline">\(G= \{ (x,y) \in \mathbb{R}^2 : 1\le x \le 3, 1&lt;y&lt;2\}\)</span> is neither open (since points along the left and right edges aren’t contained in any open balls), nor closed (since the complement is the outside of the rectangle, along with the top and bottom edges of the rectangle, and hence contains points which aren’t contained in any open ball).</caption>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="setF.jpeg" title="fig:" id="fig:setsFG" style="width:40.0%" alt="The set F= \{ (x,y) \in \mathbb{R}^2 : 1&lt;x&lt;3, 1&lt;y&lt;2\} is an open set, but the set G= \{ (x,y) \in \mathbb{R}^2 : 1\le x \le 3, 1&lt;y&lt;2\} is neither open (since points along the left and right edges aren’t contained in any open balls), nor closed (since the complement is the outside of the rectangle, along with the top and bottom edges of the rectangle, and hence contains points which aren’t contained in any open ball)." />  </td>
<td style="text-align: center;">  <img src="setG.jpeg" title="fig:" id="fig:setsFG" style="width:40.0%" alt="The set F= \{ (x,y) \in \mathbb{R}^2 : 1&lt;x&lt;3, 1&lt;y&lt;2\} is an open set, but the set G= \{ (x,y) \in \mathbb{R}^2 : 1\le x \le 3, 1&lt;y&lt;2\} is neither open (since points along the left and right edges aren’t contained in any open balls), nor closed (since the complement is the outside of the rectangle, along with the top and bottom edges of the rectangle, and hence contains points which aren’t contained in any open ball)." /></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">The open set <span class="math inline">\(F\)</span></td>
<td style="text-align: center;">The set <span class="math inline">\(G\)</span> which is neither open nor closed</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table></li>
</ul>
</div>
<div id="eg:openballsopen" class="example">
<p> Every open ball <span class="math inline">\(B_\delta (\underline{a})\)</span> in <span class="math inline">\(\mathbb{R}^n\)</span> is open. The proof of this is left as exercise.</p>
</div>
<div id="def:continuousonset" class="definition">
<p> If <span class="math inline">\(U\)</span> is an open subset of <span class="math inline">\(\mathbb{R}^n\)</span> and <span class="math inline">\(f:U \to \mathbb{R}\)</span> is a function on <span class="math inline">\(U\)</span>, then <span class="math inline">\(f\)</span> is said to be continuous on <span class="math inline">\(U\)</span> if it is continuous at each point in <span class="math inline">\(U\)</span>.</p>
</div>
</section>
<section id="sub:differentiablemapsfromrntor" class="level2" data-number="1.3">
<h2 data-number="0.3"><span class="header-section-number">0.3</span> Differentiable maps <span class="math inline">\(\mathbb{R}^n\to \mathbb{R}\)</span></h2>
<p>We’re now ready to define what it means for a scalar field <span class="math inline">\(f(\underline{x}):\mathbb{R}^n \to \mathbb{R}\)</span> to be differentiable. Remember, a function of two variables <span class="math inline">\(f(x,y):D \to \mathbb{R}\)</span> for <span class="math inline">\(D\subseteq \mathbb{R}^2\)</span> was differentiable at a point <span class="math inline">\(\underline{x}_0=(x_0,y_0)\in D\)</span>, if <span class="math inline">\(\exists\; \delta &gt; 0\)</span> such that <span class="math inline">\(|\underline{x}- \underline{x}_0| &lt; \delta \implies \underline{x}\in D\)</span> and <span class="math display">\[f(x,y) - f(x_0,y_0) =  (x-x_0) \frac{\partial f}{\partial x}(x_0,y_0) + (y - y_0) \frac{\partial f}{\partial y}(x_0,y_0) + R(x,y), \quad \quad\quad \quad(\dagger)\]</span> such that <span class="math display">\[\lim_{\underline{x}\to \underline{x}_0 }\frac{R(x,y)}{|\underline{x}- \underline{x}_0|} = 0.\]</span></p>
<p>We can now generalise this to <span class="math inline">\(\mathbb{R}^n\)</span> using vector notation.</p>
<div id="def:differentiablescalarfield" class="definition">
<p> Suppose <span class="math inline">\(U\)</span> is an open set in <span class="math inline">\(\mathbb{R}^n\)</span>, and <span class="math inline">\(f:U\to \mathbb{R}\)</span> is a scalar field (function) on <span class="math inline">\(U\)</span>. <span class="math inline">\(f\)</span> is <u>differentiable</u> at <span class="math inline">\(\underline{a}\in U\)</span> if we can find a vector <span class="math inline">\(\underline{v}(\underline{a})\)</span> such that <span class="math display">\[\begin{aligned}
			f(\underline{a}+\underline{h}) - f(\underline{a}) &amp;= \underline{h}. \underline{v}(\underline{a}) + R(\underline{h}) \quad \quad\quad \quad(*) \\
			\text{with} \quad \quad\quad \quad\lim_{\underline{h}\to \underline{0}} \frac{R(\underline{h})}{|\underline{h}|} &amp;= 0 	\quad \quad\quad \quad(**)
		\end{aligned}\]</span></p>
</div>
<p>We can regard (*) in the definition as the definition of <span class="math inline">\(R(\underline{h})\)</span>, so part (**) is the meaningful part of the definition of differentiability for a scalar field. Note that the term <span class="math inline">\(\underline{h}. \underline{v}(\underline{a})\)</span> is linear in <span class="math inline">\(\underline{h}\)</span> (which represents the small difference between our points <span class="math inline">\(\underline{a}\)</span> and <span class="math inline">\(\underline{a}+ \underline{h}\)</span>). Equation (*) therefore takes the same form as Equation <span class="math inline">\((\dagger)\)</span> above, where the first two terms on the right-hand side are also linear in the differences <span class="math inline">\((x-x_0)\)</span> and <span class="math inline">\((y-y_0)\)</span>.</p>
<p>If <span class="math inline">\(\underline{v}\)</span> exists, it is equal to <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> since we could take <span class="math inline">\(\underline{h}= h \underline{e}_i\)</span>, so <span class="math inline">\(h=\pm |\underline{h}|\)</span> (i.e. <span class="math inline">\(|\underline{h}| = |h|\)</span>). Then by the definition of the gradient, <span class="math display">\[\begin{aligned}
		(\underline{\nabla\mkern-2mu}\mkern 3mu f)_i \;=\; \frac{\partial f}{\partial x_i} &amp;= \lim_{h\to 0} \frac{f(\underline{a}+ h \underline{e}_i) - f(\underline{a})}{h} \\
		&amp;= \lim_{h\to 0} \left[ \frac{ h \underline{e}_i . \underline{v}(\underline{a}) + R(\underline{h})} {h} \right] \quad \quad\text{by } (*) \\
		&amp;= \lim_{h\to 0}\left[  \underline{e}_i . \underline{v}(\underline{a}) + \frac{R(\underline{h})}{h} \right]  \\
		&amp;=  \underline{e}_i . \underline{v}(\underline{a}) \pm \lim_{h\to 0} \frac{R(\underline{h})}{|\underline{h}|}  \\
		&amp;=  \underline{e}_i . \underline{v}(\underline{a}) \pm0 \quad \quad\quad \quad\text{by } (**) \\
		&amp;= v_i(\underline{a}),
	\end{aligned}\]</span> i.e. the components of <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> are the components of <span class="math inline">\(\underline{v}\)</span>.</p>
<p><u>Warning</u>: the components of <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> might be well-defined at a point but this does <u>not</u> ensure that <span class="math inline">\(f\)</span> is differentiable there.</p>
<div id="eg:existenceofgradientdoesnotimplydifferentiability" class="example">
<p> <span class="math inline">\(f:\mathbb{R}^2 \Rightarrow\mathbb{R}\)</span> <span class="math display">\[f(x,y) \;=\; \left\{ \begin{array}{ll}
				\frac{xy}{x^2+y^2}  &amp; \underline{x}\ne \underline{0} \\
				0 	&amp;   \underline{x}=\underline{0} 	
				\end{array} \right.\]</span></p>
<p>At the origin <span class="math display">\[\frac{\partial f}{\partial x} \;=\; \lim_{h\to 0} \frac{f(h,0) - f(0,0)}{h} \;=\; \lim_{h \to 0} \frac{\frac{h.0}{h^2+0} -0}{h} \;=\; 0,\]</span> and similarly <span class="math inline">\(\frac{\partial f}{\partial y} =0\)</span> at origin, so <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{0})\)</span> has components <span class="math inline">\((0,0)\)</span>, and therefore if <span class="math inline">\(\underline{v}\)</span> exists it must be <span class="math inline">\((0,0)\)</span> as well.</p>
<p>Task 1: Define <span class="math inline">\(R\)</span>. With <span class="math inline">\(\underline{h}=(h_1, h_2)\)</span> <span class="math display">\[\begin{aligned}
			f(h_1,h_2)-f(0,0) &amp;= \underline{h}. \underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{0}) + R(\underline{h}) \\
					&amp;= 0 + R(\underline{h}) \\
			\Rightarrow\quad \quad R(\underline{h}) &amp;=&amp; \frac{h_1h_2}{h_1^2 + h_2^2}
		\end{aligned}\]</span></p>
<p>Task 2: Examine the behaviour of <span class="math inline">\(\lim_{\underline{h}\to \underline{0}} R(\underline{h})/|\underline{h}|\)</span>: <span class="math display">\[\begin{aligned}
			\frac{R(\underline{h})}{|\underline{h}|} &amp;= \left( \frac{h_1h_2}{h_1^2 + h_2^2} \right) / | \underline{h}| \\
			&amp;= \frac{h_1 h_2}{(h_1^2 + h_2^2)^{3/2}}
		\end{aligned}\]</span></p>
<p>On the line <span class="math inline">\(h_2=h_1\)</span>, <span class="math display">\[\begin{aligned}
			\frac{R(\underline{h})}{|\underline{h}|} &amp;=&amp; \frac{h_1^2}{(2h_1^2)^{3/2}} \\
			&amp;=&amp; \frac{1}{2^{3/2} |h_1| },
		\end{aligned}\]</span> which does not tend to zero as <span class="math inline">\(h_1 \to 0\)</span>, therefore <span class="math inline">\(\lim_{\underline{h}\to \underline{0}}R(\underline{h})/|\underline{h}|\)</span> does not exist, and so <span class="math inline">\(f\)</span> is <u>not</u> differentiable at the origin.</p>
<p>Note that for <span class="math inline">\(\underline{x}\ne \underline{0}\)</span>, <span class="math display">\[\begin{aligned}
			\frac{\partial f}{\partial x} \;=\; \frac{\partial}{\partial x} \left(\frac{xy}{x^2 + y^2}  \right)&amp;= \frac{y}{x^2+y^2} - \frac{2x^2 y}{(x^2 + y^2)^2} \\
			&amp;= \frac{y(y^2-x^2)}{(x^2+y^2)^2},
		\end{aligned}\]</span> so <span class="math inline">\(\frac{\partial f(0,y)}{\partial x} \;=\; \frac{1}{y}\)</span>, and <span class="math inline">\(\frac{\partial f}{\partial x}\)</span> is <u>not continuous</u> at <span class="math inline">\(\underline{0}\)</span>.</p>
</div>
</section>
<section id="sub:continuous_differentiability" class="level2" data-number="1.4">
<h2 data-number="0.4"><span class="header-section-number">0.4</span> Continuous Differentiability</h2>
<p>In fact there is a <u>theorem</u> that continuity of partial derivatives implies differentiability.</p>
<div id="thm:continuousdifferentiability" class="theorem">
<p> Let <span class="math inline">\(f:U \to \mathbb{R}\)</span> be a function on an open set <span class="math inline">\(U\subset \mathbb{R}^n\)</span>, and suppose <span class="math inline">\(\underline{a}\in U\)</span>. If all partial derivatives of <span class="math inline">\(f\)</span> exist and are continuous in a neighbourhood of <span class="math inline">\(\underline{a}\)</span>, then <span class="math inline">\(f\)</span> is differentiable at <span class="math inline">\(\underline{a}\)</span>.</p>
</div>
<p>(You can quote this theorem without proof.)</p>
<div id="def:continuouslydifferentiable" class="definition">
<p> A function is <u>continuously differentiable</u> at <span class="math inline">\(\underline{a}\)</span> if it and all of its partial derivatives exist and are continuous at <span class="math inline">\(\underline{a}\)</span>; it is <u>continuously differentiable on an open set <span class="math inline">\(U\)</span></u> if it and all of its partial derivatives exist and are continuous on <span class="math inline">\(U\)</span>.</p>
</div>
<p>By the theorem, if a function is continuously differentiable on an open set then it is also differentiable there. <u>This is important</u>: continuous differentiability is easier to check than differentiability.</p>
<p><u>Note</u>: function for which partial derivatives of all orders exist are called <u>smooth functions</u>.</p>
<div id="thm:continuousdifferentiablenewfromold" class="theorem">
<p> If <span class="math inline">\(f,g:U \to \mathbb{R}\)</span> (<span class="math inline">\(U\)</span> open in <span class="math inline">\(\mathbb{R}^n\)</span>) are differentiable (respectively smooth) at <span class="math inline">\(\underline{x}= \underline{a}\in U\)</span> then so are</p>
<ul>
<li><p><span class="math inline">\(f+g\)</span></p></li>
<li><p><span class="math inline">\(fg\)</span></p></li>
<li><p><span class="math inline">\(\frac{f}{g},\)</span> provided <span class="math inline">\(g(\underline{a}) \ne 0\)</span>.</p></li>
</ul>
</div>
<p>You can <u>quote</u> these facts!</p>
<div id="eg:continuousdifferentiability" class="example">
<p> Where is <span class="math inline">\(f(x,y) = y|x-2|\)</span> continuously differentiable and where is it differentiable? A plot of this function is shown in Figure <a href="#fig:notcontinuouslydifferentiable" data-reference-type="ref" data-reference="fig:notcontinuouslydifferentiable">11</a>.</p>
<div class="center">
<figure>
<img src="notcontinuouslydifferentiable.png" id="fig:notcontinuouslydifferentiable" style="width:60.0%" alt="" /><figcaption>A plot of the function <span class="math inline">\(f(x,y) = y |x-2|\)</span> for <span class="math inline">\(0\le x \le 4\)</span> and <span class="math inline">\(-5 \le y \le 5\)</span>.</figcaption>
</figure>
</div>
<p><u>Answer:</u> It is continuously differentiable where its partial derivatives are continuous. So calculate <span class="math display">\[\begin{aligned}
			\text{For } x&gt;2: \quad \quad f&amp;= y(x-2) \quad\Rightarrow\quad\frac{\partial f}{\partial x} \;=\; y, \quad\frac{\partial f}{\partial y} \;=\; x-2 \quad\text{(continuous)}  \\
			\text{For } x&lt;2: \quad \quad f&amp;= -y(x-2) \quad\Rightarrow\quad\frac{\partial f}{\partial x} \;=\; -y, \quad\frac{\partial f}{\partial y} \;=\; -x+2 \quad\text{(continuous).}
		\end{aligned}\]</span></p>
<p><span class="math display">\[\begin{aligned}
			\text{For } x=2: \quad \quad\frac{\partial f(2,y)}{\partial x} &amp;= \lim_{h\to 0} \frac{f(2+h,y) - f(2,y)}{h}  \\
					&amp;= \lim_{h\to 0} \frac{y |h|}{h}.
		\end{aligned}\]</span> For <span class="math inline">\(y\ne0\)</span>, the limit of this for <span class="math inline">\(h&lt;0\)</span> is different to the limit for <span class="math inline">\(h&gt;0\)</span>. Hence the limit does not exist, and so the partial derivative does not exist for <span class="math inline">\(x=2, y\ne 0\)</span>. If <span class="math inline">\(y=0\)</span>, the limit exists and is equal to 0.</p>
<p><span class="math display">\[\begin{aligned}
			\frac{\partial f(2,y)}{\partial y} &amp;= \lim_{h \to 0} \frac{f(2,y+h) -f(2,y)}{h} \\
			&amp;= \lim_{h\to 0} \frac{0-0}{h}  \;=\; 0
		\end{aligned}\]</span></p>
<p>Since <span class="math inline">\(\frac{\partial f}{\partial x}\)</span> does not exist for <span class="math inline">\(x=2, y\ne 0\)</span> it cannot be continuous for <span class="math inline">\(x=2\)</span> (even at <span class="math inline">\(y=0\)</span>) so <span class="math inline">\(f\)</span> is <u>not</u> continuously differentiable for <span class="math inline">\(x=2\)</span> (even at (2,0)).</p>
<p><span class="math display">\[\boxed{\implies f \text{ is continuously differentiable at } \{ (x,y) \in \mathbb{R}^2 : x \ne 2 \} }\]</span></p>
<p>By the differentiability theorem (Theorem <a href="#thm:continuousdifferentiability" data-reference-type="ref" data-reference="thm:continuousdifferentiability">[thm:continuousdifferentiability]</a>), this means that <span class="math inline">\(f\)</span> is also differentiable at all points <span class="math inline">\(\{ (x,y) \in \mathbb{R}^2 : x \ne 2 \}\)</span>. <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> does not exist for <span class="math inline">\(x=2, y\ne 0\)</span> so <span class="math inline">\(f\)</span> not differentiable there. But what about <span class="math inline">\(\underline{x}=(2,0) = 2\underline{e}_1\)</span>?</p>
<p>The partial derivatives do exist there (and are both zero) so <span class="math inline">\(f\)</span> might be differentiable there. <span class="math display">\[\begin{aligned}
			\text{As } \quad \quad\underline{\nabla\mkern-2mu}\mkern 3mu f(2\underline{e}_1) &amp;= (0,0) \\
			\Rightarrow\quad \quad R(\underline{h}) &amp;= f(2\underline{e}_1 + \underline{h}) - f(2\underline{e}_1) - \underline{h}.\underline{\nabla\mkern-2mu}\mkern 3mu f(2\underline{e}_1)  \\
			&amp;= h_2 |h_1| -0 -0 \\
			\Rightarrow\quad \quad\left| \frac{R(\underline{h})}{| \underline{h}|} \right| &amp;= \left| \frac{ h_2 |h_1|}{|\underline{h}|} \right| \\
			&amp;= \frac{|h_2| |h_1 | }{ |\underline{h}|} &lt; \frac{|\underline{h}| \:|\underline{h}|} {|\underline{h}|} = |\underline{h}|
		\end{aligned}\]</span></p>
<p>Now, since <span class="math display">\[\lim_{h\to 0}\left| \frac{R(\underline{h})}{| \underline{h}|} \right| = \lim_{h\to 0}|\underline{h}| = 0,\]</span> and <span class="math display">\[-\left| \frac{R(\underline{h})}{| \underline{h}|} \right| \le \frac{R(\underline{h})}{| \underline{h}|} \le \left| \frac{R(\underline{h})}{| \underline{h}|} \right|,\]</span> we have that <span class="math display">\[\lim_{h\to 0} \frac{R(\underline{h})}{| \underline{h}|} = 0\]</span> by the squeezing theorem, and so <span class="math inline">\(f\)</span> <u>is</u> differentiable at <span class="math inline">\(2\underline{e}_1\)</span>.</p>
<p><span class="math display">\[\boxed{\implies f \text{ is differentiable at } \{ (x,y) \in \mathbb{R}^2 : x \ne 2 \} \cup \{(2,0)\} }\]</span></p>
</div>
</section>
<section id="sub:thechainrulerevisited" class="level2" data-number="1.5">
<h2 data-number="0.5"><span class="header-section-number">0.5</span> The chain rule revisited</h2>
<p>Now that we’ve defined differentiability for scalar fields, we can give a proof of the chain rule for such fields.</p>
<div id="thm:chainrule" class="theorem">
<p> If <span class="math inline">\(f(\underline{x}) : U \to \mathbb{R}\)</span> is differentiable with <span class="math inline">\(U\)</span> an open set in <span class="math inline">\(\mathbb{R}^n\)</span>, and if <span class="math inline">\(\underline{x}\)</span> is a function of <span class="math inline">\(u_1,u_2, \dots u_m\)</span> such that the partial derivatives <span class="math inline">\(\frac{\partial x_1}{\partial u_1},\frac{\partial x_1}{\partial u_2},\dots \frac{\partial x_2}{\partial u_1},\frac{\partial x_2}{\partial u_2},\dots \frac{\partial x_n}{\partial u_m}\)</span> exist (that is all the partial derivatives <span class="math inline">\(\frac{\partial x_i}{\partial u_j}\)</span> for <span class="math inline">\(1\le i \le n\)</span> and <span class="math inline">\(1\le j \le m\)</span> exist), and if <span class="math display">\[\begin{aligned}
			\quad F(u_1,\dots, u_m) &amp;= f(\underline{x}(u_1,\dots,u_m)), \\
			\text{then } \quad\frac{\partial F}{\partial u_b} &amp;= \frac{\partial x_1}{\partial u_b} \frac{\partial f}{\partial x_1} + \frac{\partial x_2}{\partial u_b} \frac{\partial f}{\partial x_2} + \dots + \frac{\partial x_n}{\partial u_b} \frac{\partial f}{\partial x_n}  \;=\; \frac{\partial x_i}{\partial u_b} \frac{\partial f}{\partial x_i} \quad \quad\text{(Using ESC)} \\
				&amp;= \frac{\partial \underline{x}}{\partial u_b} . \underline{\nabla\mkern-2mu}\mkern 3mu f
		\end{aligned}\]</span></p>
</div>
<div id="pf:chainrule" class="proof">
<p> We have <span class="math display">\[\begin{aligned}
		f&amp;: U \subset \mathbb{R}^n\to \mathbb{R}\\
		\underline{x}&amp;: \mathbb{R}^m \to \mathbb{R}^n\\
		F &amp;: \mathbb{R}^m \to \mathbb{R},
	\end{aligned}\]</span> where <span class="math inline">\(F \;=\; f( \underline{x}( \underline{u}))\)</span>.</p>
<p>Set <span class="math display">\[\begin{aligned}
		\underline{x}(u_1,\dots u_b, \dots u_m) &amp;= \underline{a}\\
		\text{and} \quad \underline{x}(u_1,\dots u_b + k, \dots u_m) &amp;= \underline{a}+ \underline{h}(k),
	\end{aligned}\]</span> then <span class="math display">\[\begin{aligned}
		\frac{\partial F}{\partial u_b} &amp;= \lim_{k\to 0} \frac{F(u_1,\dots,u_b + k, \dots u_m) - F(u_1,\dots,u_b,\dots,u_m)}{k} \\
		 &amp;= \lim_{k\to 0} \frac{f(\underline{x}((u_1,\dots,u_b + k, \dots u_m)) - f(\underline{x}((u_1,\dots,u_b,\dots,u_m))}{k} \\
		&amp;= \lim_{k\to 0} \frac{f(\underline{a}+\underline{h}(k))) - f(\underline{a})}{k} \\
		&amp;= \lim_{k\to 0} \frac{ \underline{h}(k) . \underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{a}) + R(\underline{h}(k)) }{k} \\
		\text{(since $f$ is differentiable } &amp;\Rightarrow f(\underline{a}+\underline{h}) - f(\underline{a}) \;=\; \underline{h}. \underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{a}) + R(\underline{h}) ) \\
		&amp;= \lim_{k\to 0} \frac{ \underline{h}(k) . \underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{a})}{k}  +  \lim_{k\to 0} \frac{R(\underline{h}(k)) }{k} \\ \nonumber
		&amp;= \left(\lim_{k\to 0} \frac{ \underline{h}(k) }{k}\right) . \underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{a})  +  \lim_{k\to 0} \frac{R(\underline{h}(k)) }{k}, \quad \quad\quad \quad\quad \quad(a)
	\end{aligned}\]</span> since <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> doesn’t depend on <span class="math inline">\(k\)</span>. Now <span class="math display">\[\begin{aligned}
		\lim_{k\to 0} \frac{\underline{h}(k)}{k} &amp;= \lim_{k\to 0} \frac{ (\underline{a}+\underline{h}(k)) - \underline{a}}{k} \\
		&amp;= \lim_{k\to 0} \frac{ \underline{x}(u_1,\dots u_b + k, \dots u_m)  -  \underline{x}(u_1,\dots u_b, \dots u_m)}{k} \\
		&amp;= \frac{\partial \underline{x}}{\partial u_b},		\quad \quad\quad \quad\quad \quad\quad \quad\quad \quad\quad \quad\quad \quad(b)
	\end{aligned}\]</span> and <span class="math display">\[\lim_{k \to 0} \frac{R(\underline{h}(k))}{k} = \lim_{k \to 0}\frac{R(\underline{h}(k))}{||\underline{h}(k)||} \frac{||\underline{h}(k)||}{k}.\]</span> Then since <span class="math display">\[\begin{aligned}
		\lim_{k\to 0} \frac{R(\underline{h}(k))}{|\underline{h}(k)|} &amp;= 0  \quad(\text{by definition, since $f$ is differentiable}) \\
		\text{and} \quad\lim_{k\to 0}  \frac{|\underline{h}(k)|}{k} &amp;= \pm \left|\left| \lim_{k\to 0} \frac{\underline{h}(k)}{k}  \right|\right|  \;=\; \pm \left|\left|  \frac{\partial \underline{x}}{\partial u_b} \right|\right| \quad\text{by (b)}\\
		\text{We have} \quad \quad\lim_{k\to 0} \frac{R(\underline{h}(k))}{k} &amp;=  \lim_{k\to 0} \left(\frac{R(\underline{h}(k))}{|\underline{h}(k)|}  \frac{|\underline{h}(k)|}{k} \right)\;=\; 0.\left(\pm \left|\left|  \frac{\partial \underline{x}}{\partial u_b} \right|\right| \right) \;=\; 0. \quad \quad\quad \quad(c)
	\end{aligned}\]</span> Combining (a), (b) and (c) therefore gives <span class="math display">\[\frac{\partial F}{\partial u_b} \;=\; \frac{\partial \underline{x}}{\partial u_b} . \underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{a}) \;=\;   \frac{\partial x_1}{\partial u_b} \frac{\partial f}{\partial x_1} + \dots + \frac{\partial x_n}{\partial u_b} \frac{\partial f}{\partial x_n} \;=\; \frac{\partial x_i}{\partial u_b} \frac{\partial f}{\partial x_i}\]</span></p>
</div>
</section>
<section id="the-implicit-function-theorem" class="level2" data-number="1.6">
<h2 data-number="0.6"><span class="header-section-number">0.6</span> The implicit function theorem</h2>
<p>We first consider the implicit function theorem in the case of a scalar field on <span class="math inline">\(\mathbb{R}^2\)</span>.</p>
<p>Recall: A <u>level set</u> <span class="math inline">\(S\)</span> of <span class="math inline">\(f: U \to \mathbb{R}\)</span>, where <span class="math inline">\(U\)</span> is an open subset of <span class="math inline">\(\mathbb{R}^n\)</span>, is the set of points <span class="math inline">\(\{ \underline{x}\in U: f(\underline{x}) = c \}\)</span> for some constant <span class="math inline">\(c\)</span>.</p>
<p>For <span class="math inline">\(n=2\)</span>, the level set will usually be a curve, called a <u>level curve</u>.</p>
<p><strong>Question</strong>: When can the level curve of <span class="math inline">\(f: U \to \mathbb{R}\)</span>, with <span class="math inline">\(U\)</span> open in <span class="math inline">\(\mathbb{R}^2\)</span> , be written in the form <span class="math inline">\(y=g(x)\)</span> with <span class="math inline">\(g\)</span> a differentiable function? (Remember, if <span class="math inline">\(g(x)\)</span> is a <u>function</u> it must give a <u>single</u> value <span class="math inline">\(g(x)\)</span> for each value of the input <span class="math inline">\(x\)</span>.)</p>
<div class="center">
<figure>
<img src="implicitcurve.jpeg" id="fig:implicitcurve" style="width:60.0%" alt="" /><figcaption>A level curve of the function <span class="math inline">\(f\)</span> defined on an open set <span class="math inline">\(U\)</span>, <span class="math inline">\(f(x,y)=c\)</span>. This level curve can also be given in the form <span class="math inline">\(y=g(x)\)</span> for some differentiable function <span class="math inline">\(g\)</span>.</figcaption>
</figure>
</div>
<div id="eg:implicitfunctionwarmup" class="example">
<p> Let <span class="math inline">\(U = \mathbb{R}^2\)</span>.</p>
<ul>
<li><p>(A) <span class="math inline">\(f(x,y) = x^2 -y = c\)</span>.</p>
<p>Here <span class="math inline">\(y=g(x) = x^2-c\)</span>. Three level curves are show in Figure <a href="#fig:implicitcurveA" data-reference-type="ref" data-reference="fig:implicitcurveA">13</a>.</p>
<div class="center">
<figure>
<img src="implicitcurveA.png" id="fig:implicitcurveA" style="width:40.0%" alt="" /><figcaption>Three level curves of <span class="math inline">\(f(x,y) = x^2 -y\)</span>. Each one can be written in the form <span class="math inline">\(y=g(x) = x^2-c\)</span>.</figcaption>
</figure>
</div></li>
<li><p>(B) <span class="math inline">\(f(x,y) = x^2 + y^2 = c\)</span>.</p>
<p>Here we have <span class="math inline">\(y = \pm\sqrt{c-x^2}\)</span>; even for <span class="math inline">\(c&gt;0\)</span> and <span class="math inline">\(x\in (-\sqrt c, +\sqrt c)\)</span>, we <u>can’t</u> write the whole level curves as <span class="math inline">\(y=g(x)\)</span>, but we can write bits of them. Three level curves are show in Figure <a href="#fig:implicitcurveB" data-reference-type="ref" data-reference="fig:implicitcurveB">14</a>.</p>
<div class="center">
<figure>
<img src="implicitcurveB.png" id="fig:implicitcurveB" style="width:40.0%" alt="" /><figcaption>Three level curves of <span class="math inline">\(f(x,y) = x^2 + y^2\)</span>. These can’t be written in the form <span class="math inline">\(y=g(x)\)</span> for any differentiable function <span class="math inline">\(g\)</span>, though we can write sections of the curves in this form.</figcaption>
</figure>
</div></li>
<li><p>(C) <span class="math inline">\(f(x,y) = (x+y) e^{xy}\)</span>.</p>
<p>A selection of level curves of this function are shown in Figure <a href="#fig:levelcurves" data-reference-type="ref" data-reference="fig:levelcurves">15</a>. It’s difficult to see where we can write these level curves in the form <span class="math inline">\(y=g(x)\)</span>.</p>
<div class="center">
<figure>
<img src="levelcurves.png" id="fig:levelcurves" style="width:40.0%" alt="" /><figcaption>Level curves of the function <span class="math inline">\(f(x,y) = (x+y) e^{xy}\)</span>. Where can these be written in thee form <span class="math inline">\(y=g(x)\)</span> for <span class="math inline">\(g\)</span> a differentiable function of <span class="math inline">\(x\)</span>?</figcaption>
</figure>
</div></li>
</ul>
</div>
<p><strong>Terminology</strong>: <span class="math inline">\(y=g(x)\)</span> gives <span class="math inline">\(y\)</span> as an <u>explicit function</u> of <span class="math inline">\(x\)</span>; <span class="math inline">\(f(x,y) = 0\)</span> gives <span class="math inline">\(y\)</span> as an <u>implicit function</u> of <span class="math inline">\(x\)</span>. To go from explicit to implicit, just set <span class="math inline">\(f(x,y) = g(x) - y\)</span>.</p>
<p><strong>Question</strong>: When is it possible to go the other way, from implicit to explicit?</p>
<p>Suppose the level curve <span class="math inline">\(f(x,y)=c\)</span> <u>can</u> be written as <span class="math inline">\(y=g(x)\)</span>. Then <span class="math display">\[f(x,g(x)) \;=\; c. \quad \quad\quad \quad\quad \quad(I)\]</span> Differentiating this, using the chain rule (LHS is a function of <span class="math inline">\(x\)</span> only) gives <span class="math display">\[\begin{aligned}
		\frac{d}{d x} f(x,g(x)) &amp;= \frac{\partial f}{\partial x} + \frac{d g}{d x}\frac{\partial f}{\partial y} \\
		\text{but} \quad \quad\frac{d}{d x} f(x,g(x)) &amp;= \frac{d c}{d x} \;=\;0 \quad\text{(as $c$ is a constant)} \\
		\Rightarrow\quad \quad\quad \quad\frac{d g}{d x} &amp;= -\frac{\frac{\partial f(x,g(x))}{\partial x}}{\frac{\partial f(x,g(x))}{\partial y}} \quad \quad\quad \quad(II)
	\end{aligned}\]</span> Note: We have a problem if <span class="math inline">\(\frac{\partial f(x,g(x))}{\partial y} = 0\)</span>.</p>
<div class="theorem">
<p>The <u>Implicit Function Theorem</u> states that if <span class="math inline">\(f(x,y):U\to \mathbb{R}\)</span> is differentiable, and if <span class="math inline">\((x_0,y_0)\)</span> is a point in <span class="math inline">\(U\)</span> on the level curve <span class="math inline">\(f(x,y)=c\)</span> at which <span class="math inline">\(\frac{\partial f}{\partial y} \ne 0\)</span>, then a differentiable function <span class="math inline">\(g(x)\)</span> of <span class="math inline">\(x\)</span> exists in a neighbourhood of <span class="math inline">\(x_0\)</span> satisfying (I) and (II) with <span class="math inline">\(g(x_0) = y_0\)</span>.</p>
</div>
<div id="eg:implicitfunctiontheorem" class="example">
<p> Let’s now return to the three examples we saw before.</p>
<ul>
<li><p>(A) <span class="math display">\[\begin{aligned}
				 f(x,y) &amp;= x^2-y \\
				\Rightarrow\quad \quad\frac{\partial f}{\partial y} &amp;= -1 \; \ne \;0,
			\end{aligned}\]</span> so since this is non-zero everywhere, we can find <span class="math inline">\(g(x)\)</span>.</p></li>
<li><p>(B) <span class="math display">\[\begin{aligned}
			f(x,y) &amp;= x^2+y^2 \\
			\Rightarrow\quad \quad\frac{\partial f}{\partial y} &amp;= 2y,
		\end{aligned}\]</span> so if <span class="math inline">\(y_0 = 0\)</span> then <span class="math inline">\(\frac{\partial f}{\partial y}(x_0,y_0) =0\)</span>. We therefore can’t use the IFT to guarantee the existence of a differentiable function <span class="math inline">\(g(x)\)</span> describing the level curves of <span class="math inline">\(f\)</span> in a neighbourhood of <span class="math inline">\(y=0\)</span>. Looking at Figure <a href="#fig:implicitcircles" data-reference-type="ref" data-reference="fig:implicitcircles">16</a>, we see that no single-valued function can describe the level curves of <span class="math inline">\(f\)</span> in a neighbourhood of <span class="math inline">\(y=0\)</span>.</p>
<div class="center">
<figure>
<img src="implicitcircles.jpeg" id="fig:implicitcircles" style="width:50.0%" alt="" /><figcaption>In any neighbourhood of <span class="math inline">\(y=0\)</span>, we can’t describe the level curve of <span class="math inline">\(f(x,y) = x^2 + y^2\)</span> by a differentiable function <span class="math inline">\(g(x)\)</span>.</figcaption>
</figure>
</div></li>
<li><p>(C) <span class="math display">\[\begin{aligned}
			f(x,y) &amp;= (x+y)e^{xy} \\
			\Rightarrow\quad \quad\frac{\partial f}{\partial y} &amp;=  \frac{\partial}{\partial y} ((x+y)e^{xy}) \\
			&amp;= e^{xy} + (x+y)xe^{xy}\\
			&amp;= (1+x^2 + xy)e^{xy} \\
			\text{so} \quad \quad\quad \quad\frac{\partial f}{\partial y} \;=\;0 &amp; \leftrightarrow  1+x^2 + xy \;=\; 0\\
			\Rightarrow\quad \quad\quad \quad y&amp;= -\frac{(1+x^2)}{x} \;=\; -(x+\frac{1}{x}).
		\end{aligned}\]</span> So we have trouble at points <span class="math inline">\(x_0,y_0\)</span> with <span class="math inline">\(y_0= - (x_0+1/x_0)\)</span>, as shown in Figure <a href="#fig:implicitcurveproblem" data-reference-type="ref" data-reference="fig:implicitcurveproblem">17</a></p>
<div class="center">
<figure>
<img src="implicitcurveproblem.png" id="fig:implicitcurveproblem" style="width:50.0%" alt="" /><figcaption>The level curves of <span class="math inline">\(y=(x+y)e^{xy}\)</span> can be written in the form <span class="math inline">\(g(x)\)</span>, for a differentiable function <span class="math inline">\(g\)</span>, aside from in a neighbourhood of a point on the line <span class="math inline">\(y=-(x+1/x)\)</span>.</figcaption>
</figure>
</div></li>
</ul>
</div>
<div id="eg:ellipseimplicit" class="example">
<p> If <span class="math inline">\(f(x,y) = \frac{x^2}{a^2} + \frac{y^2}{b^2}\)</span> then <span class="math inline">\(f(x,y) = c, c&gt;0\)</span> is an ellipse, as shown in Figure <a href="#fig:ellipse" data-reference-type="ref" data-reference="fig:ellipse">18</a></p>
<div class="center">
<figure>
<img src="ellipse.jpeg" id="fig:ellipse" style="width:50.0%" alt="" /><figcaption>The curve can be written in the form <span class="math inline">\(g(x)\)</span> aside from in a neighbourhood of either point <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span>.</figcaption>
</figure>
</div>
<p><span class="math inline">\(f(x,y)\)</span> is differentiable so, in a neighbourhood of <span class="math inline">\(x_0\)</span>, the curve can be written as <span class="math inline">\(y=g(x)\)</span> provided <span class="math inline">\(\frac{\partial f}{\partial y}(x_0,y_0) \ne 0\)</span>. But <span class="math inline">\(\frac{\partial f}{\partial y} = \frac{2y}{b^2}\)</span> so this can be done except at points on <span class="math inline">\(x\)</span>-axis. <span class="math display">\[\begin{aligned}
			\text{In fact} \quad \quad\quad \quad g(x) &amp;= b\sqrt{c-\frac{x^2}{a^2}} \quad \quad\quad \quad\text{if } y_0 &gt; 0 \\
			\text{or} \quad \quad\quad \quad g(x) &amp;= -b\sqrt{c-\frac{x^2}{a^2}} \quad \quad\quad \quad\text{if } y_0 &lt; 0
		\end{aligned}\]</span></p>
<p>At points <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, <span class="math inline">\(\frac{\partial f}{\partial y} =0\)</span> so <span class="math inline">\(g(x)\)</span> is not differentiable. However at these points <span class="math inline">\(\frac{\partial f}{\partial x} \ne 0\)</span>, so instead of writing <span class="math inline">\(y=g(x)\)</span> we could find an <span class="math inline">\(h(y)\)</span> such that <span class="math inline">\(x=h(y)\)</span>.</p>
</div>
<p>If there is a point <span class="math inline">\(Q\)</span> on a level curve <span class="math inline">\(f=c\)</span> at which <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f=\underline{0}\)</span> (this is a critical point), the value of <span class="math inline">\(c\)</span> is called a <u>critical</u> value (otherwise it is a <u>regular</u> value) and the level curve <u>cannot</u> be written either as <span class="math inline">\(y=g(x)\)</span> or as <span class="math inline">\(x=h(y)\)</span> in the neighbourhood of <span class="math inline">\(Q\)</span> (with g,h differentiable).</p>
<div id="eg:criticalvalue" class="example">
<p> <span class="math inline">\(f=x^3-y^2+1\)</span>, then <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f = 3x^2 \underline{e}_1 - 2y \underline{e}_2\)</span> so <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f=\underline{0}\)</span> at <span class="math inline">\(\underline{x}= \underline{0}\)</span>, so <span class="math inline">\(c=1\)</span> is a critical value for <span class="math inline">\(f(x,y)=c\)</span>. <span class="math display">\[\begin{aligned}
			f=1 \quad \quad\Leftrightarrow\quad \quad y&amp;= \pm \sqrt{x^3} \quad \quad\quad \quad\text{no unique function in neighbourhood of } \underline{0} \\
			x&amp;= y^{\frac{2}{3}} \quad \quad\quad \quad\text{not differentiable at } \underline{0}
		\end{aligned}\]</span></p>
<div class="center">
<figure>
<img src="criticalcurve.png" id="fig:criticalc" style="width:50.0%" alt="" /><figcaption>Level curves of the function <span class="math inline">\(f(x,y) = x^3 - y^2+1\)</span>.</figcaption>
</figure>
</div>
</div>
</section>
<section id="implicit-function-theorem-for-surfaces" class="level2 unnumbered">
<h2 class="unnumbered">Implicit function theorem for surfaces</h2>
<p>All of this generalises to higher dimensions. For example, the level sets of scalar fields in <span class="math inline">\(\mathbb{R}^3\)</span> (i.e. <span class="math inline">\(\mathbb{R}^n\)</span> with <span class="math inline">\(n=3\)</span>) will generally be <u>surfaces</u>. We therefore have the implicit function theorem for surfaces.</p>
<div id="thm:implicitfunctiontheoremsurfaces" class="theorem">
<p> Let <span class="math inline">\(f(x,y,z): U \to \mathbb{R}\)</span> be differentiable (<span class="math inline">\(U\)</span> an open subset of <span class="math inline">\(\mathbb{R}^3\)</span>) and let <span class="math inline">\((x_0,y_0,z_0) \in U\)</span> be a point on the level set <span class="math inline">\(f(x,y,z) = c\)</span>, so <span class="math inline">\(f(x_0,y_0,z_0) =c\)</span>.</p>
<p>If <span class="math inline">\(\frac{\partial f}{\partial z}(x_0,y_0,z_0) \ne 0\)</span> then the equation <span class="math inline">\(f(x,y,z)=c\)</span> implicitly defines a surface <span class="math inline">\(z=g(x,y)\)</span> in a neighbourhood of the point <span class="math inline">\((x_0,y_0,z_0)\)</span>, via <span class="math display">\[f(x,y,g(x,y)) \;=\; c, \quad \quad\quad \quad\quad \quad(I)\]</span> with <span class="math inline">\(g(x_0,y_0)=z_0\)</span>, and where <span class="math display">\[\begin{aligned}
			\frac{\partial g}{\partial x}(x_0,y_0) &amp;= -\frac{\frac{\partial f}{\partial x}(x_0,y_0,z_0)}{\frac{\partial f}{\partial z}(x_0,y_0,z_0)} \quad \quad\quad \quad\ \quad \quad(IIa) \\
			\frac{\partial g}{\partial y}(x_0,y_0) &amp;= -\frac{\frac{\partial f}{\partial y}(x_0,y_0,z_0)}{\frac{\partial f}{\partial z}(x_0,y_0,z_0)}. \quad \quad\quad \quad\ \quad \quad(IIb)
		\end{aligned}\]</span></p>
</div>
<p>As in the implicit function theorem for curves, conditions <span class="math inline">\((IIa)\)</span> and <span class="math inline">\((IIb)\)</span> must hold for <span class="math inline">\(g(x,y)\)</span> if it exists, since <span class="math display">\[f(x,y,g(x,y)) \;=\; c\]</span> for all <span class="math inline">\((x,y)\)</span> in some neighbourhood of <span class="math inline">\((x_0,y_0)\)</span>. If we partially differentiate both sides with respect to <span class="math inline">\(x\)</span>, and use the chain rule: <span class="math display">\[\begin{aligned}
		0\;=\; \frac{\partial}{\partial x}(f(x,y,g(x,y)) &amp;= \frac{\partial x}{\partial x} \frac{\partial f}{\partial x} + \frac{\partial y}{\partial x} \frac{\partial f}{\partial y} + \frac{\partial g}{\partial x} \frac{\partial f}{\partial z} \\
		&amp;= \frac{\partial f}{\partial x} + \frac{\partial g}{\partial x} \frac{\partial f}{\partial z},
	\end{aligned}\]</span> as <span class="math inline">\(\frac{\partial x}{\partial x}=1\)</span>, <span class="math inline">\(\frac{\partial y}{\partial x}=0\)</span> and <span class="math inline">\(z=g(x,y)\)</span>. Hence <span class="math display">\[\frac{\partial g}{\partial x} \;=\; - \frac{\frac{\partial f}{\partial x}}{\frac{\partial f}{\partial z}}\]</span> as required. The argument follows similarly for <span class="math inline">\(\frac{\partial g}{\partial y}\)</span>.</p>
<p><strong>Recall</strong>: As we saw in Subsection <a href="#sub:directionalderivatives" data-reference-type="ref" data-reference="sub:directionalderivatives">[sub:directionalderivatives]</a>, <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> at <span class="math inline">\(\underline{x}_0 = (x_0,y_0,z_0)\)</span> is <u>normal</u> to the tangent plane of the surface <span class="math inline">\(z=g(x,y)\)</span> at <span class="math inline">\((x_0,y_0)\)</span>. So the normal line is given in parametric form by <span class="math display">\[\underline{x}(t) \;=\; \underline{x}_0 + t\underline{\nabla\mkern-2mu}\mkern 3mu f,\]</span> and the tangent plane is given by <span class="math display">\[(\underline{x}- \underline{x}_0) . \underline{\nabla\mkern-2mu}\mkern 3mu f \;=\; 0\]</span></p>
<div id="eg:implicitfunctionsurface" class="example">
<p> This example is taken from the 2011 exam, with notation slightly changed.</p>
<p><u>Question</u>: Check if <span class="math inline">\(z\sin(\pi x) = \log(2z-y^2)\)</span> defines a function <span class="math inline">\(z=g(x,y)\)</span> around <span class="math inline">\(x=2\)</span>, <span class="math inline">\(y=-1\)</span>. Find the tangent plane and normal line to <span class="math inline">\(z=g(x,y)\)</span> at <span class="math inline">\((2,-1)\)</span>.</p>
<p><u>Answer</u>: Set <span class="math inline">\(f(x,y,z)= z\sin(\pi x) - \log(2z-y^2)\)</span>, then the question is asking about the level set <span class="math inline">\(f=0\)</span>. We have <span class="math display">\[\begin{aligned}
			f(2,-1,z) &amp;= z\sin(2\pi) - \log(2z-1) \\
			&amp;= -\log(2z-1) \\
			\text{So } \quad \quad\quad \quad f=0 \quad\Leftrightarrow\quad\log(2z-1) &amp;= 0 \\
			\Leftrightarrow\quad \quad\quad \quad 2z-1 &amp;= 1 \\
			\Leftrightarrow\quad \quad\quad \quad z&amp;=1.
		\end{aligned}\]</span></p>
<p>The Implicit Function Theorem then states that <span class="math inline">\(f(x,y,z)=0\)</span> defines a surface <span class="math inline">\(z=g(x,y)\)</span> near <span class="math inline">\((x_0,y_0,z_0)=(2,-1,1)\)</span> provided <span class="math inline">\(\frac{\partial f}{\partial z} \ne 0\)</span> there. But <span class="math display">\[\begin{aligned}
			\frac{\partial f}{\partial z} &amp;= \sin(\pi x) - \frac{2}{2z-y^2} \\
			\text{So} \quad \quad\frac{\partial f}{\partial z}(2,-1,1) &amp;= -\frac{2}{2-1} \;=\; -2 \; \ne \; 0.
		\end{aligned}\]</span></p>
<p>The other partial derivatives are: <span class="math display">\[\begin{aligned}
			\frac{\partial f}{\partial x} &amp;= \pi z\cos(\pi x) \quad \quad\Rightarrow\quad \quad\frac{\partial f}{\partial x} (2,-1,1) \;=\; \pi \\
			\frac{\partial f}{\partial y} &amp;= -\frac{-2y}{2z-y^2} \;=\; \frac{2y}{2z-y^2} \quad \quad\Rightarrow\quad \quad\frac{\partial f}{\partial y} (2,-1,1) \;=\; \frac{-2}{1} \;=\; -2,
		\end{aligned}\]</span> so <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f(2,-1,1) = (\pi,-2,-2)\)</span>.</p>
<p>[Aside: So partial derivatives of <span class="math inline">\(g(x,y)\)</span> are (not that we need them here): <span class="math display">\[\begin{aligned}
			\frac{\partial g}{\partial x} &amp;= -\frac{\frac{\partial f}{\partial x} }{ \frac{\partial f}{\partial z} } \;=\; \pi /2 \\
			\frac{\partial g}{\partial y} &amp;= -\frac{\frac{\partial f}{\partial y} }{ \frac{\partial f}{\partial z} } \;=\;  -1
		\end{aligned}\]</span> end aside].</p>
<p>So a normal line is <span class="math display">\[\begin{aligned}
			(x,y,z) &amp;= (2,-1,1) + t(\pi, -2,-2)  \\
			\Rightarrow\quad \quad\quad \quad\underline{x}(t) &amp;= (2+\pi t)\underline{e}_1 + (-1-2 t) \underline{e}_2 + (1-2t) \underline{e}_3,
		\end{aligned}\]</span> and the tangent plane is <span class="math display">\[\begin{aligned}
			((x,y,z) - (2,-1,1)) . (\pi, -2, -2) &amp;=0 \\
			\Rightarrow\quad \quad\quad \quad(x-2)\pi + (y+1) (-2) + (z-1)(-2) &amp;= 0\\
			\Rightarrow\quad \quad\quad \quad\pi x -2 y -2 z &amp;= 2 \pi \\
			\Rightarrow\quad \quad\quad \quad\frac{\pi}{2} x - y -z &amp;= \pi
		\end{aligned}\]</span></p>
<p>Note, that if we write <span class="math inline">\(z=g(x,y)\)</span> and rearrange to get <span class="math inline">\(g(x,y) = \frac{\pi}{2} x - y - \pi\)</span>, we see that <span class="math inline">\(\frac{\partial g}{\partial x}\)</span> and <span class="math inline">\(\frac{\partial g}{\partial y}\)</span> agree with the values found above, as they must.</p>
</div>
</section>
</section>
<script>
function doNumbering() {
	// The syntax to read the structured data from the yaml is horrible, template literals fix the problem but probably aren't widely supported enough. Escaping line breaks is browser dependant. I don't know if there's a better way?
	// Note that the data from the yaml file is manipulated into an array, and then parsed back into strings later, but I didn't want to deal with the pandoc templating syntax longer than necessary.
	var supportedEnvsArrayString = ' .definition;;; .theorem;;; .lemma;;; .example;;; .exampleqed;;; .proposition;;; .remark;;; .corollary;;; .exercise;;; .question';
	var supportedEnvsArray = supportedEnvsArrayString.split("|||");
	supportedEnvsArray = supportedEnvsArray.map(inner => inner.split(";;;"));
	var numberWithin = '1';
	var counterOffset = '';
	var subcounterOffset = '';
	var problemCounter = '';
	const partLabels = 'abcdefghijklmnopqrstuvwxyz'.split('');
	
	// counterOffset may be negative, and by default if specified on the command line this gets string concatenated with the default given in the yaml config and this then causes a problem. Can be fixed by removing the default in the config file and converting to an int, but this causes a NaN error if no value is suplied on the command line, so if NaN set to 0.
	counterOffset = parseInt(counterOffset);
	if (isNaN(counterOffset)) {
		counterOffset = 0;
	}
	
	subcounterOffset = parseInt(subcounterOffset);
	if (isNaN(subcounterOffset)) {
		subcounterOffset = 0;
	}
	
	problemCounter = parseInt(problemCounter);
	if (isNaN(problemCounter)) {
		problemCounter = 1;
	}
	
	function sanitiseSelector(selector) {
		// tex labels often have colons in which need escaping. There may be other escaping needed here. Unfortunately neither encodeURI nor encodeURIComponent do what I need, so use regex to do the escaping manually.
		var sanitised = selector.replace(/\:/g,"\\\:");
		sanitised = sanitised.replace(/(^[\d])/,"\\3$1 ");
		sanitised = sanitised.replace(/\//g,"\\\/");
		return sanitised
	}
	
	function labelLinks() {
		var refs = document.querySelectorAll("a[data-reference-type=ref]")
		for (ref of refs) {
			// Escape colons (or other) from the link title.
			var ref_label = sanitiseSelector(ref.getAttribute("data-reference"));
			// Hopefully ref is a reference to a div or a section, which should have the associated id. If so, we just need the data-number from the relevant DOM item.
			var ref_to = document.querySelector("#"+ref_label);
			if (ref_to !== null) {
				var ref_number = ref_to.getAttribute("data-number");
			} else {
				// If ref is being used for an equation, then we need to try to parse the mathjax divs. This is fragile, but try to find the span which corresponds to the equation number we need.
				try {
					var mathjax_ref = "#mjx-eqn-"+ref_label;
					ref_to = document.querySelector(mathjax_ref);
					// Since this is a ref, we don't want the parens to be returned, so find the equation number and strip the parens.
					var ref_number = ref_to.querySelector(".mjx-char").innerHTML.replace(/[()]/g,"");
					ref.setAttribute("href",mathjax_ref);
				}
				// If we can't find a place to link to, just indicate a missing link.
				catch (err){
					var ref_number = "???"
				}
			}
			ref.innerHTML = ref_number;
		};
	}
	
	function numberEnvs() {
		for (var levelSpec = 0; levelSpec <= numberWithin; levelSpec++) {
			var reqLevels = document.querySelectorAll(".level"+levelSpec);
			for (var level of reqLevels) {
				levelCount = level.getAttribute("data-number");
				levelCount = String(parseFloat(levelCount)+(counterOffset));
				console.log(counterOffset);
				levelCount = levelCount+(("."+subcounterOffset).repeat(numberWithin-levelSpec));
				for (var counter of supportedEnvsArray) {
					var envCount = 1;
					var envs = level.querySelectorAll(counter.join(", "));
					for (var env of envs) {
						env.setAttribute("data-number",levelCount+"."+envCount);
						envCount += 1;
					}
				}
			}
		}
	}
	
	function numberFigs() {
		// Figures should either be in a figure environment, or a table with image class imageTable thanks to the tableCaps filter.
		figs = document.querySelectorAll("figure, .imageTable");
		var fig_no = 1
		console.log(figs);
		for (var fig of figs) {
			console.log(fig);
			var cap
			// For figures, we want to move the id to the figure, and set the data-number on both the figure and the figcaption
			if (fig.nodeName == "FIGURE") {
				cap = fig.querySelector("figcaption");
				var img = fig.querySelector("img, embed")
				if (img) {
					var img_id = img.getAttribute("id");
					fig.setAttribute("id",img_id);
					img.removeAttribute("id");
				}
			// for tables (which must be .imageTable due to the querySelector above), we want to set the data-number on the table and the caption
			} else if (fig.nodeName == "TABLE") {
				cap = fig.querySelector("caption");
			}
			cap.setAttribute("data-number",fig_no);
			fig.setAttribute("data-number",fig_no);
			fig_no += 1;
		}
	}
	
	function numberGlobals() {
		// This function numbers any environments that just use a global counter, such as a problem number on a problems sheet, where there are no sections to number with respect to.
		probsols = document.querySelectorAll(".problem, .solution");
		var prob_no = problemCounter;
		var partNo = 0;
		for (var probsol of probsols) {
			if (probsol.className == "problem"){
				prob_no +=1;
				partNo = 0;
				probsol.setAttribute("data-number",prob_no);
			}
			else {
				if (probsol.parentNode.nodeName == "LI") {
					var partLabel = partLabels[partNo];
					probsol.setAttribute("data-number",prob_no.toString()+partLabel);
					partNo +=1;
				}
				else{
					probsol.setAttribute("data-number",prob_no);
				}
			}
			
		}
		// sols = document.querySelectorAll(".solution");
// 		var sol_no = problemCounter;
// 		for (var sol of sols) {
// 			sol.setAttribute("data-number",sol_no);
// 			sol_no +=1
// 		}
	}
	
	// labelLinks() should occur last, so that the data-numbers have been correctly set first.
	numberEnvs();
	numberFigs();
	numberGlobals();
	labelLinks();
}
</script><script>
	var imageDir = './Figs/'
	imgs = document.querySelectorAll("img");
	for (var img of imgs) {
		imgsrc = img.getAttribute("src");
		img.setAttribute("src",imageDir.concat(imgsrc));
	}
</script></body>
</html>
