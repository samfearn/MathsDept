<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Analysis in Many Variables II – Lecture Notes Michaelmas 2021</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <link rel="stylesheet" href="https://samfearn.github.io/latex.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <script type="text/x-mathjax-config">
  	MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "ams"} } });
  	// I need to wait until MathJax has finished before running the numbering script
  	MathJax.Hub.Register.StartupHook("End",function(){doNumbering()});
  </script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Analysis in Many Variables II – Lecture Notes Michaelmas 2021</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#sec:admin">Admin Details</a></li>
<li><a href="#sec:introduction"><span class="toc-section-number">0</span> Introduction</a></li>
<li><a href="#sec:mappsbetweenrealvectorspaces"><span class="toc-section-number">1</span> Maps between real vector spaces</a>
<ul>
<li><a href="#sub:generalnotation"><span class="toc-section-number">1.1</span> General notation</a></li>
<li><a href="#sub:scalar_fields_vector_fields_and_curves"><span class="toc-section-number">1.2</span> Scalar fields, vector fields and curves</a></li>
<li><a href="#sub:partial_derivatives_and_the_chain_rule"><span class="toc-section-number">1.3</span> Partial derivatives and the chain rule</a></li>
</ul></li>
<li><a href="#sec:gradientofascalarfield"><span class="toc-section-number">2</span> The gradient of a scalar field</a>
<ul>
<li><a href="#differential-operators-and-underlinenablamkern-2mumkern-3mu"><span class="toc-section-number">2.1</span> Differential operators and <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu\)</span></a></li>
<li><a href="#sub:directionalderivatives"><span class="toc-section-number">2.2</span> Directional derivatives</a></li>
<li><a href="#some-properties-of-the-gradient"><span class="toc-section-number">2.3</span> Some properties of the gradient</a></li>
</ul></li>
<li><a href="#underlinenablamkern-2mumkern-3mu-acting-on-vector-fields"><span class="toc-section-number">3</span> <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu\)</span> acting on vector fields</a>
<ul>
<li><a href="#sub:divergence"><span class="toc-section-number">3.1</span> Divergence (div)</a></li>
<li><a href="#properties-of-div">Properties of div:</a></li>
<li><a href="#curl"><span class="toc-section-number">3.2</span> Curl</a></li>
<li><a href="#sub:properties_of_curl">Properties of curl:</a></li>
<li><a href="#sub:applyingdeltwice"><span class="toc-section-number">3.3</span> Applying <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu\)</span> twice</a></li>
</ul></li>
<li><a href="#sec:indexnotation"><span class="toc-section-number">4</span> Index notation</a>
<ul>
<li><a href="#einstein-summation-convention"><span class="toc-section-number">4.1</span> Einstein Summation Convention</a></li>
<li><a href="#subsub:dij"><span class="toc-section-number">4.2</span> The Kronecker delta, <span class="math inline">\(\delta_{ij}\)</span></a></li>
<li><a href="#subsub:eijk"><span class="toc-section-number">4.3</span> The Levi-Cevita symbol, <span class="math inline">\(\epsilon_{ijk}\)</span></a></li>
<li><a href="#the-very-useful-epsilon_ijk-formula"><span class="toc-section-number">4.4</span> The very useful <span class="math inline">\(\epsilon_{ijk}\)</span> formula</a></li>
<li><a href="#applications"><span class="toc-section-number">4.5</span> Applications</a></li>
</ul></li>
<li><a href="#sec:differentiabilityofscalarfields"><span class="toc-section-number">5</span> Differentiability of scalar fields</a>
<ul>
<li><a href="#sub:continuity"><span class="toc-section-number">5.1</span> Continuity</a></li>
<li><a href="#sub:opensets"><span class="toc-section-number">5.2</span> Open sets</a></li>
<li><a href="#sub:differentiablemapsfromrntor"><span class="toc-section-number">5.3</span> Differentiable maps <span class="math inline">\(\mathbb{R}^n\to \mathbb{R}\)</span></a></li>
<li><a href="#sub:continuous_differentiability"><span class="toc-section-number">5.4</span> Continuous Differentiability</a></li>
<li><a href="#sub:thechainrulerevisited"><span class="toc-section-number">5.5</span> The chain rule revisited</a></li>
<li><a href="#the-implicit-function-theorem"><span class="toc-section-number">5.6</span> The implicit function theorem</a></li>
<li><a href="#implicit-function-theorem-for-surfaces">Implicit function theorem for surfaces</a></li>
</ul></li>
<li><a href="#sec:differentiabilityofvectorfields"><span class="toc-section-number">6</span> Differentiability of vector fields</a>
<ul>
<li><a href="#sub:differentiablemapsfromrntorn"><span class="toc-section-number">6.1</span> Differentiable maps <span class="math inline">\(\mathbb{R}^n \to \mathbb{R}^n\)</span></a></li>
<li><a href="#diffeomorphisms-and-the-inverse-function-theorem"><span class="toc-section-number">6.2</span> Diffeomorphisms and the inverse function theorem</a></li>
</ul></li>
<li><a href="#volume-line-and-surface-integrals"><span class="toc-section-number">7</span> Volume, line and surface integrals</a>
<ul>
<li><a href="#double-integrals-and-fubinis-theorem"><span class="toc-section-number">7.1</span> Double integrals and Fubini’s theorem</a></li>
<li><a href="#sub:fubini">Double integrals</a></li>
<li><a href="#sub:volumeintegrals"><span class="toc-section-number">7.2</span> Volume integrals</a></li>
<li><a href="#sec:surf_line"><span class="toc-section-number">7.3</span> Line integrals</a></li>
<li><a href="#surface-integrals-i-defining-a-surface"><span class="toc-section-number">7.4</span> Surface integrals I: defining a surface</a></li>
<li><a href="#surface-integrals-ii-evaluating-the-integral"><span class="toc-section-number">7.5</span> Surface integrals II: evaluating the integral</a></li>
</ul></li>
<li><a href="#greens-stokes-and-divergence-theorems"><span class="toc-section-number">8</span> Green’s, Stokes’ and divergence theorems</a>
<ul>
<li><a href="#the-three-big-theorems"><span class="toc-section-number">8.1</span> The three big theorems</a></li>
<li><a href="#examples"><span class="toc-section-number">8.2</span> Examples</a></li>
<li><a href="#subsec:conservation"><span class="toc-section-number">8.3</span> Conservation laws and the continuity equation</a></li>
<li><a href="#path-independence-of-line-integrals"><span class="toc-section-number">8.4</span> Path independence of line integrals</a></li>
<li><a href="#sec:Jac"><span class="toc-section-number">8.5</span> Changing integration variables</a></li>
</ul></li>
<li><a href="#sec:proofs"><span class="toc-section-number">9</span> Proofs of the three big theorems (Non-Examinable)</a>
<ul>
<li><a href="#greens-theorem-in-the-plane"><span class="toc-section-number">9.1</span> Green’s theorem in the plane</a></li>
<li><a href="#stokes-theorem"><span class="toc-section-number">9.2</span> Stokes’ theorem</a></li>
<li><a href="#the-divergence-theorem"><span class="toc-section-number">9.3</span> The divergence theorem</a></li>
<li><a href="#further-examples"><span class="toc-section-number">9.4</span> Further examples</a></li>
</ul></li>
</ul>
</nav>
<p> </p>
<section id="sec:admin" class="level1 unnumbered">
<h1 class="unnumbered">Admin Details</h1>
<ul>
<li><p>Dr Sam Fearn, <a href="mailto:s.m.fearn@durham.ac.uk">s.m.fearn@durham.ac.uk</a></p></li>
<li><p>Use the Topic forums (available from the Blackboard Ultra Discussions Page) to ask questions about the course. This way other students will also be able to see any answers. You can post anonymously if you prefer. If you think you can answer another student’s question you should try to do so - trying to explain something to others is often the best way to learn.</p></li>
<li><p>There will also be Question and Answer sessions held during the Tuesday and Thursday timetabled lecture slots. These will be available synchronously, both face-to-face in TLC042, as well as online via Zoom for those unable to attend in person.</p></li>
<li><p>The lectures will all be available as videos through Blackboard Ultra. Lecture notes will be provided to go along with the video lectures. You are expected to spend time studying the lecture notes yourself as well as watching the video lectures.</p></li>
<li><p>All the material for this term will be available via the Ultra course. I will try to make everything as easy to find as possible, but please also familiarise yourself with what is available.</p></li>
<li><p><u>Tutorials</u>: Tutorials will be held in odd numbered weeks, starting in week <span class="math inline">\(3\)</span>. The suggested problems for these tutorials will be available through the ‘Michaelmas Tutorials’ block in Ultra. You should always make sure that you have both the lecture notes and any relevant problems sheets available in your tutorials.</p></li>
<li><p><u>Problems Classes</u>: In even numbered teaching weeks, the Thursday 5pm timetabled slot will be a problems class rather than a lecture. These sessions will be available synchronously, both face-to-face in TLC042, as well as online via Zoom for those unable to attend in person. In these classes I will focus on working through examples rather than introducing any new material.</p></li>
<li><p><u>Assignments</u>: Assignments will be set weekly, and will alternate between work to be done on paper, and handed in via Gradescope, and e-assessments to be completed on the Maths Quiz Server. Further details, as well as the necessary links, are available in the Assignments block on Ultra.</p></li>
<li><p><u>Additional Reading</u>: The notes available in each topic, along with the lecture videos and problems classes will contain all the material that you will be examined on in this course. If you feel that you would like some additional reading to support the lecture notes then I recommend the book <em>Mathematical Methods for Physics and Engineering</em> by Riley, Hobson and Bence. This is available for you to read online via the ‘Reading List’, which is available as a link in Ultra.</p></li>
</ul>
</section>
<section id="sec:introduction" class="level1" data-number="1">
<h1 data-number="0"><span class="header-section-number">0</span> Introduction</h1>
<p>Most of this term of this course is actually about <u>Vector Calculus</u>. Vector calculus is a generalisation of the calculus you studied in Calculus I, which focussed mostly on functions of one or two variables, to studying functions defined from and to higher dimensional real spaces. Although the notation we use today was first introduced in the study of Electromagnetism (Maxwell, 1831-1879) in the 1860’s and 1870’s, the language of vector calculus is now fundamental in many parts of pure and applied mathematics, as is shown in Figure <a href="#fig:topicmap" data-reference-type="ref" data-reference="fig:topicmap">1</a>.</p>
<figure>
<img src="IntroTopics.jpg" id="fig:topicmap" alt="" /><figcaption>Not only is vector calculus fundamental for studying most topics in mathematical physics, it’s also important for the study of the geometry and topology of differentiable spaces (more specifically, differentiable manifolds, which you’ll meet in a later course), and the study of differential equations.</figcaption>
</figure>
</section>
<section id="sec:mappsbetweenrealvectorspaces" class="level1" data-number="2">
<h1 data-number="1"><span class="header-section-number">1</span> Maps between real vector spaces</h1>
<section id="sub:generalnotation" class="level2" data-number="2.1">
<h2 data-number="1.1"><span class="header-section-number">1.1</span> General notation</h2>
<ul>
<li><p><span class="math inline">\(\mathbb{R}\)</span>: the set of real numbers, which we think of as points on a line.</p></li>
<li><p><span class="math inline">\(\mathbb{R}^n\)</span>: the set of ordered <span class="math inline">\(n\)</span>-tuples <span class="math inline">\((x_1,x_2,\dots,x_n)\)</span> where each <span class="math inline">\(x_i\)</span> is real (<span class="math inline">\(x_i \in \mathbb{R}\)</span>). Such an n-tuple can be thought of as the cartesian coordinates of a point in <span class="math inline">\(n\)</span>-dimensional space. <span class="math inline">\(\mathbb{R}^n\)</span> is a real vector space (see Linear Algebra I for the full set of axioms of a real vector space), and so we refer to elements of <span class="math inline">\(\mathbb{R}^n\)</span> as <span class="math inline">\(n\)</span>-dimensional vectors. You may be used to using column vector notation for such vectors, but here we will use row vector notation.</p></li>
<li><p>Recall that the standard basis vector <span class="math inline">\(e_i\)</span> is defined as the vector with a 1 in the <span class="math inline">\(i\)</span><sup>th</sup> position, and a 0 in all other positions, e.g. <span class="math inline">\(x_2 = (0,1,0,\ldots,0)\)</span>.</p>
<p>The standard basis vectors <span class="math inline">\(\underline{e}_i\)</span> are othonormal (orthogonal, and normalised to have length 1) with respect to the scalar (dot) product on <span class="math inline">\(\mathbb{R}^n\)</span>: <span class="math display">\[\begin{equation} \label{eq:orthonormalstandardbasis}
	\underline{e}_i . \underline{e}_j \;=\; \left\{  \begin{array}{lc}
						1, \quad &amp; i=j \\
						0, \quad &amp; i\ne j 
						\end{array}
				\right\} \;\equiv \; \delta_{ij}. \end{equation}\]</span> <span class="math inline">\(\delta_{ij}\)</span> as just defined is called the Kronecker delta, and we will revisit this in our later section on index notation <a href="#sec:indexnotation" data-reference-type="ref" data-reference="sec:indexnotation">5</a>.</p></li>
<li><p>In terms of the standard basis of <span class="math inline">\(\mathbb{R}^n\)</span>, <span class="math inline">\(\{e_1,e_2,\ldots,e_n\}\)</span>, the position vector of a point in <span class="math inline">\(\mathbb{R}^n\)</span>, <span class="math inline">\(\underline{x}\)</span> can be written as <span class="math display">\[\begin{equation} \label{eq:standardbasisexpansion}
	\underline{x} \;=\; x_1\underline{e}_1 + x_2 \underline{e}_2 + \dots + x_n \underline{e}_n \;=\; \sum_{i=1}^n x_i \underline{e}_i \;=\; x_i \underline{e}_i. \end{equation}\]</span></p></li>
<li><p>Note: Index notation (as in the final expression in <span class="math inline">\(\eqref{eq:standardbasisexpansion}\)</span>, <span class="math inline">\(x_i \underline{e}_i\)</span>) is a very important convention: when we see an index (like <span class="math inline">\(i\)</span>) repeated, we will assume that it is to be summed over from 1 to <span class="math inline">\(n\)</span> and leave off the “<span class="math inline">\(\sum_{i=1}^n\)</span>". This convention is known as the <strong>Einstein Summation Convention</strong> (ESC). Index notation is sufficiently important in vector calculus that we will have a whole section on it later in the course.</p></li>
<li><p>For low values of <span class="math inline">\(n\)</span>, we will often write <span class="math inline">\(x_1, x_2,\dots\)</span> as <span class="math inline">\(x,y,\dots\)</span> <span class="math display">\[\begin{array}{lcl}
	{\rm e.g.} &amp; n=2: &amp; \underline{x}\;=\; x\underline{e}_1 + y \underline{e}_2 \\
	  &amp; n=3: &amp; \underline{x}\;=\; x\underline{e}_1 + y \underline{e}_2 + z\underline{e}_3.
	\end{array}\]</span></p></li>
<li><p>Important: <strong>Don’t forget the vector signs</strong>, i.e. <span class="math inline">\(\underline{x}\ne x\)</span>. <span class="math inline">\(xe_i\)</span> has a quite different meaning to <span class="math inline">\(\underline{x}.e_i\)</span>.</p></li>
<li><p>Given two vectors <span class="math inline">\(\underline{u},\underline{v} \in \mathbb{R}^n\)</span> <span class="math display">\[\begin{aligned}
		\underline{u} =&amp; u_1\underline{e}_1 + u_2\underline{e}_2+\dots + u_n\underline{e}_n \;=\; \sum_{i=1}^n u_i \underline{e}_i   \;=\; u_i \underline{e}_i\\
		\underline{v} =&amp; v_1\underline{e}_1 + v_2\underline{e}_2+\dots + v_n\underline{e}_n \;=\; \sum_{i=1}^n v_i \underline{e}_i  \;=\; v_i \underline{e}_i
	\end{aligned}\]</span> (note the use of the Einstein summation convention again here), the scalar (dot) product between these vectors is then <span class="math display">\[\underline{u}.\underline{v} \;=\; u_1v_1+u_2v_2+\dots+u_nv_n \;=\; \sum_{i=1}^n u_i v_i   \;=\; u_i v_i.\]</span> This can easily be proved by multiplying out <span class="math inline">\(\underline{u}.\underline{v}\)</span>, and using the fact that the standard basis vectors are orthonormal.</p></li>
<li><p>The <u>length</u> or <u>magnitude</u> of <span class="math inline">\(\underline{u}\)</span> is found using the dot product between <span class="math inline">\(\underline{u}\)</span> and itself, <span class="math display">\[|\underline{u}| \;=\; \sqrt{\underline{u}.\underline{u}},\]</span> and if <span class="math inline">\(\theta\)</span> is the <u>angle</u> between <span class="math inline">\(\underline{u}\)</span> and <span class="math inline">\(\underline{v}\)</span>, then <span class="math display">\[\underline{u}.\underline{v} \;=\; |\underline{u}|\;|\underline{v}| \cos(\theta).\]</span></p>
<p><span class="math inline">\(|\underline{x}|\)</span> is sometimes denoted <span class="math inline">\(r\)</span> (note that this is a scalar quantity, and not a vector), since it is the radial coordinate of <span class="math inline">\(\underline{x}\)</span> in spherical polars. Similarly <span class="math inline">\(\underline{x}\)</span> is sometimes denoted <span class="math inline">\(\underline{r}\)</span>.</p></li>
<li><p>Draw vectors as arrows:</p>
<div class="center">
<figure>
<img src="vectorinr3.jpg" id="fig:vectorinr3" style="width:70.0%" alt="" /><figcaption>The vector <span class="math inline">\(\underline{x}\)</span> illustrated as the position vector of a point in <span class="math inline">\(\mathbb{R}^3\)</span>. The length of <span class="math inline">\(\underline{x}\)</span>, <span class="math inline">\(r\)</span>, is shown, as are the standard basis vectors of <span class="math inline">\(\mathbb{R}^3\)</span>. Using Einstein Summation Convention, we can write <span class="math inline">\(\underline{x}\)</span> in terms of the standard basis as <span class="math inline">\(\underline{x}= x_ie_i\)</span></figcaption>
</figure>
</div></li>
</ul>
</section>
<section id="sub:scalar_fields_vector_fields_and_curves" class="level2" data-number="2.2">
<h2 data-number="1.2"><span class="header-section-number">1.2</span> Scalar fields, vector fields and curves</h2>
<p>Now we can introduce the main objects of study in this course, scalar fields, vector fields and curves. These are all defined as maps from one real vector space to another, that is as maps from <span class="math inline">\(\mathbb{R}^m \to \mathbb{R}^n\)</span>.</p>
<ul>
<li><p><strong>Scalar fields</strong> are real-valued functions on <span class="math inline">\(\mathbb{R}^n\)</span>, i.e. maps <span class="math display">\[\label{eq:scalarfielddef}
	\begin{align}
		\mathbb{R}^n&amp;\to \mathbb{R}\\
		\underline{x}&amp; \mapsto f(\underline{x})
	\end{align}\]</span> e.g. for <span class="math inline">\(n=3\)</span>, we could have the function <span class="math inline">\(f\)</span> defined as <span class="math display">\[f(\underline{x}) \;\;=\;\; \frac{xy}{\tan z}.\]</span> Note that here the argument of the function is underlined to show that it’s a vector quantity. <span class="math inline">\(f(\underline{x})\)</span> could also be written as <span class="math inline">\(f(x,y,z)\)</span>.</p>
<p>The functions of two variables that you studied in the Epiphany term of Calculus I were all examples of scalar fields.</p></li>
<li><p><strong>Vector fields</strong> are vector-valued functions on <span class="math inline">\(\mathbb{R}^n\)</span>, i.e. maps <span class="math display">\[\label{eq:vectorfielddef}
	\begin{align}
		\mathbb{R}^n&amp;\to \mathbb{R}^n\\
		\underline{x}&amp; \mapsto \underline{f}(\underline{x}).
	\end{align}\]</span> Note that since the image of <span class="math inline">\(\underline{x}\)</span> is also a vector, we underline the function <span class="math inline">\(\underline{f}\)</span> to indicate this. In textbooks you may also see vector fields written in bold, rather than underlined.</p>
<div id="eg:vectorfield1" class="example">
<p> Given a constant vector <span class="math inline">\(\underline{a} \in \mathbb{R}^n\)</span>, we might have the vector field <span class="math inline">\(\underline{f}\)</span> on <span class="math inline">\(\mathbb{R}^n\)</span>, given by <span class="math display">\[\underline{f}(\underline{x}) = ( \underline{a}.\underline{x})\underline{x}.\]</span></p>
<p>If we let <span class="math inline">\(n=2\)</span> and take <span class="math inline">\(\underline{a}=(1,1)\)</span>, then the vector field near the origin looks as in Figure <a href="#fig:simplevectorfield" data-reference-type="ref" data-reference="fig:simplevectorfield">3</a>.</p>
<div class="center">
<figure>
<img src="simplevectorfieldexample.png" id="fig:simplevectorfield" style="width:50.0%" alt="" /><figcaption>A plot of the vector field <span class="math inline">\(\underline{f}(\underline{x}) = (a.x)x\)</span> near the origin in 2 dimensions with <span class="math inline">\(a=(1,1)\)</span>. The vectors are drawn at a sample of points <u>x</u>, as arrows.</figcaption>
</figure>
</div>
<p>Pay careful attention to the two different types of multiplication being used in this example. We take the <em>scalar product</em> between <span class="math inline">\(\underline{a}\)</span> and <span class="math inline">\(\underline{x}\)</span>, and we can then use <em>scalar multiplication</em> to multiply the vector <span class="math inline">\(\underline{x}\)</span> by the scalar <span class="math inline">\((\underline{a}.\underline{x})\)</span>.</p>
</div>
<p><u>Note</u>: We can also write the formula “in components”, i.e. using <u>index notation</u> - by giving a formula for the <span class="math inline">\(i\)</span>th component of <span class="math inline">\(\underline{f}\)</span>. So example <a href="#eg:vectorfield1" data-reference-type="ref" data-reference="eg:vectorfield1">[eg:vectorfield1]</a> would be (using index notation and ESC): <span class="math display">\[f_i \;\;=\;\; ( a_jx_j) x_i\]</span></p></li>
<li><p><strong>Curves</strong> in <span class="math inline">\(\mathbb{R}^n\)</span> are given parametrically by specifying <span class="math inline">\(\underline{x}\)</span> as a function <span class="math inline">\(\underline{x}(t)\)</span> of some parameter, <span class="math inline">\(t\)</span> say. That is, a curve is a map <span class="math display">\[\label{eq:curveseq}
	\begin{align}
		\mathbb{R}&amp;\to \mathbb{R}^n\\
		t &amp;\mapsto \underline{x}(t).
	\end{align}\]</span> Since the image of <span class="math inline">\(t\)</span> is a vector quantity, we underline the function <span class="math inline">\(\underline{x}(t)\)</span> to indicate this. <span class="math inline">\(t\)</span> itself is a scalar quantity however, and so is not underlined.</p>
<div id="eg:curve1" class="example">
<p> Given constant vectors <span class="math inline">\(\underline{a},\underline{b} \in \mathbb{R}^n\)</span>, the curve <span class="math display">\[{\rm e.g.}\quad \underline{x}(t) =  \underline{a} + t \underline{b},\]</span> which can be written in components as <span class="math display">\[x_i(t) = a_i + t b_i,\]</span> is a straight line in <span class="math inline">\(\mathbb{R}^n\)</span>, which goes through the point <span class="math inline">\(\underline{a}\)</span> and is parallel to <span class="math inline">\(\underline{b}\)</span>.</p>
</div>
<p>If <span class="math inline">\(\underline{x}(t)\)</span> is differentiable, then <span class="math inline">\(\frac{d \underline{x}}{d t}\)</span> is tangent to the curve (if non-zero). (If you studied Dynamics I, then you’ve already come across this idea in that course. There, the <em>trajectory</em> of a particle <span class="math inline">\(\underline{r}(t)\)</span> was a curve in space, parameterised by time <span class="math inline">\(t\)</span>, the <em>velocity</em> was the derivative of the trajectory with respect to time, <span class="math inline">\(\frac{d\underline{r}(t)}{dt}\)</span>, and the <em>acceleration</em> was the second derivative <span class="math inline">\(\frac{d^2\underline{r}(t)}{dt^2}\)</span>.)</p>
<div class="center">
<figure>
<img src="tangent_to_curve.jpg" id="fig:curvetangent" style="width:80.0%" alt="" /><figcaption>The tangent to a curve <span class="math inline">\(\underline{x}(t)\)</span> is found by differentiating the curve with respect to <span class="math inline">\(t\)</span>.</figcaption>
</figure>
</div>
<div id="eg:tangenttohelix" class="example">
<p> A helix in <span class="math inline">\(\mathbb{R}^3\)</span> can be parameterised as <span class="math display">\[\underline{x}(t) = \cos(t) \underline{e}_1 + \sin(t) \underline{e}_2 + t \underline{e}_3.\]</span> The tangent to the helix is therefore given by <span class="math display">\[\frac{d \underline{x}}{d t}(t) = -\sin (t) \underline{e}_1 + \cos( t) \underline{e}_2 +  \underline{e}_3.\]</span> Note that the standard basis vectors are constant, and hence the components of the derivative of <span class="math inline">\(\underline{x}(t)\)</span> with respect to <span class="math inline">\(t\)</span>, are just the derivatives of the components of <span class="math inline">\(\underline{x}(t)\)</span>.</p>
<div class="center">
<figure>
<img src="helixandtangent.png" id="fig:helixandtangent" style="width:50.0%" alt="" /><figcaption>A helix in <span class="math inline">\(\mathbb{R}^3\)</span>, with the tangent at a point shown.</figcaption>
</figure>
</div>
</div>
<div id="eg:arclengthparam" class="example">
<p> If a curve is parameterised in terms of the so-called <em>arc-length</em> <span class="math inline">\(s\)</span> (we won’t define this precisely here) along the curve from a fixed point on it, then <span class="math inline">\(| \frac{d \underline{x}}{d s}| =1\)</span>. <span class="math display">\[\label{eq:arclengthparam}
		\begin{align}
			{\text with} \quad t=s, &amp; \quad h = \delta s,   \\
			| \underline{x}(s+\delta s) - \underline{x}(s) | &amp;\simeq \delta s \\
			\Rightarrow \quad \lim_{\delta s \rightarrow 0} \frac{| \underline{x}(s+\delta s) - \underline{x}(s) | }{\delta s}  &amp;= 1 \\
			\Rightarrow \;\; | \frac{d \underline{x}}{d s}| &amp;= 1 \quad \quad \text{a unit vector.}
		\end{align}\]</span></p>
<div class="center">
<figure>
<img src="arclengthunittangent.jpg" id="fig:arclengthparam" style="width:80.0%" alt="" /><figcaption>If the curve is parameterised by its arc-length (which we haven’t rigorously defined), then for small <span class="math inline">\(\delta s\)</span>, the length of the vector <span class="math inline">\(\underline{x}(s+\delta s)-\underline{x}(s)\)</span> becomes approximately the same as the length of the curve segment <span class="math inline">\(\delta s\)</span>. In the limit that <span class="math inline">\(\delta s \to 0\)</span>, these become equal, and hence the length of the derivative of the curve with respect to <span class="math inline">\(s\)</span> (the tangent) becomes 1.</figcaption>
</figure>
</div>
</div></li>
</ul>
</section>
<section id="sub:partial_derivatives_and_the_chain_rule" class="level2" data-number="2.3">
<h2 data-number="1.3"><span class="header-section-number">1.3</span> Partial derivatives and the chain rule</h2>
<p>In Calculus I, given a function of two variables <span class="math inline">\(f(x,y): \mathbb{R}^2 \to \mathbb{R}\)</span>, you learned that the partial derivatives <span class="math display">\[\label{eq:partialderivatives}
	\begin{align}
		\frac{\partial f}{\partial x} &amp;=&amp; \lim_{h\to 0} \frac{f(x+h,y) - f(x,y)}{h} \\
		\frac{\partial f}{\partial y} &amp;=&amp; \lim_{h\to 0} \frac{f(x,y+h) - f(x,y)}{h},
	\end{align}\]</span> tell us the rate of change of the function <span class="math inline">\(f\)</span> as we move parallel to the <span class="math inline">\(x\)</span>- and <span class="math inline">\(y\)</span>- axes respectively. If we write <span class="math inline">\(x,y\)</span> as <span class="math inline">\(x_1,x_2\)</span> &amp; <span class="math inline">\(f(x,y)\)</span> as <span class="math inline">\(f(\underline{x})\)</span>, with <span class="math inline">\(\underline{x}= x_1 \underline{e}_1 + x_2 \underline{e}_2\)</span>, then we can re-express the partial derivatives using vector notation as <span class="math display">\[\label{eq:partialderivativesvector}
	\begin{align}
		\frac{\partial f}{\partial x} &amp;\equiv&amp; \frac{\partial f}{\partial x_1} \;=\;  \lim_{h\to 0} \frac{f(\underline{x}+h\underline{e}_1) - f(\underline{x})}{h} \\
		\frac{\partial f}{\partial y} &amp;\equiv&amp; \frac{\partial f}{\partial x_2} \;=\; \lim_{h\to 0} \frac{f(\underline{x}+h\underline{e}_2) - f(\underline{x})}{h}.
	\end{align}\]</span> This now suggests the obvious generalisation to scalar fields in <span class="math inline">\(n\)</span> dimensions. If we let <span class="math inline">\(f(\underline{x}): \mathbb{R}^n \to \mathbb{R}\)</span>, then the function <span class="math inline">\(f\)</span> has <span class="math inline">\(n\)</span> (1<sup>st</sup> order) partial derivatives given by <span class="math display">\[\frac{\partial f(\underline{x})}{\partial x_a} \;\;=\;\;  \lim_{h\to 0} \frac{f(\underline{x}+h\underline{e}_a) - f(\underline{x})}{h},\]</span> for <span class="math inline">\(a=1,2,\dots,n\)</span>. These partial derivatives tell us about the rate of change of the function as we move parallel to any of the <span class="math inline">\(n\)</span> coordinate axes in <span class="math inline">\(n\)</span> dimensions.</p>
<p>You also learned that the rate of change of a function <span class="math inline">\(f(x,y): \mathbb{R}^2 \to \mathbb{R}\)</span> along a parametrically defined curve <span class="math inline">\(C\)</span> given as <span class="math inline">\((x(t),y(t))\)</span> can be found using the chain rule. Along this curve we have <span class="math inline">\(F(t) \equiv f(x(t),y(t))\)</span>. Note that I don’t write the function of <span class="math inline">\(t\)</span> as <span class="math inline">\(f(t)\)</span>, since <span class="math inline">\(f\)</span> is a map from <span class="math inline">\(\mathbb{R}^2\)</span> and hence strictly speaking <span class="math inline">\(f(t)\)</span> is a different function, this time a map from <span class="math inline">\(\mathbb{R}\)</span>. To avoid the confusion of two different functions with the same name, we will denote the restricted function as <span class="math inline">\(F(t)\)</span>. The chain rule then tells us that <span class="math display">\[\frac{d F(t)}{d t} \;=\; \frac{d x}{d t} \frac{\partial f}{\partial x} + \frac{d y}{d t} \frac{\partial f}{\partial y}.\]</span></p>
<p>To extend this to the <span class="math inline">\(n\)</span>-dimensional case using vector notation, we first note that in the two-dimensional case, the curve <span class="math inline">\(C\)</span> is given by <span class="math display">\[\underline{x}(t) \;\;=\;\; x_1(t) \underline{e}_1 + x_2(t) \underline{e}_2,\]</span> with <span class="math inline">\(x_1(t)=x(t)\)</span> and <span class="math inline">\(x_2(t)=y(t)\)</span>. Similarly, <span class="math inline">\(f(x,y)\)</span> is <span class="math inline">\(f(\underline{x})\)</span>, so <span class="math display">\[\frac{d F(t)}{d t} = \frac{d f(\underline{x}(t))}{d t} \;\;=\;\; \frac{d x_1}{d t}\frac{\partial f}{\partial x_1} + \frac{d x_2}{d t} \frac{\partial f}{\partial x_2}.\]</span> We can now see how this should be generalised to the case of a scalar field in <span class="math inline">\(n\)</span> dimensions. The curve <span class="math inline">\(C\)</span> can be given parametrically as <span class="math display">\[\underline{x}(t) \;\;=\;\; x_1(t) \underline{e}_1 + \ldots + x_n(t) \underline{e}_n.\]</span> Our scalar field is given as <span class="math inline">\(f(\underline{x}): \mathbb{R}^n \to \mathbb{R}\)</span>, and the restriction of the scalar field to the curve <span class="math inline">\(C\)</span> can then be written as <span class="math inline">\(F(t) = f(\underline{x}(t))\)</span>. The chain rule then tells us that <span class="math display">\[\frac{d F(t)}{d t} = \frac{d}{d t} f(\underline{x}(t)) \;=\; \frac{d x_1}{d t} \frac{\partial f}{\partial x_1} + \dots + \frac{d x_n}{d t} \frac{\partial f}{\partial x_n}.\]</span></p>
<p><u>Note</u>: The chain rule holds for differentiable functions of two variables. You defined what this meant in the context of functions of two variables in Calculus I, and we shall revisit precisely what it means for a scalar function in <span class="math inline">\(n\)</span> dimensions to be differentiable in section <a href="#sec:differentiabilityofscalarfields" data-reference-type="ref" data-reference="sec:differentiabilityofscalarfields">6</a>. For now we simply assume that our scalar fields are indeed differentiable.</p>
</section>
</section>
<section id="sec:gradientofascalarfield" class="level1" data-number="3">
<h1 data-number="2"><span class="header-section-number">2</span> The gradient of a scalar field</h1>
<section id="differential-operators-and-underlinenablamkern-2mumkern-3mu" class="level2" data-number="3.1">
<h2 data-number="2.1"><span class="header-section-number">2.1</span> Differential operators and <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu\)</span></h2>
<p>In the previous section, we saw that when we can compute the rate of change of a scalar field <span class="math inline">\(f(\underline{x})\)</span> along a curve <span class="math inline">\(C\)</span> given by <span class="math inline">\(\underline{x}(t) = x_i(t)\underline{e}_i\)</span> (ESC), using the chain rule as <span class="math display">\[\frac{d F(t)}{d t} = \frac{d}{d t} f(\underline{x}(t)) \;=\; \frac{d x_1}{d t} \frac{\partial f}{\partial x_1} + \dots + \frac{d x_n}{d t} \frac{\partial f}{\partial x_n} = \frac{d x_i}{d t} \frac{\partial f}{\partial x_i},\]</span> where <span class="math inline">\(F(t)\)</span> is the restriction of <span class="math inline">\(f(\underline{x})\)</span> to the curve <span class="math inline">\(\underline{x}(t)\)</span>, and where again we’ve used ESC in the final equality.</p>
<p>Since this is true for all (differentiable) scalar fields, it’s often useful to write this rule in terms of the derivative operators themselves, separate from the field <span class="math inline">\(F(t)\)</span>. In this form, the chain rule can be given as <span class="math display">\[\frac{d}{d t} \;=\; \frac{d x_1}{d t} \frac{\partial}{\partial x_1} + \dots + \frac{d x_n}{d t} \frac{\partial}{\partial x_n}\]</span></p>
<p>This is known as a <em>differential operator</em>, which can be thought of as a map which takes functions to functions using derivatives.</p>
<p>When using operator notation, we need to be careful about exactly what the differential operator is acting on.</p>
<div id="eg:differentialoperators" class="example">
<p> Given two real functions <span class="math inline">\(f(x),g(x):\mathbb{R}\to \mathbb{R}\)</span>, then:</p>
<ul>
<li><p><span class="math inline">\(f(x)\frac{d}{d x}\)</span> is a differential operator which can act on <span class="math inline">\(g(x)\)</span> to give <span class="math inline">\(f(x)\frac{d g(x)}{d x}\)</span>.</p></li>
<li><p><span class="math inline">\(\frac{d}{d x}f(x)\)</span> is a differential operator which can on <span class="math inline">\(g(x)\)</span> to give <span class="math inline">\(\frac{d}{d x}(f(x)g(x)) = \frac{d f(x)}{d x}g(x) + f(x)\frac{d g(x)}{d x}\)</span> by the product rule.</p></li>
<li><p>If I want an operator which multiples <span class="math inline">\(g(x)\)</span> by <span class="math inline">\(\frac{d f(x)}{d x}\)</span>, then I should write the operator as <span class="math inline">\(\left( \frac{d}{d x}f(x) \right)\)</span>, where the brackets make it clear the the derivative is “used up”, only acting on <span class="math inline">\(f(x)\)</span>.</p></li>
</ul>
</div>
<p>The derivative with respect to <span class="math inline">\(t\)</span> along the curve <span class="math inline">\(C: \underline{x}(t) = x_i(t)\underline{e}_i\)</span> as above, in operator <span class="math inline">\(\frac{d}{d t}\)</span> form, can then be rewritten using the scalar product as <span class="math display">\[\label{eq:introducedel}
	\begin{align}
		\frac{d}{d t}  &amp;= \frac{d x_1}{d t} \frac{\partial}{\partial x_1} + \dots + \frac{d x_n}{d t} \frac{\partial}{\partial x_n}  \\
		&amp;= \left( \underline{e}_1 \frac{d x_1}{d t} +\dots+ \underline{e}_n \frac{d x_n}{d t} \right) . \left( \underline{e}_1 \frac{\partial}{\partial x_1} + \dots +  \underline{e}_n\frac{\partial}{\partial x_n} \right) \\
		&amp;= \frac{d \underline{x}}{d t} \;.\; \underline{\nabla\mkern-2mu}\mkern 3mu ,
	\end{align}\]</span> where <span class="math display">\[\underline{\nabla\mkern-2mu}\mkern 3mu =  \underline{e}_1 \frac{\partial}{\partial x_1} + \dots +  \underline{e}_n\frac{\partial}{\partial x_n} \;=\; \underline{e}_i \frac{\partial}{\partial x_i}. \quad \text{(ESC)}\]</span></p>
<p>This differential operator <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu\)</span> is called ‘del’, or ‘nabla’, and is one of the most important objects in this course. Note that since <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu\)</span> is a vector quantity, we always write it with an underline.</p>
<p>If <span class="math inline">\(f(\underline{x}) : \mathbb{R}^n\to \mathbb{R}\)</span> is a scalar field, then we define its <span><u>g</u>radient</span> (“grad <span class="math inline">\(f\)</span>") to be given by the action of <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu\)</span> on <span class="math inline">\(f\)</span>: <span class="math display">\[\underline{\nabla\mkern-2mu}\mkern 3mu f \; \equiv \; \text{grad} \;f  =  \underline{e}_1 \frac{\partial f}{\partial x_1} + \underline{e}_2 \frac{\partial f}{\partial x_2} + \dots +  \underline{e}_n\frac{\partial f}{\partial x_n}.\]</span> The gradient of a scalar field is therefore a <u>vector field</u>, with components <span class="math inline">\(\frac{\partial f}{\partial x_a}\)</span>.</p>
<div id="eg:gradscalarfield" class="example">
<p> In two dimensions, with <span class="math inline">\(\underline{x}= x\underline{e}_1+y\underline{e}_2\)</span>, let <span class="math inline">\(f(\underline{x}) = (x^2+y^2)/4\)</span>. Then we have <span class="math display">\[\begin{aligned}
			\Rightarrow \quad \frac{\partial f}{\partial x} &amp;=&amp; \frac{x}{2} \quad \frac{\partial f}{\partial y} \;=\; \frac{y}{2} \\
			\Rightarrow \quad \underline{\nabla\mkern-2mu}\mkern 3mu f &amp;=&amp; \frac{1}{2}  x\underline{e}_1+ \frac{1}{2} y\underline{e}_2 \;=\; \frac{1}{2} \underline{x}.
		\end{aligned}\]</span></p>
<p>The vector field can be drawn by arrows of length <span class="math inline">\(|\underline{\nabla\mkern-2mu}\mkern 3mu f |\)</span> and direction parallel to <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> starting at a variety of sample points:</p>
<div class="center">
<figure>
<img src="gradientscalarfieldexample.png" id="fig:gradientscalarfield" style="width:60.0%" alt="" /><figcaption>Level sets of the function <span class="math inline">\(f(\underline{x}) = (x^2+y^2)/4\)</span> are shown in a contour plot. A plot of the vector field <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{x})\)</span> is overlaid on top of this, showing the vectors pointing away from the origin, parallel to the position vectors <span class="math inline">\(\underline{x}\)</span>. The vectors in the vector field <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{x})\)</span> are perpendicular to the level sets of <span class="math inline">\(f(\underline{x})\)</span>.</figcaption>
</figure>
</div>
</div>
<div id="eg:gradscalfield2" class="example">
<p> In three dimensions, with <span class="math inline">\(\underline{x}= x\underline{e}_1+y\underline{e}_2 +z\underline{e}{3}\)</span>, let <span class="math inline">\(\underline{a} = a_1\underline{e}_1 +  a_2 \underline{e}_2 + a_3\underline{e}_3\)</span> be a constant vector, and let <span class="math inline">\(f(\underline{x}) = \underline{a}.\underline{x}-\underline{x}.\underline{x}\)</span>. Then we have <span class="math display">\[\begin{aligned}
			f &amp;= a_1 x + a_2 y + a_3 z - (x^2+y^2 + z^2) \\
			\Rightarrow \quad \frac{\partial f}{\partial x} &amp;= a_1 -2x, \quad \quad\frac{\partial f}{\partial y} \;=\; a_2 -2y, \quad \quad\frac{\partial f}{\partial z} \;=\; a_3 -2z \\
			\Rightarrow \quad \underline{\nabla\mkern-2mu}\mkern 3mu f &amp;= \underline{e}_1(a_1-2x)+\underline{e}_2(a_2-2y)+ \underline{e}_3(a_3-2z) \\
			&amp;= \underline{a} -2\underline{x}.
		\end{aligned}\]</span></p>
<p>Although the picture is less easy to interpret than the 2-dimensional example, for completeness this is included as Figure <a href="#fig:gradientscalarfield3d" data-reference-type="ref" data-reference="fig:gradientscalarfield3d">8</a>.</p>
<div class="center">
<figure>
<img src="gradientscalarfieldexample2.png" id="fig:gradientscalarfield3d" style="width:50.0%" alt="" /><figcaption>The contour plot of a scalar field overlaid with the gradient vector field in 3d. Parts of three level sets can be seen as spherical shells (with what center?) and representative vectors of <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> can be seen as red arrows. As in example <a href="#eg:gradscalarfield" data-reference-type="ref" data-reference="eg:gradscalarfield">[eg:gradscalarfield]</a>, the vectors of <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> can be seen to be normal to the level sets of <span class="math inline">\(f\)</span>. We return to this idea in the next section.</figcaption>
</figure>
</div>
</div>
</section>
<section id="sub:directionalderivatives" class="level2" data-number="3.2">
<h2 data-number="2.2"><span class="header-section-number">2.2</span> Directional derivatives</h2>
<p>Let <span class="math inline">\(C:\underline{x}=\underline{x}(t)\)</span> be a curve in <span class="math inline">\(\mathbb{R}^n\)</span>, and <span class="math inline">\(f:\mathbb{R}^n\to \mathbb{R}\)</span> a scalar field. Then <span class="math inline">\(f(\underline{x}(t)): \mathbb{R}\to \mathbb{R}\)</span> is <span class="math inline">\(f\)</span> restricted to <span class="math inline">\(C\)</span> and <span class="math display">\[\frac{d}{d t} f(\underline{x}(t)) \;=\; \frac{d \underline{x}}{d t} . \underline{\nabla\mkern-2mu}\mkern 3mu f \quad \quad\text{by chain rule.}\]</span></p>
<div class="center">
<figure>
<img src="directionalderivative.jpg" id="fig:directionalderivative" style="width:60.0%" alt="" /><figcaption>The tangent to a curve <span class="math inline">\(C\)</span> at a point <span class="math inline">\(p\)</span> is shown alongside an example of the gradient of a scalar field at the same point <span class="math inline">\(p\)</span>. </figcaption>
</figure>
</div>
<p>As we saw in subsection <a href="#sub:scalar_fields_vector_fields_and_curves" data-reference-type="ref" data-reference="sub:scalar_fields_vector_fields_and_curves">2.2</a>, <span class="math inline">\(\frac{d \underline{x}}{d t}\)</span> is tangent to <span class="math inline">\(C\)</span> at <span class="math inline">\(\underline{x}(t)\)</span>. If we change to a parameterisation in terms of the arc-length <span class="math inline">\(s\)</span>, such that the tangent <span class="math inline">\(\frac{d \underline{x}}{d s} = \hat{\underline{n}}\)</span> is a unit tangent (see example <a href="#eg:arclengthparam" data-reference-type="ref" data-reference="eg:arclengthparam">[eg:arclengthparam]</a> for a justification as to why this is possible), then we have <span class="math display">\[\frac{d f(\underline{x}(s))}{d s} \;=\; \hat{\underline{n}} \:.\: \underline{\nabla\mkern-2mu}\mkern 3mu f.\]</span></p>
<p>Now <span class="math inline">\(\frac{d f(\underline{x}(s))}{d s}\)</span> is the rate of change of <span class="math inline">\(f\)</span> with respect to distance (arc length) in the direction <span class="math inline">\(\hat{\underline{n}}\)</span>. This is called the <u>directional derivative</u> of <span class="math inline">\(f\)</span> in the direction <span class="math inline">\(\hat{\underline{n}}\)</span> (and is sometimes written <span class="math inline">\(\frac{d f}{d \hat{\underline{n}}}\)</span>).</p>
<p>Notice that: <span class="math display">\[\begin{aligned}
		\frac{d f}{d s} &amp;= \hat{\underline{n}}\:.\: \underline{\nabla\mkern-2mu}\mkern 3mu f \;=\; | \hat{\underline{n}}|  \; | \underline{\nabla\mkern-2mu}\mkern 3mu f | \cos \theta\\
		&amp;= | \underline{\nabla\mkern-2mu}\mkern 3mu f | \cos \theta\; \le \; | \underline{\nabla\mkern-2mu}\mkern 3mu f |.
	\end{aligned}\]</span></p>
<p>Therefore <span class="math inline">\(| \underline{\nabla\mkern-2mu}\mkern 3mu f |\)</span> is the greatest value of the directional derivative over all possible directions <span class="math inline">\(\hat{\underline{n}}\)</span>. This value is achieved when <span class="math inline">\(\theta=0\)</span>, i.e. when <span class="math inline">\(\hat{\underline{n}}\parallel  \underline{\nabla\mkern-2mu}\mkern 3mu f\)</span>. Therefore <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> points in the direction <u>where <span class="math inline">\(f\)</span> increases fastest</u>.</p>
<p>Note that in example <a href="#eg:gradscalarfield" data-reference-type="ref" data-reference="eg:gradscalarfield">[eg:gradscalarfield]</a>, the vectors in the vector field <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> are normal to the curves of constant <span class="math inline">\(| \underline{x}|\)</span>, which were the curves of constant <span class="math inline">\(f\)</span>. This also holds more generally. In <span class="math inline">\(\mathbb{R}^n\)</span>, suppose <span class="math inline">\(C\)</span> lies entirely in the <u>level set</u> <span class="math inline">\(f(\underline{x}) = k\)</span> for <span class="math inline">\(k\)</span> some constant. Call this whole level set <span class="math inline">\(S\)</span>, so <span class="math inline">\(C \subset S\)</span>.</p>
<div class="center">
<figure>
<img src="levelset.jpg" id="fig:curveinlevelset" style="width:50.0%" alt="" /><figcaption>The curve <span class="math inline">\(C\)</span> contained entirely within a level set of the function <span class="math inline">\(f\)</span>. In two dimension the level sets are themselves curves, but in higher dimension spaces these level sets become surfaces, and hypersurfaces. You should think that the condition <span class="math inline">\(f(\underline{x})=k\)</span> is a single constraint on a <span class="math inline">\(n\)</span>-dimensional space, so the points which satisfy this constraint for an <span class="math inline">\((n-1)\)</span>-dimensional hypersurface.</figcaption>
</figure>
</div>
<p>So on this <span class="math inline">\(C\)</span>, <span class="math inline">\(f(\underline{x}(t)) = k\)</span> and <span class="math display">\[\label{eq:gradientnormaltolevelset}
	\begin{align}
		0 &amp;= \frac{d f}{d t} \;=\; \frac{d \underline{x}}{d t} \:.\; \underline{\nabla\mkern-2mu}\mkern 3mu f \\
		\Rightarrow \quad &amp; \frac{d \underline{x}}{d t} \bot \underline{\nabla\mkern-2mu}\mkern 3mu f,
	\end{align}\]</span> i.e. At all points <span class="math inline">\(p\)</span> in a level set of <span class="math inline">\(f\)</span>, <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> is orthogonal to any curve through <span class="math inline">\(p\)</span> contained in the level set.</p>
<p>In <span class="math inline">\(\mathbb{R}^3\)</span>, the <u>plane</u> through <span class="math inline">\(P\)</span> orthogonal to <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> is called the <u>tangent plane</u> to <span class="math inline">\(S\)</span> at <span class="math inline">\(P\)</span>. The tangent to any curve in <span class="math inline">\(S\)</span> through <span class="math inline">\(P\)</span> lies in this plane. In Calculus I you already used this to find the equation of the tangent plane to a surface at a point.</p>
</section>
<section id="some-properties-of-the-gradient" class="level2" data-number="3.3">
<h2 data-number="2.3"><span class="header-section-number">2.3</span> Some properties of the gradient</h2>
<p>If <span class="math inline">\(f,g:\mathbb{R}^n\to\mathbb{R}\)</span> are scalar fields, <span class="math inline">\(\phi\)</span> is a function <span class="math inline">\(\phi: \mathbb{R}\to \mathbb{R}\)</span>, and <span class="math inline">\(a\)</span> &amp; <span class="math inline">\(b\)</span> are constants then, <span class="math display">\[\begin{aligned}
		(i)&amp;\quad \underline{\nabla\mkern-2mu}\mkern 3mu (af+bg) \;\;=\;\; a\underline{\nabla\mkern-2mu}\mkern 3mu f + b \underline{\nabla\mkern-2mu}\mkern 3mu g   \\
		(ii)&amp;\quad \underline{\nabla\mkern-2mu}\mkern 3mu (fg) \;\;=\;\; (\underline{\nabla\mkern-2mu}\mkern 3mu f) g + f(\underline{\nabla\mkern-2mu}\mkern 3mu g) \\
		(iii)&amp;\quad \underline{\nabla\mkern-2mu}\mkern 3mu \phi(f) \;\;=\;\; (\underline{\nabla\mkern-2mu}\mkern 3mu f) \frac{d \phi}{d f}.
	\end{aligned}\]</span> Note that as always with differential operators, the brackets are very important here. This is because <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu fg\)</span> means <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu (fg)\)</span>, since derivatives (<span class="math inline">\(\frac{\partial}{\partial x}\)</span> etc.) act on everything to the right.</p>
<div id="eg:propertiesofgrad" class="example">
<p> Let <span class="math inline">\(n=2\)</span> and <span class="math inline">\(\underline{x}= x\underline{e}_1 + y\underline{e}_2\)</span>. If we now take <span class="math inline">\(\phi(f) = f^2\)</span> and <span class="math inline">\(f(x,y) = x \sin y\)</span>,</p>
<p>If we now take <span class="math display">\[\begin{aligned}
			\phi(f(x,y)) &amp;= x^2 \sin^2 y  \\
			\Rightarrow \quad \underline{\nabla\mkern-2mu}\mkern 3mu \phi(f) &amp;= \underline{\nabla\mkern-2mu}\mkern 3mu (x^2 \sin^2 y) \\
			&amp;= 2x\sin^2 y \; \underline{e}_1 + 2x^2\cos y \sin y \; \underline{e}_2,
		\end{aligned}\]</span> by direct calculation. Or: <span class="math display">\[\begin{aligned}
			\underline{\nabla\mkern-2mu}\mkern 3mu f &amp;= \sin y \; \underline{e}_1 + x \cos y \; \underline{e}_2  \\
			\Rightarrow \quad \frac{d \phi}{d f} &amp;= 2f    \\
			\Rightarrow \quad (\underline{\nabla\mkern-2mu}\mkern 3mu f) \frac{d \phi}{d f} &amp;=  (\sin y \; \underline{e}_1 + x \cos y \; \underline{e}_2) 2 x \sin y  \\
			\Rightarrow \quad \underline{\nabla\mkern-2mu}\mkern 3mu \phi(f) &amp;= 2x\sin^2 y \; \underline{e}_1 + 2x^2\cos y \sin y \; \underline{e}_2,
		\end{aligned}\]</span> which shows that property iii holds in this case.</p>
</div>
<p>If we now let <span class="math inline">\(\underline{x}= x_1\underline{e}_1 + \ldots + x_n\underline{e}_n\)</span>, then these properties can be shown to hold in the general case as follows: <span class="math display">\[\begin{aligned}
		(i)\quad \underline{\nabla\mkern-2mu}\mkern 3mu (af + bg) &amp;= \underline{e}_1\frac{\partial}{\partial x_1}(af+bg) + \ldots + \underline{e}_n\frac{\partial}{\partial x_n}(af+bg) \\
		  &amp;= \underline{e}_1\left(a\frac{\partial f}{\partial x_1} + b\frac{\partial g}{\partial x_1}\right) + \ldots + \underline{e}_n \left(a \frac{\partial f}{\partial x_n} + b \frac{\partial g}{\partial x_n}\right) \\
		  &amp;= a\left(\underline{e}_1\frac{\partial f}{\partial x_1} + \ldots + \underline{e}_n \frac{\partial f}{\partial y}\right) + b\left( \underline{e}_1 \frac{\partial g}{\partial x_1} + \underline{e}_2 \frac{\partial g}{\partial x_n}\right) \\
		  &amp;= a\underline{\nabla\mkern-2mu}\mkern 3mu f + b\underline{\nabla\mkern-2mu}\mkern 3mu g.
	\\\\
		(ii)\quad \underline{\nabla\mkern-2mu}\mkern 3mu (fg) &amp;= \underline{e}_1\frac{\partial}{\partial x_1}(fg) + \ldots + \underline{e}_n\frac{\partial}{\partial x_n}(fg)  \\
		 &amp;= \underline{e}_1 \left( \left(\frac{\partial f}{\partial x_1} \right)g +  f\frac{\partial g}{\partial x_1} \right)   + \ldots +  \underline{e}_n  \left( \left(\frac{\partial f}{\partial x_n} \right)g + f\frac{\partial g}{\partial x_n} \right)  \\
		 &amp;=  \left(\underline{e}_1\frac{\partial f}{\partial x_1} + \ldots + \underline{e}_n\frac{\partial f}{\partial x_n} \right)g + f \left(\underline{e}_1\frac{\partial g}{\partial x_1} + \ldots + \underline{e}_n\frac{\partial g}{\partial x_n} \right)\\
		 &amp;= (\underline{\nabla\mkern-2mu}\mkern 3mu f)g + f\underline{\nabla\mkern-2mu}\mkern 3mu g.
	\\\\
		(iii)\quad\underline{\nabla\mkern-2mu}\mkern 3mu \phi &amp;= \underline{e}_1 \frac{\partial \phi}{\partial x_1} + \dots + \underline{e}_n \frac{\partial \phi}{\partial x_n} \\
			&amp;= \underline{e}_1 \frac{\partial f}{\partial x_1}\frac{d \phi}{d f} + \dots + \underline{e}_n \frac{\partial f}{\partial x_n}\frac{d \phi}{d f} \\
			&amp;= (\underline{\nabla\mkern-2mu}\mkern 3mu f) \frac{d \phi}{d f}.
	\end{aligned}\]</span></p>
</section>
</section>
<section id="underlinenablamkern-2mumkern-3mu-acting-on-vector-fields" class="level1" data-number="4">
<h1 data-number="3"><span class="header-section-number">3</span> <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu\)</span> acting on vector fields</h1>
<p>So far we’ve introduced scalar fields and vector fields, and seen how the differential operator <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu\)</span> can act on a scalar field <span class="math inline">\(f(\underline{x}):\mathbb{R}^n \to \mathbb{R}\)</span> to give a vector field known as the gradient of the scalar field, <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span>. We also saw that the gradient tells us the direction in which the scalar field increases fastest. As the title of this section suggests, we’re now going to see how we can define an action of <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu\)</span> on vector fields <span class="math inline">\(\underline{v}(\underline{x}): \mathbb{R}^n \to \mathbb{R}^n\)</span>, and what these quantities can tell us about the original vector field.</p>
<section id="sub:divergence" class="level2" data-number="4.1">
<h2 data-number="3.1"><span class="header-section-number">3.1</span> Divergence (div)</h2>
<p>Since <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu\)</span> is a vector operator, and vector fields assign a vector <span class="math inline">\(\underline{v}(\underline{x})\)</span> for each point <span class="math inline">\(\underline{x}\in \mathbb{R}^n\)</span>, we can take the dot product between <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu\)</span> and <span class="math inline">\(\underline{v}(\underline{x})\)</span>. This quantity <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu .\underline{v}\)</span> is the known as the <em>divergence</em> of <span class="math inline">\(\underline{v}\)</span>, and is also written as div <span class="math inline">\(\underline{v}\)</span>.</p>
<p>In the standard <u>cartesian</u> basis for <span class="math inline">\(\mathbb{R}^n\)</span> <span class="math display">\[\begin{aligned}
		\underline{v}(\underline{x}) &amp;= \underline{e}_1 v_1(\underline{x}) + \underline{e}_2v_2(\underline{x}) + \dots + \underline{e}_n v_n(\underline{x}) \\
		\Rightarrow \quad \quad\underline{\nabla\mkern-2mu}\mkern 3mu . \underline{v}\;\equiv\;  {\rm div}\:\underline{v}&amp;\equiv (\underline{e}_1 \frac{\partial}{\partial x_1} + \dots + \underline{e}_n \frac{\partial}{\partial x_n}) \: . \: (\underline{e}_1 v_1(\underline{x}) + \dots + \underline{e}_n v_n(\underline{x}) ) \\
		&amp;= \frac{\partial v_1}{\partial x_1} + \frac{\partial v_2}{\partial x_2} + \dots + \frac{\partial v_n}{\partial x_n} \\
		&amp;= \sum_{i=1}^n \frac{\partial v_i}{\partial x_i} \quad \quad\text{(index notation)} \\
		&amp;= \frac{\partial v_i}{\partial x_i}, \quad \quad\text{(Einstein Summation Convention)}
	\end{aligned}\]</span> since the <span class="math inline">\(\underline{e}_a\)</span> are <u>orthonormal</u> and <u>constant</u>.</p>
<p><u>Beware!</u> In other coordinate systems the basis vectors <span class="math inline">\(\underline{e}_a\)</span> might vary with <span class="math inline">\(\underline{x}\)</span> and hence the formula needs more care. We may return to the divergence in other coordinate systems later in the term, depending on time.</p>
<p><u>Note</u>: <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu . \underline{v}(\underline{x})\)</span> is a <u>scalar</u> field, as can be seen in the following example.</p>
<div id="eg:divisscalar" class="example">
<p> <span class="math display">\[\begin{aligned}
			\underline{v}(\underline{x}) &amp;= (v_1(\underline{x}),v_2(\underline{x}),v_3(\underline{x})) \;=\; (x^2, y^2, z^2) \\
			\underline{\nabla\mkern-2mu}\mkern 3mu .\underline{v}&amp;= \frac{\partial x^2}{\partial x} + \frac{\partial y^2}{\partial y} + \frac{\partial z^2}{\partial z} \\
			&amp;= 2(x+y+z),
		\end{aligned}\]</span> a <u>number</u> for each point <span class="math inline">\(\underline{x}=(x,y,z)\)</span> <u>not</u> a vector.</p>
</div>
<p>Although we treat <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu\)</span> like a vector, note that it is a vector <u>differential operator</u>, and therefore is not actually a vector in <span class="math inline">\(\mathbb{R}^n\)</span> like <span class="math inline">\(\underline{x}\)</span> is. Therefore although the inner product on <span class="math inline">\(\mathbb{R}^n\)</span> is symmetric, note that <span class="math display">\[\underline{\nabla\mkern-2mu}\mkern 3mu . \underline{v}\; \ne \; \underline{v}. \underline{\nabla\mkern-2mu}\mkern 3mu ,\]</span> as the left-hand side of this is a scalar field, whereas the right-hand side is the (scalar) differential operator <span class="math display">\[\left(x^2 \frac{\partial}{\partial x} + y^2\frac{\partial}{\partial y} + z^2\frac{\partial}{\partial z} \right)\]</span> acting on scalar fields.</p>
<p>To get an intuition of what the divergence tells us about our vector field, we should think of our vector field as if it were a fluid, where the direction of a vector at a point tells us the direction of fluid flow at that point, and the magnitude of the vector tells us how fast the fluid is flowing at the point. The divergence of the vector field at a point then tells us whether the point is acting like a <em>source</em> (corresponding to positive divergence) or a <em>sink</em> (negative divergence) for the fluid. That is, whether more of the ‘fluid’ is entering than the point than is leaving. This is shown for a vector field <span class="math inline">\(\underline{v}\)</span> in Figure <a href="#fig:divergence" data-reference-type="ref" data-reference="fig:divergence">13</a>, where the divergence at the origin is positive, negative and zero respectively.</p>
<table id="fig:divergence" class="imageTable">
<caption>The divergence of a vector field at a point tells us whether the point acts like a source or a sink for the vector field, if we think of the vector field as describing the flow of a fluid.</caption>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="positivedivergence.png" title="fig:" id="fig:divergence" style="width:30.0%" alt="The divergence of a vector field at a point tells us whether the point acts like a source or a sink for the vector field, if we think of the vector field as describing the flow of a fluid." />  </td>
<td style="text-align: center;">  <img src="negativedivergence.png" title="fig:" id="fig:divergence" style="width:30.0%" alt="The divergence of a vector field at a point tells us whether the point acts like a source or a sink for the vector field, if we think of the vector field as describing the flow of a fluid." />  </td>
<td style="text-align: center;">  <img src="zerodivergence.png" title="fig:" id="fig:divergence" style="width:30.0%" alt="The divergence of a vector field at a point tells us whether the point acts like a source or a sink for the vector field, if we think of the vector field as describing the flow of a fluid." /></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu .\underline{v}&gt;0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu .\underline{v}&lt;0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu .\underline{v}=0\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="properties-of-div" class="level2 unnumbered">
<h2 class="unnumbered">Properties of div:</h2>
<p>Let <span class="math inline">\(a,b\)</span> be constants, <span class="math inline">\(f,g\)</span> be scalar fields and <span class="math inline">\(\underline{v},\underline{w}\)</span> vector fields, all in <span class="math inline">\(\mathbb{R}^n\)</span>. Then <span class="math display">\[\begin{aligned}
		(i)&amp; \underline{\nabla\mkern-2mu}\mkern 3mu .(a\underline{v}+ b\underline{w}) \;=\; a \underline{\nabla\mkern-2mu}\mkern 3mu .\underline{v}+ b \underline{\nabla\mkern-2mu}\mkern 3mu .\underline{w}\\
		(ii)&amp; \underline{\nabla\mkern-2mu}\mkern 3mu .(f\underline{v}) \;=\; (\underline{\nabla\mkern-2mu}\mkern 3mu f).\underline{v}+ f \underline{\nabla\mkern-2mu}\mkern 3mu .\underline{v}
	\end{aligned}\]</span></p>
<p><u>Proof:</u> (i) This follows from linearity of the partial derivative: <span class="math display">\[\begin{aligned}
		\underline{\nabla\mkern-2mu}\mkern 3mu . (a\underline{v}+ b\underline{w}) &amp;= \frac{\partial (av_1 + bw_1)}{\partial x_1} + \dots + \frac{\partial (av_n + bw_n)}{\partial x_n} \\
		&amp;= a\frac{\partial v_1}{\partial x_1} + b\frac{\partial w_1}{\partial x_1} + \dots + a\frac{\partial v_n}{\partial x_n} + b\frac{\partial w_n}{\partial x_n} \\
		&amp;=  a \left( \frac{\partial v_1}{\partial x_1} + \dots + \frac{\partial v_n}{\partial x_n} \right) + b \left( \frac{\partial w_1}{\partial x_1} + \dots + \frac{\partial w_n}{\partial x_n} \right) \\
		&amp;= a\underline{\nabla\mkern-2mu}\mkern 3mu .\underline{v}+ b \underline{\nabla\mkern-2mu}\mkern 3mu .\underline{w}.
	\end{aligned}\]</span> (ii) First note that <span class="math inline">\(f\underline{v}\)</span> is a vector field with components <span class="math inline">\((fv_1,fv_2, fv_3, \dots, fv_n)\)</span>, so <span class="math display">\[\begin{aligned}
		\underline{\nabla\mkern-2mu}\mkern 3mu . (f\underline{v}) &amp;= \frac{\partial fv_1}{\partial x_1}+\dots + \frac{\partial fv_n}{\partial x_n} \\
		&amp;= \frac{\partial f}{\partial x_1}v_1 + f\frac{\partial v_1}{\partial x_1} + \dots +  \frac{\partial f}{\partial x_n}v_n + f\frac{\partial v_n}{\partial x_n} \\
		&amp;=  \frac{\partial f}{\partial x_1}v_1 + \dots +  \frac{\partial f}{\partial x_n}v_n \;+\; f\frac{\partial v_1}{\partial x_1} + \dots + f\frac{\partial v_n}{\partial x_n} \\
		&amp;= (\underline{\nabla\mkern-2mu}\mkern 3mu f).\underline{v}\:+\: f(\underline{\nabla\mkern-2mu}\mkern 3mu .\underline{v}).
	\end{aligned}\]</span> Once we finish section <a href="#sec:indexnotation" data-reference-type="ref" data-reference="sec:indexnotation">5</a>, we’ll be able to derive this more effectively by using index notation.</p>
<div id="eg:divergenceproperty" class="example">
<p> Suppose <span class="math display">\[\begin{aligned}
			f(\underline{x}) &amp;= \underline{a}.\underline{x}\\
			\underline{v}(\underline{x})&amp;= \underline{a}\quad \quad\text{a constant} \\
			\Rightarrow\quad \quad f\underline{v}&amp;= (\underline{a}.\underline{x}) \underline{a}\\
			&amp;= (a_1x+a_2y+a_3 z)(a_1\underline{e}_1 + a_2\underline{e}_2 + a_3\underline{e}_3) \\
			\Rightarrow\quad \underline{\nabla\mkern-2mu}\mkern 3mu .((\underline{a}.\underline{x}) \underline{a}) &amp;= \frac{\partial}{\partial x}(a_1(a_1x+a_2y+a_3z)) \\
			&amp; +\frac{\partial}{\partial y}(a_2(a_1x+a_2y+a_3z)) \\
			&amp; +\frac{\partial}{\partial z}(a_3(a_1x+a_2y+a_3z)) \\
			&amp;= a_1^2 + a_2^2 + a_3^2 \;=\; \|\underline{a}\|^2 \quad \quad
		\end{aligned}\]</span> by direct calculation. Or, using property (ii): <span class="math display">\[\underline{\nabla\mkern-2mu}\mkern 3mu .((\underline{a}.\underline{x}) \underline{a}) \;=\; (\underline{\nabla\mkern-2mu}\mkern 3mu \underline{a}.\underline{x}). \underline{a}+ (\underline{a}.\underline{x}) \underline{\nabla\mkern-2mu}\mkern 3mu .\underline{a}.\]</span> But <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu .\underline{a}=0\)</span>, while <span class="math display">\[\begin{aligned}
		\underline{\nabla\mkern-2mu}\mkern 3mu (\underline{a}.\underline{x}) &amp;= (\underline{e}_1\frac{\partial}{\partial x} + \underline{e}_2\frac{\partial}{\partial y} + \underline{e}_3\frac{\partial}{\partial z} ) (a_1x+a_2y+a_3z) \\
		&amp;= \underline{e}_1a_1 + \underline{e}_2a_2 + \underline{e}_3 a_3 \;=\; \underline{a}\\
		\quad \quad\underline{\nabla\mkern-2mu}\mkern 3mu .((\underline{a}.\underline{x}) \underline{a}) &amp;= \underline{a}.\underline{a}\;=\; \|\underline{a}\|^2
	\end{aligned}\]</span> agreeing with the direct calculation.</p>
</div>
</section>
<section id="curl" class="level2" data-number="4.2">
<h2 data-number="3.2"><span class="header-section-number">3.2</span> Curl</h2>
<p>In 3 dimensions, there is a second type of product one can take between vectors, and this is the vector cross product. Recall that we define the vector product of two vectors <span class="math inline">\(\underline{A}\)</span> and <span class="math inline">\(\underline{B}\)</span> as <span class="math display">\[\begin{aligned}
		\underline{A} \times \underline{B} &amp;= \left| 
					\begin{array}{ccc}
					\underline{e}_1 &amp; \underline{e}_2 &amp; \underline{e}_3 \\
					A_1 &amp; A_2 &amp; A_3 \\
					B_1 &amp; B_2 &amp; B_3 \\
					\end{array}
					\right|  \\
					&amp;= \underline{e}_1 (A_2 B_3 -A_3 B_2) + \underline{e}_2 (A_3B_1-A_1B_3) + \underline{e}_3 (A_1B_2 - A_2 B_1).
	\end{aligned}\]</span></p>
<p>Then, for a vector field <span class="math inline">\(\underline{v}(\underline{x})\)</span> in 3 dimensions, define the <u>curl</u> of <span class="math inline">\(\underline{v}\)</span> as <span class="math display">\[\underline{\nabla\mkern-2mu}\mkern 3mu \times \underline{v}(\underline{x}) \;\equiv\; {\rm curl}\: \underline{v}\:\equiv\; 
				\left| 
				\begin{array}{ccc}
				\underline{e}_1 &amp; \underline{e}_2 &amp; \underline{e}_3 \\
				\frac{\partial}{\partial x} &amp; \frac{\partial}{\partial y} &amp; \frac{\partial}{\partial z} \\
				v_1 &amp; v_2 &amp; v_3 \\
				\end{array}
				\right|,\]</span> where we have to expand this <em>always making sure that the derivatives <span class="math inline">\(\frac{\partial}{\partial x_i}\)</span> are on the left of the <span class="math inline">\(v_i\)</span></em>. So therefore we have <span class="math display">\[\begin{aligned}
		\underline{\nabla\mkern-2mu}\mkern 3mu \times \underline{v}(\underline{x}) &amp;=
					\left| 
					\begin{array}{ccc}
					\underline{e}_1 &amp; \underline{e}_2 &amp; \underline{e}_3 \\
					\frac{\partial}{\partial x} &amp; \frac{\partial}{\partial y} &amp; \frac{\partial}{\partial z} \\
					v_1 &amp; v_2 &amp; v_3 \\
					\end{array}
					\right|
			&amp;=  \underline{e}_1 (\frac{\partial v_3}{\partial y} - \frac{\partial v_2}{\partial z}) + \underline{e}_2 (\frac{\partial v_1}{\partial z}-\frac{\partial v_3}{\partial x}) + \underline{e}_3 (\frac{\partial v_2}{\partial x} - \frac{\partial v_1}{\partial y}).
	\end{aligned}\]</span> Note that the curl of a vector field is therefore a <em>new</em> <u>vector</u> field.</p>
<div id="eg:curl" class="example">
<p> if <span class="math inline">\(\underline{v}: \mathbb{R}^3 \to \mathbb{R}^3\)</span> is a vector field, and can be expressed in terms of its components as <span class="math inline">\(\underline{v}= (x^2z,xyz,x)\)</span>, then <span class="math display">\[\begin{aligned}
			\text{curl } \underline{v}&amp;= \underline{\nabla\mkern-2mu}\mkern 3mu \times \underline{v}\;=\; 
						\left| 
						\begin{array}{ccc}
						\underline{e}_1 &amp; \underline{e}_2 &amp; \underline{e}_3 \\
						\frac{\partial}{\partial x} &amp; \frac{\partial}{\partial y} &amp; \frac{\partial}{\partial z} \\
						x^2z &amp; xyz &amp; x \\
						\end{array}
						\right|  \\
			&amp;= \underline{e}_1 (\frac{\partial x}{\partial y} - \frac{\partial xyz}{\partial z}) + \underline{e}_2 (\frac{\partial x^2z}{\partial z}-\frac{\partial x}{\partial x}) + \underline{e}_3 (\frac{\partial xyz}{\partial x} - \frac{\partial x^2z}{\partial y}) \\
			&amp;= -xy \underline{e}_1 + (x^2-1) \underline{e}_2 + yz \underline{e}_3
		\end{aligned}\]</span></p>
</div>
<p>Note that since <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \times \underline{v}\)</span> is a vector field, we can calculate its divergence. In the case of <span class="math inline">\(\underline{v}\)</span> being the vector field from Example <a href="#eg:curl" data-reference-type="ref" data-reference="eg:curl">[eg:curl]</a>, <span class="math display">\[\begin{aligned}
		\underline{\nabla\mkern-2mu}\mkern 3mu .(\underline{\nabla\mkern-2mu}\mkern 3mu \times \underline{v}) &amp;= \frac{\partial}{\partial x}(-xy) + \frac{\partial}{\partial y} (x^2-1) + \frac{\partial}{\partial z}(yz) \\
			&amp;= -y +0 +y \;=\; 0.
	\end{aligned}\]</span> In turns out that this is <u>always</u> true so long as <span class="math inline">\(\underline{v}\)</span> has components with continuous second partial derivatives. We’ll come back to this in subsection <a href="#sub:applyingdeltwice" data-reference-type="ref" data-reference="sub:applyingdeltwice">4.3</a>.</p>
<p>The curl of a vector field <span class="math inline">\(\underline{v}\)</span>, tells us how much <span class="math inline">\(\underline{v}\)</span> is ‘curling around’ at a point. If we imagine our vector field <span class="math inline">\(\underline{v}\)</span> as a fluid, like when we thought about the meaning of the divergence (see subsection <a href="#sub:divergence" data-reference-type="ref" data-reference="sub:divergence">4.1</a>), the magnitude of the curl then tells us about the rotational speed of the fluid, and the direction of the curl then tells us which axis the fluid is rotating around. This axis is determined using the so-called ‘right-hand rule’: If you curl the fingers of your right hand, such that your fingers represent the rotation of the fluid, then your thumb points in the direction of the curl vector.</p>
<div id="eg:simplecurl" class="example">
<p> Consider the vector field <span class="math inline">\(\underline{v}\)</span> with components <span class="math inline">\(\underline{v}=(-y,x,0)\)</span>. To imagine this vector field, realise that it is independent of <span class="math inline">\(z\)</span>, and so you can imagine the vector field in the <span class="math inline">\(z=0\)</span> plane, and the vector field in any other plane of <span class="math inline">\(z\)</span> is then just a translation of the vector field at <span class="math inline">\(z=0\)</span>. This <span class="math inline">\(z=0\)</span> plane is shown in Figure <a href="#fig:simplecurl" data-reference-type="ref" data-reference="fig:simplecurl">14</a></p>
<div class="center">
<figure>
<img src="simplevectorfieldexample2.png" id="fig:simplecurl" style="width:60.0%" alt="" /><figcaption>The plane <span class="math inline">\(z=0\)</span> of the vector field <span class="math inline">\(\underline{v}=(-y,x,0)\)</span>, where the horizontal axis of the image is the <span class="math inline">\(x\)</span>-axis, and the vertical axis is the <span class="math inline">\(y\)</span>-axis. You should imagine the <span class="math inline">\(z\)</span>-axis as coming straight out of the page.</figcaption>
</figure>
</div>
<p>The curl of this vector field can then easily be checked to be <span class="math display">\[\underline{\nabla\mkern-2mu}\mkern 3mu \times \underline{v}= (0,0,2),\]</span> so is a vector field of constant magnitude pointing in the positive <span class="math inline">\(z\)</span> direction, as one would expect using the right-hand rule.</p>
</div>
</section>
<section id="sub:properties_of_curl" class="level2 unnumbered">
<h2 class="unnumbered">Properties of curl:</h2>
<p>Let <span class="math inline">\(a,b\)</span> be constants, <span class="math inline">\(\underline{v},\underline{w}\)</span> be vector fields, and <span class="math inline">\(f\)</span> be a scalar field, all in <span class="math inline">\(\mathbb{R}^3\)</span>. Then: <span class="math display">\[\begin{aligned}
		(i)&amp; \underline{\nabla\mkern-2mu}\mkern 3mu \times(a\underline{u}+b\underline{v}) \;=\; a\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{u}+b \underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{v}\\
		(ii)&amp; \underline{\nabla\mkern-2mu}\mkern 3mu \times(f\underline{v}) \;=\; (\underline{\nabla\mkern-2mu}\mkern 3mu f)\times \underline{v}+ f\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{v}
	\end{aligned}\]</span></p>
<p><u>Proof:</u></p>
<p>(i) follows from linearity of derivatives, as before.</p>
<p>Lets check (ii): <span class="math display">\[\begin{aligned}
		\underline{\nabla\mkern-2mu}\mkern 3mu \times(f\underline{v}) =&amp; \underline{e}_1 \left[ \frac{\partial}{\partial y}(fv_3) - \frac{\partial}{\partial z}(fv_2) \right] + \underline{e}_2 \left[ \frac{\partial}{\partial z}(fv_1) - \frac{\partial}{\partial x}(fv_3) \right] \\ 
				&amp;+ \underline{e}_3 \left[ \frac{\partial}{\partial x}(fv_2) - \frac{\partial}{\partial y}(fv_1) \right] \\
			=&amp;\ \underline{e}_1\left[   \left( \frac{\partial f}{\partial y} \right) v_3 + f\frac{\partial v_3}{\partial y} - \left( \frac{\partial f}{\partial z} \right) v_2 - f\frac{\partial v_2}{\partial z}   \right]
				+ \left[  \dots  \right] + \left[  \dots  \right]   \\
			=&amp;\ \underline{e}_1 \left[  \left( \frac{\partial f}{\partial y} \right) v_3 - \left( \frac{\partial f}{\partial z} \right) v_2  \right] \;+\; \underline{e}_1 f \left[   \frac{\partial v_3}{\partial y} - \frac{\partial v_2}{\partial z}  \right] + \dots + \dots \\
			=&amp;\ \underline{\nabla\mkern-2mu}\mkern 3mu f \times \underline{v}\:+\: f\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{v}
	\end{aligned}\]</span></p>
<p>This is tedious. Once we develop our index notation in section <a href="#sec:indexnotation" data-reference-type="ref" data-reference="sec:indexnotation">5</a> we will be able to do this in a slicker way.</p>
</section>
<section id="sub:applyingdeltwice" class="level2" data-number="4.3">
<h2 data-number="3.3"><span class="header-section-number">3.3</span> Applying <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu\)</span> twice</h2>
<p>If <span class="math inline">\(f: \mathbb{R}^n\to \mathbb{R}\)</span> is a scalar field then <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> is a vector field and we can take its divergence. This is <span class="math display">\[\begin{aligned}
		\underline{\nabla\mkern-2mu}\mkern 3mu .(\underline{\nabla\mkern-2mu}\mkern 3mu f) &amp;= \text{div grad } f \equiv  \nabla^2f \equiv \Delta f  \\
		&amp;= \left(  \underline{e}_1 \frac{\partial}{\partial x_1} + \dots + \underline{e}_n \frac{\partial}{\partial x_n}  \right) . \left(  \underline{e}_1 \frac{\partial}{\partial x_1} + \dots + \underline{e}_n \frac{\partial}{\partial x_n}  \right)  f \\
		&amp;= \frac{\partial^2 f}{\partial x_1^2} + \dots + \frac{\partial^2 f}{\partial x_n^2}
	\end{aligned}\]</span> in <u>cartesian</u> coordinates - note that it will look different in other coordinates if the basis vectors are not constant (as in the case of polar coordinates for example).</p>
<p><span class="math inline">\(\Delta f \equiv \nabla^2f\)</span> is called the <u>Laplacian</u> of <span class="math inline">\(f\)</span>. Since the Laplacian is the divergence of a vector field, it is a scalar field.</p>
<p>Note that you actually met the Laplacian in Calculus I, when you considered <em>Linear Partial Differential Equations</em>. In particular, the Laplacian is a differential operator that appears in <em>Laplace’s Equation</em>, the <em>Heat Equation</em> and the <em>Wave Equation</em>. More on this next term.</p>
<div id="eg:laplacian" class="example">
<p> For <span class="math inline">\(n=2\)</span>, let <span class="math inline">\(f=log(x^2+y^2) = log(\underline{x}.\underline{x})\)</span>. Then <span class="math display">\[\begin{aligned}
			\Rightarrow\quad \frac{\partial f}{\partial x} &amp;= \frac{2x}{x^2+y^2}, \quad \frac{\partial^2 f}{\partial x^2} \;=\; \frac{2}{x^2+y^2}-\frac{4x^2}{(x^2+y^2)^2} \;=\; \frac{2(y^2-x^2)}{(x^2+y^2)^2} \\
			\Rightarrow\quad \frac{\partial f}{\partial y} &amp;= \frac{2y}{x^2+y^2}, \quad \frac{\partial^2 f}{\partial y^2}  \;=\; \frac{2(x^2-y^2)}{(x^2+y^2)^2}  \quad \quad\text{(just swap $x$ and $y$)}\\
			\Rightarrow\quad \nabla^2f &amp;= \frac{\partial^2 f}{\partial x^2} + \frac{\partial^2 f}{\partial y^2} \;=\; \frac{2(y^2-x^2)}{(x^2+y^2)^2} + \frac{2(x^2-y^2)}{(x^2+y^2)^2} \\
				&amp;= 0 \quad \quad\text{if $\underline{x}\ne \underline{0}$}
		\end{aligned}\]</span></p>
</div>
<div id="eg:laplaciancomplexanalytic" class="example">
<p> Again, with <span class="math inline">\(n=2\)</span> let <span class="math inline">\(f=x^3-3xy^2\)</span>. Then <span class="math display">\[\begin{aligned}
			\frac{\partial^2 f}{\partial x^2} &amp;= \frac{\partial}{\partial x}(3x^2-3y^2) \;=\; 6x \\
			\frac{\partial^2 f}{\partial y^2} &amp;= \frac{\partial}{\partial y}(-6xy) \;=\; -6x \\
			\Rightarrow\quad \nabla^2f &amp;= 0
		\end{aligned}\]</span> <u>Notice</u>: If we let <span class="math inline">\(z=x+iy\)</span>, then <span class="math inline">\(f= {\rm Re}[(x+iy)^3] = \text{Re}[z^3]\)</span>. If you study Complex Analysis II, you will see that this is a differentiable complex function. As such, the real and imaginary parts of the function satisfy the Cauchy-Riemann equations. One can show (exercise) that in this case the Laplacian of both the real and imaginary parts of the function have Laplacian equal to 0.</p>
</div>
<p>For <span class="math inline">\(n=3\)</span> (i.e. in <span class="math inline">\(\mathbb{R}^3\)</span>) there are a couple of other natural combinations. Firstly, since the gradient of a scalar field is a vector field, we can take its curl: <span class="math display">\[\begin{aligned}
		\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{\nabla\mkern-2mu}\mkern 3mu f &amp;= \left| 
					\begin{array}{ccc}
					\underline{e}_1 &amp; \underline{e}_2 &amp; \underline{e}_3 \\
					\frac{\partial}{\partial x} &amp; \frac{\partial}{\partial y} &amp; \frac{\partial}{\partial z} \\
					\frac{\partial f}{\partial x} &amp; \frac{\partial f}{\partial y} &amp; \frac{\partial f}{\partial z} \\
					\end{array}
					\right| \\
				&amp;= 	\underline{e}_1 (\frac{\partial}{\partial y}\frac{\partial f}{\partial z} - \frac{\partial}{\partial z}\frac{\partial f}{\partial y}) + \underline{e}_2 (\frac{\partial}{\partial z}\frac{\partial f}{\partial x} - \frac{\partial}{\partial x}\frac{\partial f}{\partial z}) + \underline{e}_3 (\frac{\partial}{\partial x}\frac{\partial f}{\partial y} - \frac{\partial}{\partial y}\frac{\partial f}{\partial x}) \nonumber\\
				&amp;= \underline{0},
	\end{aligned}\]</span> assuming the 2nd partial derivatives of <span class="math inline">\(f\)</span> are continuous (so we can equate <span class="math inline">\(\frac{\partial^2 f}{\partial y \partial z} = \frac{\partial^2 f}{\partial z \partial y}\)</span> etc.). Also in <span class="math inline">\(\mathbb{R}^3\)</span>, we can find the divergence of a curl. We did this once follow example <a href="#eg:curl" data-reference-type="ref" data-reference="eg:curl">[eg:curl]</a>, but in general <span class="math display">\[\begin{aligned}
		\underline{\nabla\mkern-2mu}\mkern 3mu .(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{v}) &amp;= \underline{\nabla\mkern-2mu}\mkern 3mu . \left| 
					\begin{array}{ccc}
					\underline{e}_1 &amp; \underline{e}_2 &amp; \underline{e}_3 \\
					\frac{\partial}{\partial x} &amp; \frac{\partial}{\partial y} &amp; \frac{\partial}{\partial z} \\
					v_1 &amp; v_2 &amp; v_3 \\
					\end{array}
					\right|  \\
				&amp;=  \frac{\partial}{\partial x} (\frac{\partial v_3}{\partial y} - \frac{\partial v_2}{\partial z}) + \frac{\partial}{\partial y} (\frac{\partial v_1}{\partial z}-\frac{\partial v_3}{\partial x}) + \frac{\partial}{\partial z} (\frac{\partial v_2}{\partial x} - \frac{\partial v_1}{\partial y}) \\
				&amp;= \underline{0},
	\end{aligned}\]</span> again, assuming the 2nd partial derivatives of <span class="math inline">\(f\)</span> are continuous. Later we will redo these cases in a more elegant way using index notation.</p>
</section>
</section>
<section id="sec:indexnotation" class="level1" data-number="5">
<h1 data-number="4"><span class="header-section-number">4</span> Index notation</h1>
<section id="einstein-summation-convention" class="level2" data-number="5.1">
<h2 data-number="4.1"><span class="header-section-number">4.1</span> Einstein Summation Convention</h2>
<p>Recall that in <span class="math inline">\(n\)</span> dimensions, the indices <span class="math inline">\(i,j\)</span> etc. labelling the components of vectors run from <span class="math inline">\(1\)</span> to <span class="math inline">\(n\)</span>, e.g. we write <span class="math inline">\(\underline{v}= (v_1,v_2,\dots,v_n)\)</span>.</p>
<p>Einstein spotted that in quantities like <span class="math display">\[\begin{aligned}
		\underline{u}.\underline{v}&amp;= \sum_{i=1}^n u_i v_i \\
		\underline{\nabla\mkern-2mu}\mkern 3mu .\underline{u}&amp;= \sum_{i=1}^n \frac{\partial u_i}{\partial x_i}\\
		\left((\underline{a}.\underline{x})\underline{x}\right)_i &amp;= \sum_{j=1}^n a_j x_j x_i,
	\end{aligned}\]</span> the index to be summed appears exactly twice in a term or product of terms, while all other indices appear only once (the reason for this is to do with invariance under rotations, or for those of you studying Special Relativity this year, Lorentz transformations). He suggested dropping the summation sign, with the <u>convention</u> that wherever an index is repeated you sum over it.</p>
<p>So, we write <span class="math display">\[\begin{aligned}
		\underline{u}.\underline{v}&amp;= \sum_i u_i v_i  \;=\; u_i v_i\\
		\underline{\nabla\mkern-2mu}\mkern 3mu .\underline{u}&amp;= \sum_i \frac{\partial u_i}{\partial x_i} \;=\; \frac{\partial u_i}{\partial x_i}\\
		\left((\underline{a}.\underline{x})\underline{x}\right)_i &amp;= a_j x_j x_i.
	\end{aligned}\]</span></p>
<p>We call the repeated indices <u>dummy indices</u>, and those that are not repeated are called <u>free</u> indices. The dummy indices can be renamed without changing the expression, i.e. <span class="math display">\[a_j x_j x_i = a_k x_k x_i,\]</span> since clearly <span class="math display">\[\sum_{j=1}^n a_j x_j x_i = \sum_{k=1}^n a_k x_k x_i = (\underline{a}.\underline{x}) x_i.\]</span> However, the free indices must match on both sides of an equation.</p>
<p>We must also be careful never to repeat an index more than twice in any single term or product of terms in an expression. If we were to write <span class="math inline">\(a_ix_ix_i\)</span>, we can’t tell whether this is supposed to be the component form of <span class="math inline">\((\underline{a}.\underline{x})x_i\)</span>, or of <span class="math inline">\((\underline{x}. \underline{x})a_i\)</span>. So if we want to write <span class="math inline">\((\underline{u}.\underline{v})^2\)</span> in index notation, we should write <span class="math inline">\(u_iv_i u_jv_j\)</span> and <u>not</u> <span class="math inline">\(u_i v_i u_i v_i\)</span>.</p>
<p>Although writing an expression like this in index notation can sometimes looks messy, we’ll see shortly that it can be incredibly efficient for calculations.</p>
</section>
<section id="subsub:dij" class="level2" data-number="5.2">
<h2 data-number="4.2"><span class="header-section-number">4.2</span> The Kronecker delta, <span class="math inline">\(\delta_{ij}\)</span></h2>
<p>A very useful object for manipulating expressions in terms of their components, is the <u>Kronecker delta</u>. This is an object with two indices, defined by <span class="math display">\[\delta_{ij}  \;\equiv\; \left\{  \begin{array}{lc}
						1 \quad &amp; i=j \\
						0 \quad &amp; i\ne j 
						\end{array}
				\right..\]</span></p>
<p>We can think of the Kronecker delta as the components of the <span class="math inline">\(n\times n\)</span> identity matrix <span class="math inline">\(I\)</span>, and in fact this was how you first met <span class="math inline">\(\delta_{ij}\)</span>. E.g. for <span class="math inline">\(n=3\)</span> <span class="math display">\[I \;=\;  \left(  \begin{array}{ccc}
			1&amp;0&amp;0 \\
			0&amp;1&amp;0 \\
			0&amp;0&amp;1 
			\end{array}
			\right) \quad \quad\Rightarrow \quad I_{ij} = \delta_{ij},\]</span> where <span class="math inline">\(I_{ij}\)</span> represents the element of <span class="math inline">\(I\)</span> on the <span class="math inline">\(i\)</span>th row and <span class="math inline">\(j\)</span>th column.</p>
<p>The Kronecker delta appears naturally when we take partial derivatives, as we have <span class="math display">\[\frac{\partial x_i}{\partial x_j} \;=\; \delta_{ij}\]</span></p>
<div id="eg:dij" class="example">
<p> If <span class="math inline">\(\delta_{ij}\)</span> is the 3-dim Kronecker delta, and <span class="math inline">\(\underline{A} = (A_1, A_2, A_3)\)</span>, simplify</p>
<ol>
<li><p><span class="math inline">\(A_s \delta_{ts}\)</span></p></li>
<li><p><span class="math inline">\(\delta_{rs}\delta_{st}\)</span></p></li>
<li><p><span class="math inline">\(\delta_{rs} \delta_{sr}\)</span></p></li>
</ol>
<p><u>Answers:</u></p>
<ol>
<li><p><span class="math display">\[\begin{aligned}
				A_s \delta_{ts}  &amp;= A_1 \delta_{t1} + A_2 \delta_{t2} + A_3 \delta_{t3} \quad (0 \text{ if } t\ne 3 \text{ etc.}) \\
				&amp;= A_t
			\end{aligned}\]</span></p></li>
<li><p><span class="math display">\[\begin{aligned}
				\delta_{rs}\delta_{st} &amp;= \delta_{r1}\delta_{1t} + \delta_{r2}\delta_{2t} + \delta_{r3}\delta_{3t} \quad (0 \text{ unless } r=3, t=3 \text{ etc.}) \\
				&amp;= \delta_{rt}
			\end{aligned}\]</span></p>
<p>From these two examples, we can now see the formal rule:</p>
<p>If a <span class="math inline">\(\delta\)</span> has a dummy index, then delete the <span class="math inline">\(\delta\)</span> and replace the dummy index in the rest of the expression by the other index on the deleted <span class="math inline">\(\delta\)</span>. E.g. <span class="math inline">\(A_s \delta_{ts} = A_t\)</span>.</p></li>
<li><p><span class="math display">\[\begin{aligned}
				\delta_{rs} \delta_{sr} &amp;= \delta_{rr} \quad \quad(\text{by } (2.)) \\
				&amp;= \delta_{11} + \delta_{22} + \delta_{33} \;=\; 3
			\end{aligned}\]</span></p></li>
</ol>
</div>
</section>
<section id="subsub:eijk" class="level2" data-number="5.3">
<h2 data-number="4.3"><span class="header-section-number">4.3</span> The Levi-Cevita symbol, <span class="math inline">\(\epsilon_{ijk}\)</span></h2>
<p>If we are working in 3 dimension, there is a another device which is useful for handling expressions involving the vector cross product, such as <span class="math inline">\(\underline{A}\times (\underline{B}\times \underline{C})\)</span> or <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \times(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{v})\)</span>.</p>
<p>Consider <span class="math inline">\(\underline{C} = \underline{A} \times \underline{B}\)</span>. If <span class="math inline">\(\underline{A} = A_1 \underline{e}_1 + A_2 \underline{e}_2 +A_3 \underline{e}_3\)</span>, and <span class="math inline">\(\underline{B} = B_1 \underline{e}_1 + B_2 \underline{e}_2 + B_3 \underline{e}_3\)</span>, then <span class="math display">\[\begin{aligned}
		\underline{C} \;=\; \underline{A} \times \underline{B} &amp;= \left| 
					\begin{array}{ccc}
					\underline{e}_1 &amp; \underline{e}_2 &amp; \underline{e}_3 \\
					A_1 &amp; A_2 &amp; A_3 \\
					B_1 &amp; B_2 &amp; B_3 \\
					\end{array}
					\right|  \\
					&amp;= \underline{e}_1 (A_2 B_3 -A_3 B_2) + \underline{e}_2 (A_3B_1-A_1B_3) + \underline{e}_3 (A_1B_2 - A_2 B_1).
	\end{aligned}\]</span> The components of <span class="math inline">\(C\)</span> are then given by <span class="math display">\[\begin{aligned}
		C_1 &amp;= A_2B_3 - A_3 B_2 \\
		C_2 &amp;= A_3B_1 - A_1 B_3 \\
		C_3 &amp;= A_1B_2 - A_2 B_1.
	\end{aligned}\]</span></p>
<p>We can write these equations as a single equation, by introducing <span class="math inline">\(\epsilon_{ijk}\)</span>, a set of numbers labelled by three indices <span class="math inline">\(i\)</span>, <span class="math inline">\(j\)</span> and <span class="math inline">\(k\)</span>, each of which is equal to 1, 2 or 3.</p>
<p>This symbol is know as the <u>Levi-Civita</u> symbol, <span class="math inline">\(\epsilon_{ijk}\)</span> and is <u>defined</u> by: <span class="math display">\[\begin{aligned}
		I \quad \quad&amp; \epsilon_{ijk} = \; -\epsilon_{jik} \;=\; - \epsilon_{ikj}  \quad \quad\text{(antisymmetric)}   \\
		II \quad \quad&amp; \epsilon_{123} = \; 1
	\end{aligned}\]</span></p>
<p>These definitions imply the following properties:</p>
<ol>
<li><p><span class="math inline">\(\epsilon_{ijk} \;=\; - \epsilon_{kji}\)</span> (i.e. also antisymmetric when swapping 1st and 3rd index).</p>
<p>Proof: <span class="math display">\[\epsilon_{ijk} = - \epsilon_{jik} = + \epsilon_{jki}=-\epsilon_{kji}\]</span></p></li>
<li><p><span class="math inline">\(\epsilon_{ijk} = 0\)</span> if any two indices have the same value.</p>
<p>Proof: e.g. <span class="math display">\[\epsilon_{112}=-\epsilon_{112} \; \Rightarrow \; 2 \epsilon_{112} =0 \; \Rightarrow\; \epsilon_{112}=0\]</span></p></li>
<li><p>The only non-zero <span class="math inline">\(\epsilon_{ijk}\)</span> therefore have <span class="math inline">\(ijk\)</span> all different (by property 2.), so <span class="math inline">\((ijk)\)</span> is some permutation of <span class="math inline">\((123)\)</span>.</p></li>
<li><p><span class="math inline">\(\epsilon_{ijk} = +1\)</span> if <span class="math inline">\(ijk\)</span> is an <u>even</u> permutation of 123 (“even" = even # swaps)</p>
<p><span class="math inline">\(\epsilon_{ijk} = -1\)</span> if <span class="math inline">\(ijk\)</span> is an <u>odd</u> permutation of 123 (“odd" = odd # swaps)</p></li>
<li><p><span class="math inline">\(\epsilon_{ijk} = \epsilon_{kij} = \epsilon_{jki}\)</span> (cyclic permutations).</p>
<p>So e.g. <span class="math inline">\(1= \epsilon_{123}=\epsilon_{312} = \epsilon_{231}\)</span>, and <span class="math inline">\(-1= \epsilon_{132}=\epsilon_{321} = \epsilon_{213}\)</span></p></li>
</ol>
<p>Most importantly, now the vector product <span class="math inline">\(\underline{C} = \underline{A} \times \underline{B}\)</span> can be written as: <span class="math display">\[C_i \;=\; \epsilon_{ijk}A_j B_k.\]</span></p>
<p><u>Check</u>: <span class="math display">\[\begin{aligned}
		C_1 &amp;= \epsilon_{1jk}A_j B_k = \sum_{j,k=1}^3 \epsilon_{1jk}A_j B_k   \\
		&amp; \quad \text{(must have $j,k\ne1$ and $j\ne k$ by property 2.,} \\
		&amp; \quad \text{so either $j=2,k=3$ or $j=3,k=2$)} \\
		&amp;= \epsilon_{123}A_2 B_3  +  \epsilon_{132}A_3 B_2 \\
		&amp; \quad \text{ but $\epsilon_{123} = 1$ by $(II)$ above, and $\epsilon_{132}= -1$ by both $(I)$ and $(II)$}  \\
		&amp;= A_2B_3 - A_3B_2
	\end{aligned}\]</span></p>
<p>I leave it as an exercise for you to check other two components <span class="math inline">\(C_2\)</span> and <span class="math inline">\(C_3\)</span>.</p>
</section>
<section id="the-very-useful-epsilon_ijk-formula" class="level2" data-number="5.4">
<h2 data-number="4.4"><span class="header-section-number">4.4</span> The very useful <span class="math inline">\(\epsilon_{ijk}\)</span> formula</h2>
<p>If we want to write out the vector triple product <span class="math inline">\(\underline{A} \times (\underline{B} \times \underline{C})\)</span>, for example, we’ll need to be able to put these <span class="math inline">\(\epsilon\)</span>s together. Luckily there is a neat way to do it:</p>
<p><span class="math display">\[\begin{equation} \label{eq:veryusefulformula}
	\sum_{k=1}^3 \epsilon_{ijk} \epsilon_{klm} \;=\; \delta_{il} \delta_{jm} - \delta_{im} \delta_{jl}.  \quad \quad(\dagger) \end{equation}\]</span> <u>Best just to remember this formula!</u></p>
<p><u>Check:</u> Let’s first consider the left-hand side (<span class="math inline">\(LHS\)</span>) or Equation <span class="math inline">\(\eqref{eq:veryusefulformula}\)</span>. <span class="math display">\[LHS \text{ of Equation \eqref{eq:veryusefulformula}} \;=\; \epsilon_{ij1}\epsilon_{1lm}  + \epsilon_{ij2}\epsilon_{2lm} + \epsilon_{ij3}\epsilon_{3lm}  \quad \quad(*)\]</span></p>
<p>Now <span class="math inline">\(\epsilon_{ij1}\epsilon_{1lm} = 0\)</span> unless <span class="math display">\[\begin{aligned}
		(i,j) &amp;= (2,3)\text{ or }(3,2) \\
		\text{and} \quad (l,m) &amp;= (2,3)\text{ or }(3,2)  \\
		\Rightarrow \quad \epsilon_{ij1}\epsilon_{1lm} &amp;= \left\{ \begin{array}{c} 
				+1  \quad \text{ if } \quad (l,m) = (i,j)  \\
				-1  \quad \text{ if } \quad (l,m) = (j,i)  \\
				\end{array} \right.,
	\end{aligned}\]</span> in which case the second and third terms in (*) will be zero.</p>
<p>A similar argument holds for other terms in (*), <span class="math inline">\(\epsilon_{ij2}\epsilon_{2lm}\)</span> and <span class="math inline">\(\epsilon_{ij3}\epsilon_{3lm}\)</span>. Therefore the sum in (*) will be zero, except when <span class="math display">\[\begin{aligned}
		i \ne j, l\ne m, \quad (i,j) = (l,m)  \quad &amp;\Rightarrow&amp; \quad	 (*) \;=\; +1\\
		i \ne j, l\ne m, \quad (i,j) = (m,l)  \quad &amp;\Rightarrow&amp; \quad      (*) \;=\; -1.
	\end{aligned}\]</span></p>
<p>Let’s now consider the right-hand side (<span class="math inline">\(RHS\)</span>) of Equation <span class="math inline">\(\eqref{eq:veryusefulformula}\)</span>. <span class="math display">\[RHS \text{ of Equation \eqref{eq:veryusefulformula}}  \;=\; \delta_{il} \delta_{jm} - \delta_{im} \delta_{jl}\]</span></p>
<p>We have <span class="math inline">\(\delta_{il} \delta_{jm} =1\)</span> if <span class="math inline">\(i=l\)</span> and <span class="math inline">\(j=m \Leftrightarrow (i,j) = (l,m)\)</span>, otherwise this term is zero.</p>
<p>Similarly, <span class="math inline">\(-\delta_{im} \delta_{jl} = -1\)</span> if <span class="math inline">\(i=m\)</span> and <span class="math inline">\(j=l \Leftrightarrow (i,j) = (m,l)\)</span>, otherwise this term is zero.</p>
<p>The combination of both terms is zero if either <span class="math inline">\(i=j\)</span> or <span class="math inline">\(l=m\)</span>.</p>
<p>This implies that <span class="math inline">\(LHS\)</span> of Equation <span class="math inline">\(\eqref{eq:veryusefulformula}\)</span> = <span class="math inline">\(RHS\)</span> of Equation <span class="math inline">\(\eqref{eq:veryusefulformula}\)</span>, and hence the formula holds.</p>
<div id="eg:vectortripleproduct" class="example">
<p> Show that <span class="math inline">\(\underline{A} \times (\underline{B} \times \underline{C} ) \;=\; \underline{B} (\underline{A}.\underline{C}) - \underline{C}(\underline{A}.\underline{B})\)</span></p>
<p>To do this using index notation, we should compute the <span class="math inline">\(i\)</span><sup>th</sup> component of <span class="math inline">\(\underline{A} \times (\underline{B} \times \underline{C} )\)</span>. We can write this as <span class="math inline">\(\left[\underline{A} \times (\underline{B} \times \underline{C} )\right]_i\)</span>. Going slowly, this gives <span class="math display">\[\begin{aligned}
			\left[\underline{A} \times (\underline{B} \times \underline{C} )\right]_i &amp;= \epsilon_{ijk}A_j \left( \underline{B} \times \underline{C} \right)_k \quad \quad\quad \quad j,k: \text{ dummy indices}, \; i: \text{ free index, 1,2,3}   \\
			 &amp;= \epsilon_{ijk} A_j \epsilon_{klm} B_l C_m \quad \quad\quad \quad l,m: \text{ more dummy indices} \\
			 &amp;= (\delta_{il}\delta_{jm} - \delta_{im}\delta_{jl})A_jB_lC_m	\quad \quad\quad \quad\text{by useful formula } (\dagger) \\
			 &amp;= \delta_{il}\delta_{jm} A_jB_lC_m - \delta_{im}\delta_{jl} A_jB_lC_m \\
			 &amp;= \delta_{il} A_jB_lC_j - \delta_{im} A_jB_jC_m \quad \quad\quad \quad\text{by the rule for } \delta \\
			 &amp;=  A_jB_iC_j -  A_jB_jC_i \quad \quad\quad \quad\text{by the rule for } \delta \\
			 &amp;=  B_i(A_jC_j) -  C_i(A_jB_j) \\
			 &amp;= B_i (\underline{A}.\underline{C}) - C_i(\underline{A}.\underline{B}) \\
			 &amp;= \left[ \underline{B} (\underline{A}.\underline{C}) - \underline{C}(\underline{A}.\underline{B})\right]_i,
		\end{aligned}\]</span> i.e. <span class="math inline">\(i\)</span><sup>th</sup> component of <span class="math inline">\(\underline{A} \times (\underline{B} \times \underline{C} ) = i\)</span><sup>th</sup> component of <span class="math inline">\(\underline{B} (\underline{A}.\underline{C}) - \underline{C}(\underline{A}.\underline{B})\)</span>. Since this is true for all <span class="math inline">\(i=1,2,3\)</span> the result follows.</p>
</div>
</section>
<section id="applications" class="level2" data-number="5.5">
<h2 data-number="4.5"><span class="header-section-number">4.5</span> Applications</h2>
<p>We’ve already seen in example <a href="#eg:vectortripleproduct" data-reference-type="ref" data-reference="eg:vectortripleproduct">[eg:vectortripleproduct]</a>, that index notation can be used to prove the vector triple product identity, <span class="math inline">\(\underline{A} \times (\underline{B} \times \underline{C} ) \;=\; \underline{B} (\underline{A}.\underline{C}) - \underline{C}(\underline{A}.\underline{B})\)</span>.</p>
<p>For many vector calculus calculations we need <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span>, <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu . \underline{v}\)</span> and <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \times{\underline{v}}\)</span> in index notation</p>
<ul>
<li><p>The <span class="math inline">\(i\)</span>th component of <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> is simply <span class="math display">\[(\underline{\nabla\mkern-2mu}\mkern 3mu f)_i \;=\; \frac{\partial f}{\partial x_i}.\]</span> A common notation used to simplify this further is to write <span class="math inline">\(\frac{\partial}{\partial x_i} \equiv  \partial_i\)</span>, so then we can write <span class="math display">\[(\underline{\nabla\mkern-2mu}\mkern 3mu f)_i \;=\; \partial_i f.\]</span></p></li>
<li><p><span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu .\underline{v}\)</span> can be thought of simply as <span class="math inline">\(\underline{A}.\underline{v}\)</span> where <span class="math inline">\(\underline{A}\)</span> has “components" <span class="math inline">\(\frac{\partial}{\partial x_i}\)</span>: <span class="math display">\[\underline{\nabla\mkern-2mu}\mkern 3mu . \underline{v}\;=\; \frac{\partial v_i}{\partial x_i},\]</span> and using the notation from above this can also be written as <span class="math display">\[\underline{\nabla\mkern-2mu}\mkern 3mu . \underline{v}\;=\;  \partial_i v_i.\]</span></p></li>
<li><p>Similarly, <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{v}\)</span> is like <span class="math inline">\(\underline{A} \times \underline{v}\)</span>. So if <span class="math inline">\(\underline{u}= \underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{v}\)</span>, then its <span class="math inline">\(i\)</span>th component is: <span class="math display">\[u_i \;=\; (\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{v})_i \;=\; \epsilon_{ijk} \frac{\partial}{\partial x_j} v_k \;=\; \epsilon_{ijk} \frac{\partial v_k}{\partial x_j},\]</span> and using the same notation as above this can also be written as <span class="math display">\[u_i \;=\; (\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{v})_i \;=\; \epsilon_{ijk} \partial_j v_k.\]</span></p></li>
</ul>
<p>Here are some more examples that show how useful index notation can be for proving identities in vector calculus.</p>
<div id="eg:gradientincomponent" class="example">
<p> Find the gradient of <span class="math inline">\(f(\underline{x}) = | \underline{x}|^2\)</span> in <span class="math inline">\(\mathbb{R}^n\)</span>. <span class="math display">\[\begin{aligned}
			f(\underline{x}) &amp;= | \underline{x}|^2    \;=\;  \underline{x}.\underline{x}\;=\; x_i x_i \;=\; x_j x_j \\
			\Rightarrow\quad \quad(\underline{\nabla\mkern-2mu}\mkern 3mu f)_i &amp;= \frac{\partial}{\partial x_i}(x_j x_j)  \quad \quad\text{important not to reuse the dummy index $j$}\\
			&amp;= \left(\frac{\partial x_j}{\partial x_i} \right)x_j +  x_j \left(\frac{\partial x_j}{\partial x_i} \right)\quad \quad\text{product rule}\\
			&amp;= 2 \delta_{ij} x_j \;=\; 2 x_i \;=\; (2\underline{x})_i \\
			\Rightarrow\quad \quad\underline{\nabla\mkern-2mu}\mkern 3mu f &amp;= 2 \underline{x}
		\end{aligned}\]</span></p>
</div>
<div id="eg:divergenceincomponent" class="example">
<p> Find the divergence of <span class="math inline">\(\underline{v}(\underline{x}) = \underline{x}\)</span> and <span class="math inline">\(\underline{u}(\underline{x}) = (\underline{a} .\underline{x}) \underline{x}\)</span> in <span class="math inline">\(\mathbb{R}^3\)</span>. <span class="math display">\[\begin{aligned}
			v_i &amp;= x_i  \\
			\Rightarrow\quad \quad\underline{\nabla\mkern-2mu}\mkern 3mu . \underline{v}&amp;= \frac{\partial x_i}{\partial x_i} \;=\; \delta_{ii} \;=\; 3 \\
			\text{While} \quad \quad u_i &amp;= (\underline{a}.\underline{x})x_i \;=\; a_jx_j x_i \\
			\Rightarrow\quad \quad\underline{\nabla\mkern-2mu}\mkern 3mu .\underline{u}&amp;= \frac{\partial}{\partial x_i} (a_jx_j x_i) \\
			&amp;= a_j \left(\frac{\partial x_j}{\partial x_i} x_i + x_j \frac{\partial x_i}{\partial x_i}  \right)\\
			&amp;= a_j (\delta_{ij} x_i + x_j \delta_{ii}) \\
			&amp;= a_j ( x_j + 3 x_j ) \;=\; 4 a_j x_j  \\
			&amp;= 4 \: \underline{a} . \underline{x}
		\end{aligned}\]</span></p>
</div>
<div id="eg:curlincomponent" class="example">
<p> Find the curl of <span class="math inline">\(\underline{v}(\underline{x}) = \underline{x}\)</span> and <span class="math inline">\(\underline{u}(\underline{x}) = (\underline{a} .\underline{x}) \underline{x}\)</span> in <span class="math inline">\(\mathbb{R}^3\)</span>. <span class="math display">\[\begin{aligned}
			v_i &amp;= x_i  \\
			\Rightarrow\quad \quad(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{v})_i &amp;= \epsilon_{ijk} \frac{\partial}{\partial x_j} x_k \\
			&amp;= \epsilon_{ijk} \delta_{jk} \\
			&amp;= \epsilon_{ijj} \\
			&amp;= \epsilon_{i11} + \epsilon_{i22} +\epsilon_{i33}  \\
			&amp;= 0  \\
			\text{While} \quad \quad u_k &amp;= a_jx_j x_k \;=\; a_lx_l x_k \\
			\Rightarrow\quad \quad(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{u})_i &amp;= \epsilon_{ijk}   \frac{\partial}{\partial x_j}  u_k \\
			&amp;=  \epsilon_{ijk} \frac{\partial}{\partial x_j} (a_lx_l x_k)  \\
			&amp;=  a_l \epsilon_{ijk} \left(\frac{\partial x_l}{\partial x_j} x_k + x_l \frac{\partial x_k}{\partial x_j} \right)\\
			&amp;= a_l \epsilon_{ijk} \left(\delta_{lj} x_k + x_l \delta_{kj} \right)\\
			&amp;=  a_l \epsilon_{ijk} \delta_{lj} x_k +  a_l \epsilon_{ijk} x_l \delta_{kj}  \\
			&amp;=  a_j \epsilon_{ijk} x_k + a_l \epsilon_{ijj} x_l  \\
			&amp;= \epsilon_{ijk} a_j  x_k + 0  \\
			&amp;= (\underline{a} \times \underline{x})_i \\
			\Rightarrow\quad \quad\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{u}&amp;= \underline{a} \times \underline{x}
		\end{aligned}\]</span></p>
</div>
<div id="eg:divcurliszerocomponent" class="example">
<p> Show that <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu . (\underline{\nabla\mkern-2mu}\mkern 3mu \times{\underline{v}}) = 0\)</span>, (if <span class="math inline">\(v_k\)</span> has continuous 2nd partial derivatives). <span class="math display">\[\begin{aligned}
			\underline{\nabla\mkern-2mu}\mkern 3mu .(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{v}) &amp;= \frac{\partial}{\partial x_i} (\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{v})_i \\
			&amp;= \frac{\partial}{\partial x_i} (\epsilon_{ijk} \frac{\partial}{\partial x_j} v_k) \\
			&amp;=  \epsilon_{ijk} \frac{\partial}{\partial x_i} \frac{\partial}{\partial x_j} v_k
		\end{aligned}\]</span> Now <span class="math inline">\(\epsilon_{ijk}\)</span> is <u>anti</u>-symmetric when <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> swap, whereas <span class="math inline">\(\frac{\partial}{\partial x_i} \frac{\partial}{\partial x_j} v_k\)</span> is symmetric, so answer is zero(!).</p>
<p>In more detail: <span class="math display">\[\begin{aligned}
			\underline{\nabla\mkern-2mu}\mkern 3mu .(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{v}) &amp;= \epsilon_{ijk} \frac{\partial}{\partial x_i} \frac{\partial}{\partial x_j} v_k \\
			 &amp;= \epsilon_{jik} \frac{\partial}{\partial x_j} \frac{\partial}{\partial x_i} v_k \quad \quad\text{swapping labelling of dummy indices $i$ and $j$}  \\
			 &amp;= -\epsilon_{ijk} \frac{\partial}{\partial x_j} \frac{\partial}{\partial x_i} v_k \quad \quad\text{anti-symmetric $\epsilon_{ijk}$} \\
			 &amp;= -\epsilon_{ijk} \frac{\partial}{\partial x_i} \frac{\partial}{\partial x_j} v_k \quad \quad\text{symmetric derivatives, due to continuity} \\
			 &amp;= - \underline{\nabla\mkern-2mu}\mkern 3mu .(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{v})  \\
			 \Rightarrow\quad \quad\underline{\nabla\mkern-2mu}\mkern 3mu .(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{v}) &amp;= 0
		\end{aligned}\]</span> Much more elegant (and quicker!) then writing it all out.</p>
</div>
</section>
</section>
<section id="sec:differentiabilityofscalarfields" class="level1" data-number="6">
<h1 data-number="5"><span class="header-section-number">5</span> Differentiability of scalar fields</h1>
<p>We first met <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu {}\)</span> in Section <a href="#sec:gradientofascalarfield" data-reference-type="ref" data-reference="sec:gradientofascalarfield">3</a>, when trying to work out how a scalar field <span class="math inline">\(f(\underline{x})\)</span> varied as we moved along a parametric curve <span class="math inline">\(\underline{x}(t)\)</span>, <span class="math display">\[\frac{d f(\underline{x}(t))}{d t} = \frac{d \underline{x}(t)}{d t}. \underline{\nabla\mkern-2mu}\mkern 3mu {}f.\]</span> This follows from the chain rule, which as we noted at the end of Subsection <a href="#sub:partial_derivatives_and_the_chain_rule" data-reference-type="ref" data-reference="sub:partial_derivatives_and_the_chain_rule">2.3</a>, holds for differentiable functions <span class="math inline">\(f\)</span>. So, when are our scalar fields differentiable?</p>
<p>In the Epiphany term of Calculus I, you saw that a function of two variables <span class="math inline">\(f(x,y)\)</span> was differentiable at a point <span class="math inline">\(\underline{x}_0=(x_0,y_0)\in D\)</span>, if <span class="math inline">\(\exists\; \delta &gt; 0\)</span> such that <span class="math inline">\(|\underline{x}- \underline{x}_0| &lt; \delta \implies \underline{x}\in D\)</span> and <span class="math display">\[\begin{equation} \label{eq:differentiablefuncoftwovars}
	f(x,y) = f(x_0,y_0) + M (x-x_0) + N (y - y_0) + R(x,y), \end{equation}\]</span> such that <span class="math display">\[\lim_{\underline{x}\to \underline{x}_0 }\frac{R(x,y)}{|\underline{x}- \underline{x}_0|} = 0.\]</span> You also saw that the constants <span class="math inline">\(M\)</span> and <span class="math inline">\(N\)</span> were given by the partial derivatives <span class="math inline">\(\frac{\partial f}{\partial x}(x_0,y_0)\)</span> and <span class="math inline">\(\frac{\partial f}{\partial y}(x_0,y_0)\)</span> respectively, and hence Equation <span class="math inline">\(\eqref{eq:differentiablefuncoftwovars}\)</span> can be written as <span class="math display">\[\begin{equation} \label{eq:differentiablefuncoftwovarspartials}
	f(x,y) - f(x_0,y_0) =  (x-x_0) \frac{\partial f}{\partial x}(x_0,y_0) + (y - y_0) \frac{\partial f}{\partial y}(x_0,y_0) + R(x,y), \end{equation}\]</span> where as before <span class="math display">\[\lim_{\underline{x}\to \underline{x}_0 }\frac{R(x,y)}{|\underline{x}- \underline{x}_0|} = 0.\]</span></p>
<p>We can understand this as saying that a function of two variables <span class="math inline">\(f(x,y)\)</span> is differentiable at a point <span class="math inline">\(\underline{x}_0\)</span>, if the function is ‘flat’ in a small neighbourhood of <span class="math inline">\(\underline{x}_0\)</span>. That is, if <span class="math inline">\(f\)</span> looks like a plane near <span class="math inline">\(\underline{x}_0\)</span>. This is because Equation <span class="math inline">\(\eqref{eq:differentiablefuncoftwovars}\)</span> (or equivalently Equation <span class="math inline">\(\eqref{eq:differentiablefuncoftwovarspartials}\)</span>) is linear in both the change in the <span class="math inline">\(x\)</span>-directional and in the <span class="math inline">\(y\)</span>-direction.</p>
<p>We now want to generalise this using vector notation to define when scalar fields <span class="math inline">\(f:\mathbb{R}^n \to \mathbb{R}\)</span> are differentiable.</p>
<div class="center">
<figure>
<img src="differentiablesurface.png" id="fig:differentiablesurface" style="width:50.0%" alt="" /><figcaption>In a small neighbourhood of the origin, the function <span class="math inline">\(f(x,y)=x^2 + y^2\)</span> looks like the plane <span class="math inline">\(z=0\)</span>.</figcaption>
</figure>
</div>
<section id="sub:continuity" class="level2" data-number="6.1">
<h2 data-number="5.1"><span class="header-section-number">5.1</span> Continuity</h2>
<p>Note that the definition of differentiability for a function of two variables requires us to define the limit <span class="math inline">\(\lim_{\underline{x}\to \underline{x}_0}\)</span>.</p>
<div id="def:limitinrn" class="definition">
<p> We say that a scalar field <span class="math inline">\(f(\underline{x}):\mathbb{R}^n \to \mathbb{R}\)</span> <em>tends to</em> <span class="math inline">\(L\)</span> as <span class="math inline">\(\underline{x}\)</span> <em>tends to</em> <span class="math inline">\(\underline{a}\)</span>, if the difference between <span class="math inline">\(f\)</span> and <span class="math inline">\(L\)</span> can be made as small as we please by taking <span class="math inline">\(\underline{x}\)</span> sufficiently close to <span class="math inline">\(\underline{a}\)</span> (without being equal to <span class="math inline">\(\underline{a}\)</span>).</p>
<p>We can phrase this more precisely, as <span class="math display">\[\begin{aligned}
			\lim_{\underline{x}\to \underline{a}} f(\underline{x}) &amp;= L  \quad  \text{ if } \quad  \forall \epsilon &gt; 0,\quad  \exists  \delta &gt; 0  \quad s.t. \nonumber \\
			|f(\underline{x}) -L| &amp;&lt; \epsilon \quad  \forall \underline{x}\quad  s.t. \quad  0 &lt; | \underline{x}- \underline{a}| &lt; \delta.
		\end{aligned}\]</span></p>
</div>
<p>We can now define what it means for a scalar field <span class="math inline">\(f\)</span> to be continuous in terms of this definition of the limit.</p>
<div id="def:continuityofscalarfield" class="definition">
<p> <span class="math inline">\(f(\underline{x})\)</span> is <u>continuous</u> at <span class="math inline">\(\underline{a}\)</span> if <span class="math inline">\(\lim_{\underline{x}\to \underline{a}} f(\underline{x})\)</span> exists and is equal to <span class="math inline">\(f(\underline{a})\)</span>.</p>
</div>
<div id="eg:limitsandcontinuity1" class="example">
<p> If <span class="math inline">\(f(\underline{x}) = x^2 + y^2\)</span> show that <span class="math inline">\(f(\underline{x})\)</span> is continuous at the origin.</p>
<p>Given <span class="math inline">\(\epsilon\)</span> pick <span class="math inline">\(\delta = \sqrt{\epsilon}\)</span>. Then <span class="math display">\[\begin{aligned}
			| \underline{x}| &amp;&lt; \delta  \\
			\Rightarrow\quad \quad\sqrt{x^2+y^2} &amp;&lt; \sqrt{\epsilon} \\
			\Rightarrow x^2+y^2 &amp;&lt; \epsilon.
		\end{aligned}\]</span></p>
<p>So for all <span class="math inline">\(\underline{x}\)</span> with <span class="math inline">\(0&lt;|\underline{x}| &lt; \delta\)</span> we have <span class="math display">\[\begin{aligned}
			|f(x)| &amp;= |f(x) -0| \;&lt;\; \epsilon  \\
			\Rightarrow\quad \quad\lim_{\underline{x}\to \underline{0}} f(\underline{x}) &amp;= 0.
		\end{aligned}\]</span></p>
<p>Since <span class="math inline">\(f(\underline{0})=0 = \lim_{\underline{x}\to \underline{0}}\)</span>, <span class="math inline">\(f(\underline{x})\)</span> is continuous at the origin.</p>
</div>
<div id="eg:limitsandcontinuity2" class="example">
<p> Show that <span class="math inline">\(f(\underline{x}) = \frac{xy}{x^2+y^2}\)</span> has no limit as <span class="math inline">\(\underline{x}\to \underline{0}\)</span> even though <span class="math inline">\(\lim_{x\to 0 } f(x,0)\)</span> and <span class="math inline">\(\lim_{y\to 0} f(0,y)\)</span> both exist (this illustrates the difference between limits in <span class="math inline">\(\mathbb{R}\)</span> and <span class="math inline">\(\mathbb{R}^2\)</span>).</p>
<p>For <span class="math inline">\(x \ne 0, f(x,0)=0\)</span> and for <span class="math inline">\(y\ne 0, f(0,y)\)</span> <span class="math display">\[\Rightarrow\quad \quad\lim_{x\to 0 } f(x,0) =0 \quad\text{ and } \quad\lim_{y\to 0} f(0,y) = 0,\]</span> so we would need <span class="math inline">\(\lim_{\underline{x}\to \underline{0}} f(\underline{x}) = 0\)</span>. To prove this we would need to show that for any <span class="math inline">\(\epsilon\)</span> (in particular small values), there’s a <span class="math inline">\(\delta\)</span> such that <span class="math display">\[\left| \frac{xy}{x^2+y^2} \right| \;&lt;\; \epsilon \quad\forall \underline{x}\quad s.t. \quad 0 &lt; | \underline{x}| &lt; \delta.\]</span></p>
<p>But if <span class="math inline">\(y=x\)</span> then <span class="math display">\[\left| \frac{xy}{x^2+y^2} \right| \;=\; \left| \frac{x^2}{x^2+x^2} \right| \;=\; \frac{1}{2} \quad\text{ for all $x$, (even very small!)}\]</span> so the condition can’t be fulfilled. Therefore, <span class="math inline">\(f(\underline{x})\)</span> is not continuous at the origin.</p>
</div>
<p>However, the following results help to prove when functions <u>are</u> continuous:</p>
<div id="thm:continuousfunctions" class="theorem">
<ol>
<li><p>If <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are continuous functions at <span class="math inline">\(\underline{a}\)</span> then so are</p>
<ul>
<li><p><span class="math inline">\(f+g\)</span>,</p></li>
<li><p><span class="math inline">\(fg\)</span>,</p></li>
<li><p>and <span class="math inline">\(\frac{f}{g}\)</span>, provided that <span class="math inline">\(g(\underline{a}) \ne 0\)</span>.</p></li>
</ul></li>
<li><p>Both <span class="math display">\[\begin{aligned}
				f(\underline{x}) &amp;= \text{constant},  \\
				\text{and} \quad \quad f(\underline{x}) &amp;= f(x_1,x_2,\dots, x_n) \;=\; x_a, \quad a=1,\dots, n
			\end{aligned}\]</span> are continuous at all points in <span class="math inline">\(\mathbb{R}^n\)</span>.</p></li>
</ol>
<p>The proof of this theorem is left as an exercise.</p>
</div>
<div id="eg:continuitytheorem" class="example">
<p> <span class="math inline">\(f(x,y)=x\)</span> and <span class="math inline">\(g(x,y) = y\)</span> are both continuous at the origin by part 2 of Theorem <a href="#thm:continuousfunctions" data-reference-type="ref" data-reference="thm:continuousfunctions">[thm:continuousfunctions]</a>, and so by repeated use of part 1 of the theorem, so is <span class="math display">\[h(x,y) \;=\; \frac{x^3 - y^3}{1+x^2}.\]</span></p>
</div>
</section>
<section id="sub:opensets" class="level2" data-number="6.2">
<h2 data-number="5.2"><span class="header-section-number">5.2</span> Open sets</h2>
<p>The definition of the limit of <span class="math inline">\(f\)</span> as <span class="math inline">\(\underline{x}\to \underline{a}\)</span> (Definition <a href="#def:limitinrn" data-reference-type="ref" data-reference="def:limitinrn">[def:limitinrn]</a>) requires us to consider the set of all points <span class="math inline">\(\underline{x}\)</span> such that <span class="math inline">\(0 &lt; |\underline{x}- \underline{a} | &lt; \delta\)</span> for a <span class="math inline">\(\delta &gt; 0\)</span>. To define differentiability for our scalar fields, we therefore want to introduce the notion of an <em>open set</em>, where the assumption that such points exist in the domain of our function <span class="math inline">\(f\)</span> is satisfied.</p>
<p>We therefore make the following definitions, each of which may be well understood by the accompanying figure.</p>
<div id="def:openball" class="definition">
<p> An <u>open ball</u> with centre <span class="math inline">\(\underline{a}\in \mathbb{R}^n\)</span> and radius <span class="math inline">\(\delta &gt;0\)</span> is the set of points <span class="math display">\[B_\delta (\underline{a}) \;=\; \{\underline{x}\in \mathbb{R}^n: |\underline{x}- \underline{a}| &lt; \delta \}.\]</span> An example of an open ball of radious <span class="math inline">\(\delta\)</span> about the point <span class="math inline">\(\underline{a}\in \mathbb{R}^n\)</span> is shown in Figure <a href="#fig:openball" data-reference-type="ref" data-reference="fig:openball">16</a>.</p>
</div>
<div class="center">
<figure>
<img src="openball.jpeg" id="fig:openball" style="width:50.0%" alt="" /><figcaption>An open ball of radius <span class="math inline">\(\delta\)</span> about the point <span class="math inline">\(\underline{a} \in \mathbb{R}^n\)</span>.</figcaption>
</figure>
</div>
<div id="def:openset" class="definition">
<p> A subset <span class="math inline">\(S\)</span> of <span class="math inline">\(\mathbb{R}^n\)</span> is <u>open</u> (<span class="math inline">\(S\)</span> is an <u>open set</u>) if for each point <span class="math inline">\(\underline{a}\in S\)</span> there is an open ball <span class="math inline">\(B_\delta (\underline{a})\)</span> which is also in <span class="math inline">\(S\)</span> (where <span class="math inline">\(\delta\)</span> might depend on <span class="math inline">\(\underline{a}\)</span>).</p>
<p>An example of an open set <span class="math inline">\(S\)</span> is shown in Figure <a href="#fig:openset" data-reference-type="ref" data-reference="fig:openset">17</a>, where an open ball around a point <span class="math inline">\(\underline{a}\)</span> is shown.</p>
</div>
<div class="center">
<figure>
<img src="openset.jpeg" id="fig:openset" style="width:50.0%" alt="" /><figcaption>An open set <span class="math inline">\(S \subset \mathbb{R}^n\)</span>, with the open ball around a point <span class="math inline">\(\underline{a} \in S\)</span> shown.</figcaption>
</figure>
</div>
<div id="def:neighbourhood" class="definition">
<p> A <u>neighbourhood</u> <span class="math inline">\(N\)</span> of a point <span class="math inline">\(\underline{a}\in \mathbb{R}^n\)</span> is a subset of <span class="math inline">\(\mathbb{R}^n\)</span> which includes an open set containing <span class="math inline">\(\underline{a}\)</span>.</p>
<p>A neighbourhood <span class="math inline">\(N\)</span> of a point <span class="math inline">\(\underline{a} \in \mathbb{R}^n\)</span> is shown in Figure <a href="#fig:neighbourhood" data-reference-type="ref" data-reference="fig:neighbourhood">18</a>, where an open set <span class="math inline">\(S\)</span> around <span class="math inline">\(\underline{a}\)</span> is shown.</p>
</div>
<div class="center">
<figure>
<img src="neighbourhood.jpeg" id="fig:neighbourhood" style="width:50.0%" alt="" /><figcaption>A neighbourhood <span class="math inline">\(N\)</span> of a point <span class="math inline">\(\underline{a} \in \mathbb{R}^n\)</span>, with an open set <span class="math inline">\(S\)</span> around <span class="math inline">\(\underline{a}\)</span> shown.</figcaption>
</figure>
</div>
<div id="def:closedset" class="definition">
<p> A set <span class="math inline">\(S\subseteq \mathbb{R}^n\)</span> is <u>closed</u> if its complement in <span class="math inline">\(\mathbb{R}^n\)</span> (<span class="math inline">\(S^c \equiv \mathbb{R}^n\setminus S\)</span>, points not in <span class="math inline">\(S\)</span>) is open e.g. <span class="math display">\[\bar{B}_\delta (\underline{a}) \;=\; \{\underline{x}\in \mathbb{R}^n: |\underline{x}- \underline{a}| \le \delta \}\]</span> is the closed ball. The complement of the closed ball, <span class="math display">\[\bar{B}^c_\delta (\underline{a}) \;=\; \{\underline{x}\in \mathbb{R}^n: |\underline{x}- \underline{a}| &gt; \delta \}\]</span> is an open set, and so the closed ball is closed.</p>
</div>
<div id="eg:openandclosedsets" class="example">
<ul>
<li><p><span class="math inline">\(D= \{ (x,y) \in \mathbb{R}^2 : x&gt;0\}\)</span> is open, as given <span class="math inline">\(\underline{a}=(a_1,a_2) \in D\)</span>, pick <span class="math inline">\(\delta=a_1/2\)</span> then <span class="math inline">\(B_\delta (\underline{a})\)</span> is in <span class="math inline">\(D\)</span>. This is demonstrated in Figure <a href="#fig:opensetD" data-reference-type="ref" data-reference="fig:opensetD">20</a>.</p>
<table id="fig:opensetD" class="imageTable">
<caption>The set <span class="math inline">\(D= \{ (x,y) \in \mathbb{R}^2 : x&gt;0\}\)</span> is an open set, as we can find an open ball around every point in <span class="math inline">\(D\)</span>.</caption>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="setd.jpeg" title="fig:" id="fig:opensetD" style="width:40.0%" alt="The set D= \{ (x,y) \in \mathbb{R}^2 : x&gt;0\} is an open set, as we can find an open ball around every point in D." />  </td>
<td style="text-align: center;">  <img src="ballinD.jpeg" title="fig:" id="fig:opensetD" style="width:40.0%" alt="The set D= \{ (x,y) \in \mathbb{R}^2 : x&gt;0\} is an open set, as we can find an open ball around every point in D." /></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">The open set <span class="math inline">\(D\)</span></td>
<td style="text-align: center;">An open ball in <span class="math inline">\(D\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table></li>
<li><p><span class="math inline">\(E=\{(x,y) \in \mathbb{R}^2: x\ge 0 \}\)</span> is <u>not</u> open, as e.g. the point <span class="math inline">\((0,0)\)</span> is in <span class="math inline">\(E\)</span>, but for all <span class="math inline">\(\delta&gt;0\)</span> there are points in <span class="math inline">\(B_\delta (\underline{0})\)</span> not in <span class="math inline">\(E\)</span>. This is demonstrated in Figure <a href="#fig:closedsetE" data-reference-type="ref" data-reference="fig:closedsetE">22</a>. Set <span class="math inline">\(E\)</span> is a closed set, as the complement of <span class="math inline">\(E\)</span>, <span class="math inline">\(E^c = \{ (x,y) \in \mathbb{R}^2: x&lt;0 \}\)</span> is an open set.</p>
<table id="fig:closedsetE" class="imageTable">
<caption>The set <span class="math inline">\(E= \{ (x,y) \in \mathbb{R}^2 : x\ge 0\}\)</span> is not an open set, as we can find a point which isn’t contained in any open ball. This set is a closed set, as it is the complement of an open set.</caption>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="setE.jpeg" title="fig:" id="fig:closedsetE" style="width:40.0%" alt="The set E= \{ (x,y) \in \mathbb{R}^2 : x\ge 0\} is not an open set, as we can find a point which isn’t contained in any open ball. This set is a closed set, as it is the complement of an open set." />  </td>
<td style="text-align: center;">  <img src="ballinE.jpeg" title="fig:" id="fig:closedsetE" style="width:40.0%" alt="The set E= \{ (x,y) \in \mathbb{R}^2 : x\ge 0\} is not an open set, as we can find a point which isn’t contained in any open ball. This set is a closed set, as it is the complement of an open set." /></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">The set <span class="math inline">\(E\)</span></td>
<td style="text-align: center;">The origin in <span class="math inline">\(E\)</span> isn’t contained in any open ball</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table></li>
<li><p>Likewise <span class="math inline">\(F = \{(x,y)\in \mathbb{R}^2: 1&lt;x&lt;3,1&lt;y&lt;2\}\)</span> is open, but <span class="math inline">\(G = \{(x,y)\in \mathbb{R}^2: 1 \le x \le 3,1&lt;y&lt;2\}\)</span> is not (but <span class="math inline">\(G\)</span> is <u>not</u> closed either!). This is demonstrated in Figure <a href="#fig:setsFG" data-reference-type="ref" data-reference="fig:setsFG">24</a></p>
<table id="fig:setsFG" class="imageTable">
<caption>The set <span class="math inline">\(F= \{ (x,y) \in \mathbb{R}^2 : 1&lt;x&lt;3, 1&lt;y&lt;2\}\)</span> is an open set, but the set <span class="math inline">\(G= \{ (x,y) \in \mathbb{R}^2 : 1\le x \le 3, 1&lt;y&lt;2\}\)</span> is neither open (since points along the left and right edges aren’t contained in any open balls), nor closed (since the complement is the outside of the rectangle, along with the top and bottom edges of the rectangle, and hence contains points which aren’t contained in any open ball).</caption>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="setF.jpeg" title="fig:" id="fig:setsFG" style="width:40.0%" alt="The set F= \{ (x,y) \in \mathbb{R}^2 : 1&lt;x&lt;3, 1&lt;y&lt;2\} is an open set, but the set G= \{ (x,y) \in \mathbb{R}^2 : 1\le x \le 3, 1&lt;y&lt;2\} is neither open (since points along the left and right edges aren’t contained in any open balls), nor closed (since the complement is the outside of the rectangle, along with the top and bottom edges of the rectangle, and hence contains points which aren’t contained in any open ball)." />  </td>
<td style="text-align: center;">  <img src="setG.jpeg" title="fig:" id="fig:setsFG" style="width:40.0%" alt="The set F= \{ (x,y) \in \mathbb{R}^2 : 1&lt;x&lt;3, 1&lt;y&lt;2\} is an open set, but the set G= \{ (x,y) \in \mathbb{R}^2 : 1\le x \le 3, 1&lt;y&lt;2\} is neither open (since points along the left and right edges aren’t contained in any open balls), nor closed (since the complement is the outside of the rectangle, along with the top and bottom edges of the rectangle, and hence contains points which aren’t contained in any open ball)." /></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">The open set <span class="math inline">\(F\)</span></td>
<td style="text-align: center;">The set <span class="math inline">\(G\)</span> which is neither open nor closed</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table></li>
</ul>
</div>
<div id="eg:openballsopen" class="example">
<p> Every open ball <span class="math inline">\(B_\delta (\underline{a})\)</span> in <span class="math inline">\(\mathbb{R}^n\)</span> is open. The proof of this is left as exercise.</p>
</div>
<div id="def:continuousonset" class="definition">
<p> If <span class="math inline">\(U\)</span> is an open subset of <span class="math inline">\(\mathbb{R}^n\)</span> and <span class="math inline">\(f:U \to \mathbb{R}\)</span> is a function on <span class="math inline">\(U\)</span>, then <span class="math inline">\(f\)</span> is said to be continuous on <span class="math inline">\(U\)</span> if it is continuous at each point in <span class="math inline">\(U\)</span>.</p>
</div>
</section>
<section id="sub:differentiablemapsfromrntor" class="level2" data-number="6.3">
<h2 data-number="5.3"><span class="header-section-number">5.3</span> Differentiable maps <span class="math inline">\(\mathbb{R}^n\to \mathbb{R}\)</span></h2>
<p>We’re now ready to define what it means for a scalar field <span class="math inline">\(f(\underline{x}):\mathbb{R}^n \to \mathbb{R}\)</span> to be differentiable. Remember, a function of two variables <span class="math inline">\(f(x,y):D \to \mathbb{R}\)</span> for <span class="math inline">\(D\subseteq \mathbb{R}^2\)</span> was differentiable at a point <span class="math inline">\(\underline{x}_0=(x_0,y_0)\in D\)</span>, if <span class="math inline">\(\exists\; \delta &gt; 0\)</span> such that <span class="math inline">\(|\underline{x}- \underline{x}_0| &lt; \delta \implies \underline{x}\in D\)</span> and <span class="math display">\[f(x,y) - f(x_0,y_0) =  (x-x_0) \frac{\partial f}{\partial x}(x_0,y_0) + (y - y_0) \frac{\partial f}{\partial y}(x_0,y_0) + R(x,y), \quad \quad\quad \quad(\dagger)\]</span> such that <span class="math display">\[\lim_{\underline{x}\to \underline{x}_0 }\frac{R(x,y)}{|\underline{x}- \underline{x}_0|} = 0.\]</span></p>
<p>We can now generalise this to <span class="math inline">\(\mathbb{R}^n\)</span> using vector notation.</p>
<div id="def:differentiablescalarfield" class="definition">
<p> Suppose <span class="math inline">\(U\)</span> is an open set in <span class="math inline">\(\mathbb{R}^n\)</span>, and <span class="math inline">\(f:U\to \mathbb{R}\)</span> is a scalar field (function) on <span class="math inline">\(U\)</span>. <span class="math inline">\(f\)</span> is <u>differentiable</u> at <span class="math inline">\(\underline{a}\in U\)</span> if we can find a vector <span class="math inline">\(\underline{v}(\underline{a})\)</span> such that <span class="math display">\[\begin{aligned}
			f(\underline{a}+\underline{h}) - f(\underline{a}) &amp;= \underline{h}. \underline{v}(\underline{a}) + R(\underline{h}) \quad \quad\quad \quad(*) \\
			\text{with} \quad \quad\quad \quad\lim_{\underline{h}\to \underline{0}} \frac{R(\underline{h})}{|\underline{h}|} &amp;= 0 	\quad \quad\quad \quad(**)
		\end{aligned}\]</span></p>
</div>
<p>We can regard (*) in the definition as the definition of <span class="math inline">\(R(\underline{h})\)</span>, so part (**) is the meaningful part of the definition of differentiability for a scalar field. Note that the term <span class="math inline">\(\underline{h}. \underline{v}(\underline{a})\)</span> is linear in <span class="math inline">\(\underline{h}\)</span> (which represents the small difference between our points <span class="math inline">\(\underline{a}\)</span> and <span class="math inline">\(\underline{a}+ \underline{h}\)</span>). Equation (*) therefore takes the same form as Equation <span class="math inline">\((\dagger)\)</span> above, where the first two terms on the right-hand side are also linear in the differences <span class="math inline">\((x-x_0)\)</span> and <span class="math inline">\((y-y_0)\)</span>.</p>
<p>If <span class="math inline">\(\underline{v}\)</span> exists, it is equal to <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> since we could take <span class="math inline">\(\underline{h}= h \underline{e}_i\)</span>, so <span class="math inline">\(h=\pm |\underline{h}|\)</span> (i.e. <span class="math inline">\(|\underline{h}| = |h|\)</span>). Then by the definition of the gradient, <span class="math display">\[\begin{aligned}
		(\underline{\nabla\mkern-2mu}\mkern 3mu f)_i \;=\; \frac{\partial f}{\partial x_i} &amp;= \lim_{h\to 0} \frac{f(\underline{a}+ h \underline{e}_i) - f(\underline{a})}{h} \\
		&amp;= \lim_{h\to 0} \left[ \frac{ h \underline{e}_i . \underline{v}(\underline{a}) + R(\underline{h})} {h} \right] \quad \quad\text{by } (*) \\
		&amp;= \lim_{h\to 0}\left[  \underline{e}_i . \underline{v}(\underline{a}) + \frac{R(\underline{h})}{h} \right]  \\
		&amp;=  \underline{e}_i . \underline{v}(\underline{a}) \pm \lim_{h\to 0} \frac{R(\underline{h})}{|\underline{h}|}  \\
		&amp;=  \underline{e}_i . \underline{v}(\underline{a}) \pm0 \quad \quad\quad \quad\text{by } (**) \\
		&amp;= v_i(\underline{a}),
	\end{aligned}\]</span> i.e. the components of <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> are the components of <span class="math inline">\(\underline{v}\)</span>.</p>
<p><u>Warning</u>: the components of <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> might be well-defined at a point but this does <u>not</u> ensure that <span class="math inline">\(f\)</span> is differentiable there.</p>
<div id="eg:existenceofgradientdoesnotimplydifferentiability" class="example">
<p> <span class="math inline">\(f:\mathbb{R}^2 \Rightarrow\mathbb{R}\)</span> <span class="math display">\[f(x,y) \;=\; \left\{ \begin{array}{ll}
				\frac{xy}{x^2+y^2}  &amp; \underline{x}\ne \underline{0} \\
				0 	&amp;   \underline{x}=\underline{0} 	
				\end{array} \right.\]</span></p>
<p>At the origin <span class="math display">\[\frac{\partial f}{\partial x} \;=\; \lim_{h\to 0} \frac{f(h,0) - f(0,0)}{h} \;=\; \lim_{h \to 0} \frac{\frac{h.0}{h^2+0} -0}{h} \;=\; 0,\]</span> and similarly <span class="math inline">\(\frac{\partial f}{\partial y} =0\)</span> at origin, so <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{0})\)</span> has components <span class="math inline">\((0,0)\)</span>, and therefore if <span class="math inline">\(\underline{v}\)</span> exists it must be <span class="math inline">\((0,0)\)</span> as well.</p>
<p>Task 1: Define <span class="math inline">\(R\)</span>. With <span class="math inline">\(\underline{h}=(h_1, h_2)\)</span> <span class="math display">\[\begin{aligned}
			f(h_1,h_2)-f(0,0) &amp;= \underline{h}. \underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{0}) + R(\underline{h}) \\
					&amp;= 0 + R(\underline{h}) \\
			\Rightarrow\quad \quad R(\underline{h}) &amp;=&amp; \frac{h_1h_2}{h_1^2 + h_2^2}
		\end{aligned}\]</span></p>
<p>Task 2: Examine the behaviour of <span class="math inline">\(\lim_{\underline{h}\to \underline{0}} R(\underline{h})/|\underline{h}|\)</span>: <span class="math display">\[\begin{aligned}
			\frac{R(\underline{h})}{|\underline{h}|} &amp;= \left( \frac{h_1h_2}{h_1^2 + h_2^2} \right) / | \underline{h}| \\
			&amp;= \frac{h_1 h_2}{(h_1^2 + h_2^2)^{3/2}}
		\end{aligned}\]</span></p>
<p>On the line <span class="math inline">\(h_2=h_1\)</span>, <span class="math display">\[\begin{aligned}
			\frac{R(\underline{h})}{|\underline{h}|} &amp;=&amp; \frac{h_1^2}{(2h_1^2)^{3/2}} \\
			&amp;=&amp; \frac{1}{2^{3/2} |h_1| },
		\end{aligned}\]</span> which does not tend to zero as <span class="math inline">\(h_1 \to 0\)</span>, therefore <span class="math inline">\(\lim_{\underline{h}\to \underline{0}}R(\underline{h})/|\underline{h}|\)</span> does not exist, and so <span class="math inline">\(f\)</span> is <u>not</u> differentiable at the origin.</p>
<p>Note that for <span class="math inline">\(\underline{x}\ne \underline{0}\)</span>, <span class="math display">\[\begin{aligned}
			\frac{\partial f}{\partial x} \;=\; \frac{\partial}{\partial x} \left(\frac{xy}{x^2 + y^2}  \right)&amp;= \frac{y}{x^2+y^2} - \frac{2x^2 y}{(x^2 + y^2)^2} \\
			&amp;= \frac{y(y^2-x^2)}{(x^2+y^2)^2},
		\end{aligned}\]</span> so <span class="math inline">\(\frac{\partial f(0,y)}{\partial x} \;=\; \frac{1}{y}\)</span>, and <span class="math inline">\(\frac{\partial f}{\partial x}\)</span> is <u>not continuous</u> at <span class="math inline">\(\underline{0}\)</span>.</p>
</div>
</section>
<section id="sub:continuous_differentiability" class="level2" data-number="6.4">
<h2 data-number="5.4"><span class="header-section-number">5.4</span> Continuous Differentiability</h2>
<p>In fact there is a <u>theorem</u> that continuity of partial derivatives implies differentiability.</p>
<div id="thm:continuousdifferentiability" class="theorem">
<p> Let <span class="math inline">\(f:U \to \mathbb{R}\)</span> be a function on an open set <span class="math inline">\(U\subset \mathbb{R}^n\)</span>, and suppose <span class="math inline">\(\underline{a}\in U\)</span>. If all partial derivatives of <span class="math inline">\(f\)</span> exist and are continuous in a neighbourhood of <span class="math inline">\(\underline{a}\)</span>, then <span class="math inline">\(f\)</span> is differentiable at <span class="math inline">\(\underline{a}\)</span>.</p>
</div>
<p>(You can quote this theorem without proof.)</p>
<div id="def:continuouslydifferentiable" class="definition">
<p> A function is <u>continuously differentiable</u> at <span class="math inline">\(\underline{a}\)</span> if it and all of its partial derivatives exist and are continuous at <span class="math inline">\(\underline{a}\)</span>; it is <u>continuously differentiable on an open set <span class="math inline">\(U\)</span></u> if it and all of its partial derivatives exist and are continuous on <span class="math inline">\(U\)</span>.</p>
</div>
<p>By the theorem, if a function is continuously differentiable on an open set then it is also differentiable there. <u>This is important</u>: continuous differentiability is easier to check than differentiability.</p>
<p><u>Note</u>: function for which partial derivatives of all orders exist are called <u>smooth functions</u>.</p>
<div id="thm:continuousdifferentiablenewfromold" class="theorem">
<p> If <span class="math inline">\(f,g:U \to \mathbb{R}\)</span> (<span class="math inline">\(U\)</span> open in <span class="math inline">\(\mathbb{R}^n\)</span>) are differentiable (respectively smooth) at <span class="math inline">\(\underline{x}= \underline{a}\in U\)</span> then so are</p>
<ul>
<li><p><span class="math inline">\(f+g\)</span></p></li>
<li><p><span class="math inline">\(fg\)</span></p></li>
<li><p><span class="math inline">\(\frac{f}{g},\)</span> provided <span class="math inline">\(g(\underline{a}) \ne 0\)</span>.</p></li>
</ul>
</div>
<p>You can <u>quote</u> these facts!</p>
<div id="eg:continuousdifferentiability" class="example">
<p> Where is <span class="math inline">\(f(x,y) = y|x-2|\)</span> continuously differentiable and where is it differentiable? A plot of this function is shown in Figure <a href="#fig:notcontinuouslydifferentiable" data-reference-type="ref" data-reference="fig:notcontinuouslydifferentiable">25</a>.</p>
<div class="center">
<figure>
<img src="notcontinuouslydifferentiable.png" id="fig:notcontinuouslydifferentiable" style="width:60.0%" alt="" /><figcaption>A plot of the function <span class="math inline">\(f(x,y) = y |x-2|\)</span> for <span class="math inline">\(0\le x \le 4\)</span> and <span class="math inline">\(-5 \le y \le 5\)</span>.</figcaption>
</figure>
</div>
<p><u>Answer:</u> It is continuously differentiable where its partial derivatives are continuous. So calculate <span class="math display">\[\begin{aligned}
			\text{For } x&gt;2: \quad \quad f&amp;= y(x-2) \quad\Rightarrow\quad\frac{\partial f}{\partial x} \;=\; y, \quad\frac{\partial f}{\partial y} \;=\; x-2 \quad\text{(continuous)}  \\
			\text{For } x&lt;2: \quad \quad f&amp;= -y(x-2) \quad\Rightarrow\quad\frac{\partial f}{\partial x} \;=\; -y, \quad\frac{\partial f}{\partial y} \;=\; -x+2 \quad\text{(continuous).}
		\end{aligned}\]</span></p>
<p><span class="math display">\[\begin{aligned}
			\text{For } x=2: \quad \quad\frac{\partial f(2,y)}{\partial x} &amp;= \lim_{h\to 0} \frac{f(2+h,y) - f(2,y)}{h}  \\
					&amp;= \lim_{h\to 0} \frac{y |h|}{h}.
		\end{aligned}\]</span> For <span class="math inline">\(y\ne0\)</span>, the limit of this for <span class="math inline">\(h&lt;0\)</span> is different to the limit for <span class="math inline">\(h&gt;0\)</span>. Hence the limit does not exist, and so the partial derivative does not exist for <span class="math inline">\(x=2, y\ne 0\)</span>. If <span class="math inline">\(y=0\)</span>, the limit exists and is equal to 0.</p>
<p><span class="math display">\[\begin{aligned}
			\frac{\partial f(2,y)}{\partial y} &amp;= \lim_{h \to 0} \frac{f(2,y+h) -f(2,y)}{h} \\
			&amp;= \lim_{h\to 0} \frac{0-0}{h}  \;=\; 0
		\end{aligned}\]</span></p>
<p>Since <span class="math inline">\(\frac{\partial f}{\partial x}\)</span> does not exist for <span class="math inline">\(x=2, y\ne 0\)</span> it cannot be continuous for <span class="math inline">\(x=2\)</span> (even at <span class="math inline">\(y=0\)</span>) so <span class="math inline">\(f\)</span> is <u>not</u> continuously differentiable for <span class="math inline">\(x=2\)</span> (even at (2,0)).</p>
<p><span class="math display">\[\boxed{\implies f \text{ is continuously differentiable at } \{ (x,y) \in \mathbb{R}^2 : x \ne 2 \} }\]</span></p>
<p>By the differentiability theorem (Theorem <a href="#thm:continuousdifferentiability" data-reference-type="ref" data-reference="thm:continuousdifferentiability">[thm:continuousdifferentiability]</a>), this means that <span class="math inline">\(f\)</span> is also differentiable at all points <span class="math inline">\(\{ (x,y) \in \mathbb{R}^2 : x \ne 2 \}\)</span>. <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> does not exist for <span class="math inline">\(x=2, y\ne 0\)</span> so <span class="math inline">\(f\)</span> not differentiable there. But what about <span class="math inline">\(\underline{x}=(2,0) = 2\underline{e}_1\)</span>?</p>
<p>The partial derivatives do exist there (and are both zero) so <span class="math inline">\(f\)</span> might be differentiable there. <span class="math display">\[\begin{aligned}
			\text{As } \quad \quad\underline{\nabla\mkern-2mu}\mkern 3mu f(2\underline{e}_1) &amp;= (0,0) \\
			\Rightarrow\quad \quad R(\underline{h}) &amp;= f(2\underline{e}_1 + \underline{h}) - f(2\underline{e}_1) - \underline{h}.\underline{\nabla\mkern-2mu}\mkern 3mu f(2\underline{e}_1)  \\
			&amp;= h_2 |h_1| -0 -0 \\
			\Rightarrow\quad \quad\left| \frac{R(\underline{h})}{| \underline{h}|} \right| &amp;= \left| \frac{ h_2 |h_1|}{|\underline{h}|} \right| \\
			&amp;= \frac{|h_2| |h_1 | }{ |\underline{h}|} &lt; \frac{|\underline{h}| \:|\underline{h}|} {|\underline{h}|} = |\underline{h}|
		\end{aligned}\]</span></p>
<p>Now, since <span class="math display">\[\lim_{h\to 0}\left| \frac{R(\underline{h})}{| \underline{h}|} \right| = \lim_{h\to 0}|\underline{h}| = 0,\]</span> and <span class="math display">\[-\left| \frac{R(\underline{h})}{| \underline{h}|} \right| \le \frac{R(\underline{h})}{| \underline{h}|} \le \left| \frac{R(\underline{h})}{| \underline{h}|} \right|,\]</span> we have that <span class="math display">\[\lim_{h\to 0} \frac{R(\underline{h})}{| \underline{h}|} = 0\]</span> by the squeezing theorem, and so <span class="math inline">\(f\)</span> <u>is</u> differentiable at <span class="math inline">\(2\underline{e}_1\)</span>.</p>
<p><span class="math display">\[\boxed{\implies f \text{ is differentiable at } \{ (x,y) \in \mathbb{R}^2 : x \ne 2 \} \cup \{(2,0)\} }\]</span></p>
</div>
</section>
<section id="sub:thechainrulerevisited" class="level2" data-number="6.5">
<h2 data-number="5.5"><span class="header-section-number">5.5</span> The chain rule revisited</h2>
<p>Now that we’ve defined differentiability for scalar fields, we can give a proof of the chain rule for such fields.</p>
<div id="thm:chainrule" class="theorem">
<p> If <span class="math inline">\(f(\underline{x}) : U \to \mathbb{R}\)</span> is differentiable with <span class="math inline">\(U\)</span> an open set in <span class="math inline">\(\mathbb{R}^n\)</span>, and if <span class="math inline">\(\underline{x}\)</span> is a function of <span class="math inline">\(u_1,u_2, \dots u_m\)</span> such that the partial derivatives <span class="math inline">\(\frac{\partial x_1}{\partial u_1},\frac{\partial x_1}{\partial u_2},\dots \frac{\partial x_2}{\partial u_1},\frac{\partial x_2}{\partial u_2},\dots \frac{\partial x_n}{\partial u_m}\)</span> exist (that is all the partial derivatives <span class="math inline">\(\frac{\partial x_i}{\partial u_j}\)</span> for <span class="math inline">\(1\le i \le n\)</span> and <span class="math inline">\(1\le j \le m\)</span> exist), and if <span class="math display">\[\begin{aligned}
			\quad F(u_1,\dots, u_m) &amp;= f(\underline{x}(u_1,\dots,u_m)), \\
			\text{then } \quad\frac{\partial F}{\partial u_b} &amp;= \frac{\partial x_1}{\partial u_b} \frac{\partial f}{\partial x_1} + \frac{\partial x_2}{\partial u_b} \frac{\partial f}{\partial x_2} + \dots + \frac{\partial x_n}{\partial u_b} \frac{\partial f}{\partial x_n}  \;=\; \frac{\partial x_i}{\partial u_b} \frac{\partial f}{\partial x_i} \quad \quad\text{(Using ESC)} \\
				&amp;= \frac{\partial \underline{x}}{\partial u_b} . \underline{\nabla\mkern-2mu}\mkern 3mu f
		\end{aligned}\]</span></p>
</div>
<div id="pf:chainrule" class="proof">
<p> We have <span class="math display">\[\begin{aligned}
		f&amp;: U \subset \mathbb{R}^n\to \mathbb{R}\\
		\underline{x}&amp;: \mathbb{R}^m \to \mathbb{R}^n\\
		F &amp;: \mathbb{R}^m \to \mathbb{R},
	\end{aligned}\]</span> where <span class="math inline">\(F \;=\; f( \underline{x}( \underline{u}))\)</span>.</p>
<p>Set <span class="math display">\[\begin{aligned}
		\underline{x}(u_1,\dots u_b, \dots u_m) &amp;= \underline{a}\\
		\text{and} \quad \underline{x}(u_1,\dots u_b + k, \dots u_m) &amp;= \underline{a}+ \underline{h}(k),
	\end{aligned}\]</span> then <span class="math display">\[\begin{aligned}
		\frac{\partial F}{\partial u_b} &amp;= \lim_{k\to 0} \frac{F(u_1,\dots,u_b + k, \dots u_m) - F(u_1,\dots,u_b,\dots,u_m)}{k} \\
		 &amp;= \lim_{k\to 0} \frac{f(\underline{x}((u_1,\dots,u_b + k, \dots u_m)) - f(\underline{x}((u_1,\dots,u_b,\dots,u_m))}{k} \\
		&amp;= \lim_{k\to 0} \frac{f(\underline{a}+\underline{h}(k))) - f(\underline{a})}{k} \\
		&amp;= \lim_{k\to 0} \frac{ \underline{h}(k) . \underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{a}) + R(\underline{h}(k)) }{k} \\
		\text{(since $f$ is differentiable } &amp;\Rightarrow f(\underline{a}+\underline{h}) - f(\underline{a}) \;=\; \underline{h}. \underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{a}) + R(\underline{h}) ) \\
		&amp;= \lim_{k\to 0} \frac{ \underline{h}(k) . \underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{a})}{k}  +  \lim_{k\to 0} \frac{R(\underline{h}(k)) }{k} \\ \nonumber
		&amp;= \left(\lim_{k\to 0} \frac{ \underline{h}(k) }{k}\right) . \underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{a})  +  \lim_{k\to 0} \frac{R(\underline{h}(k)) }{k}, \quad \quad\quad \quad\quad \quad(a)
	\end{aligned}\]</span> since <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> doesn’t depend on <span class="math inline">\(k\)</span>. Now <span class="math display">\[\begin{aligned}
		\lim_{k\to 0} \frac{\underline{h}(k)}{k} &amp;= \lim_{k\to 0} \frac{ (\underline{a}+\underline{h}(k)) - \underline{a}}{k} \\
		&amp;= \lim_{k\to 0} \frac{ \underline{x}(u_1,\dots u_b + k, \dots u_m)  -  \underline{x}(u_1,\dots u_b, \dots u_m)}{k} \\
		&amp;= \frac{\partial \underline{x}}{\partial u_b},		\quad \quad\quad \quad\quad \quad\quad \quad\quad \quad\quad \quad\quad \quad(b)
	\end{aligned}\]</span> and <span class="math display">\[\lim_{k \to 0} \frac{R(\underline{h}(k))}{k} = \lim_{k \to 0}\frac{R(\underline{h}(k))}{||\underline{h}(k)||} \frac{||\underline{h}(k)||}{k}.\]</span> Then since <span class="math display">\[\begin{aligned}
		\lim_{k\to 0} \frac{R(\underline{h}(k))}{|\underline{h}(k)|} &amp;= 0  \quad(\text{by definition, since $f$ is differentiable}) \\
		\text{and} \quad\lim_{k\to 0}  \frac{|\underline{h}(k)|}{k} &amp;= \pm \left|\left| \lim_{k\to 0} \frac{\underline{h}(k)}{k}  \right|\right|  \;=\; \pm \left|\left|  \frac{\partial \underline{x}}{\partial u_b} \right|\right| \quad\text{by (b)}\\
		\text{We have} \quad \quad\lim_{k\to 0} \frac{R(\underline{h}(k))}{k} &amp;=  \lim_{k\to 0} \left(\frac{R(\underline{h}(k))}{|\underline{h}(k)|}  \frac{|\underline{h}(k)|}{k} \right)\;=\; 0.\left(\pm \left|\left|  \frac{\partial \underline{x}}{\partial u_b} \right|\right| \right) \;=\; 0. \quad \quad\quad \quad(c)
	\end{aligned}\]</span> Combining (a), (b) and (c) therefore gives <span class="math display">\[\frac{\partial F}{\partial u_b} \;=\; \frac{\partial \underline{x}}{\partial u_b} . \underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{a}) \;=\;   \frac{\partial x_1}{\partial u_b} \frac{\partial f}{\partial x_1} + \dots + \frac{\partial x_n}{\partial u_b} \frac{\partial f}{\partial x_n} \;=\; \frac{\partial x_i}{\partial u_b} \frac{\partial f}{\partial x_i}\]</span></p>
</div>
</section>
<section id="the-implicit-function-theorem" class="level2" data-number="6.6">
<h2 data-number="5.6"><span class="header-section-number">5.6</span> The implicit function theorem</h2>
<p>We first consider the implicit function theorem in the case of a scalar field on <span class="math inline">\(\mathbb{R}^2\)</span>.</p>
<p>Recall: A <u>level set</u> <span class="math inline">\(S\)</span> of <span class="math inline">\(f: U \to \mathbb{R}\)</span>, where <span class="math inline">\(U\)</span> is an open subset of <span class="math inline">\(\mathbb{R}^n\)</span>, is the set of points <span class="math inline">\(\{ \underline{x}\in U: f(\underline{x}) = c \}\)</span> for some constant <span class="math inline">\(c\)</span>.</p>
<p>For <span class="math inline">\(n=2\)</span>, the level set will usually be a curve, called a <u>level curve</u>.</p>
<p><strong>Question</strong>: When can the level curve of <span class="math inline">\(f: U \to \mathbb{R}\)</span>, with <span class="math inline">\(U\)</span> open in <span class="math inline">\(\mathbb{R}^2\)</span> , be written in the form <span class="math inline">\(y=g(x)\)</span> with <span class="math inline">\(g\)</span> a differentiable function? (Remember, if <span class="math inline">\(g(x)\)</span> is a <u>function</u> it must give a <u>single</u> value <span class="math inline">\(g(x)\)</span> for each value of the input <span class="math inline">\(x\)</span>.)</p>
<div class="center">
<figure>
<img src="implicitcurve.jpeg" id="fig:implicitcurve" style="width:60.0%" alt="" /><figcaption>A level curve of the function <span class="math inline">\(f\)</span> defined on an open set <span class="math inline">\(U\)</span>, <span class="math inline">\(f(x,y)=c\)</span>. This level curve can also be given in the form <span class="math inline">\(y=g(x)\)</span> for some differentiable function <span class="math inline">\(g\)</span>.</figcaption>
</figure>
</div>
<div id="eg:implicitfunctionwarmup" class="example">
<p> Let <span class="math inline">\(U = \mathbb{R}^2\)</span>.</p>
<ul>
<li><p>(A) <span class="math inline">\(f(x,y) = x^2 -y = c\)</span>.</p>
<p>Here <span class="math inline">\(y=g(x) = x^2-c\)</span>. Three level curves are show in Figure <a href="#fig:implicitcurveA" data-reference-type="ref" data-reference="fig:implicitcurveA">27</a>.</p>
<div class="center">
<figure>
<img src="implicitcurveA.png" id="fig:implicitcurveA" style="width:40.0%" alt="" /><figcaption>Three level curves of <span class="math inline">\(f(x,y) = x^2 -y\)</span>. Each one can be written in the form <span class="math inline">\(y=g(x) = x^2-c\)</span>.</figcaption>
</figure>
</div></li>
<li><p>(B) <span class="math inline">\(f(x,y) = x^2 + y^2 = c\)</span>.</p>
<p>Here we have <span class="math inline">\(y = \pm\sqrt{c-x^2}\)</span>; even for <span class="math inline">\(c&gt;0\)</span> and <span class="math inline">\(x\in (-\sqrt c, +\sqrt c)\)</span>, we <u>can’t</u> write the whole level curves as <span class="math inline">\(y=g(x)\)</span>, but we can write bits of them. Three level curves are show in Figure <a href="#fig:implicitcurveB" data-reference-type="ref" data-reference="fig:implicitcurveB">28</a>.</p>
<div class="center">
<figure>
<img src="implicitcurveB.png" id="fig:implicitcurveB" style="width:40.0%" alt="" /><figcaption>Three level curves of <span class="math inline">\(f(x,y) = x^2 + y^2\)</span>. These can’t be written in the form <span class="math inline">\(y=g(x)\)</span> for any differentiable function <span class="math inline">\(g\)</span>, though we can write sections of the curves in this form.</figcaption>
</figure>
</div></li>
<li><p>(C) <span class="math inline">\(f(x,y) = (x+y) e^{xy}\)</span>.</p>
<p>A selection of level curves of this function are shown in Figure <a href="#fig:levelcurves" data-reference-type="ref" data-reference="fig:levelcurves">29</a>. It’s difficult to see where we can write these level curves in the form <span class="math inline">\(y=g(x)\)</span>.</p>
<div class="center">
<figure>
<img src="levelcurves.png" id="fig:levelcurves" style="width:40.0%" alt="" /><figcaption>Level curves of the function <span class="math inline">\(f(x,y) = (x+y) e^{xy}\)</span>. Where can these be written in thee form <span class="math inline">\(y=g(x)\)</span> for <span class="math inline">\(g\)</span> a differentiable function of <span class="math inline">\(x\)</span>?</figcaption>
</figure>
</div></li>
</ul>
</div>
<p><strong>Terminology</strong>: <span class="math inline">\(y=g(x)\)</span> gives <span class="math inline">\(y\)</span> as an <u>explicit function</u> of <span class="math inline">\(x\)</span>; <span class="math inline">\(f(x,y) = 0\)</span> gives <span class="math inline">\(y\)</span> as an <u>implicit function</u> of <span class="math inline">\(x\)</span>. To go from explicit to implicit, just set <span class="math inline">\(f(x,y) = g(x) - y\)</span>.</p>
<p><strong>Question</strong>: When is it possible to go the other way, from implicit to explicit?</p>
<p><strong>Answer</strong>: Suppose the level curve <span class="math inline">\(f(x,y)=c\)</span> <u>can</u> be written as <span class="math inline">\(y=g(x)\)</span>. Then <span class="math display">\[f(x,g(x)) \;=\; c. \quad \quad\quad \quad\quad \quad(I)\]</span> Differentiating this, using the chain rule (LHS is a function of <span class="math inline">\(x\)</span> only) gives <span class="math display">\[\begin{aligned}
		\frac{d}{d x} f(x,g(x)) &amp;= \frac{\partial f}{\partial x} + \frac{d g}{d x}\frac{\partial f}{\partial y} \\
		\text{but} \quad \quad\frac{d}{d x} f(x,g(x)) &amp;= \frac{d c}{d x} \;=\;0 \quad\text{(as $c$ is a constant)} \\
		\Rightarrow\quad \quad\quad \quad\frac{d g}{d x} &amp;= -\frac{\frac{\partial f(x,g(x))}{\partial x}}{\frac{\partial f(x,g(x))}{\partial y}} \quad \quad\quad \quad(II)
	\end{aligned}\]</span> Note: We have a problem if <span class="math inline">\(\frac{\partial f(x,g(x))}{\partial y} = 0\)</span>.</p>
<div class="theorem">
<p>The <u>Implicit Function Theorem</u> states that if <span class="math inline">\(f(x,y):U\to \mathbb{R}\)</span> is differentiable, and if <span class="math inline">\((x_0,y_0)\)</span> is a point in <span class="math inline">\(U\)</span> on the level curve <span class="math inline">\(f(x,y)=c\)</span> at which <span class="math inline">\(\frac{\partial f}{\partial y} \ne 0\)</span>, then a differentiable function <span class="math inline">\(g(x)\)</span> of <span class="math inline">\(x\)</span> exists in a neighbourhood of <span class="math inline">\(x_0\)</span> satisfying (I) and (II) with <span class="math inline">\(g(x_0) = y_0\)</span>.</p>
</div>
<div id="eg:implicitfunctiontheorem" class="example">
<p> Let’s now return to the three examples we saw before.</p>
<ul>
<li><p>(A) <span class="math display">\[\begin{aligned}
				 f(x,y) &amp;= x^2-y \\
				\Rightarrow\quad \quad\frac{\partial f}{\partial y} &amp;= -1 \; \ne \;0,
			\end{aligned}\]</span> so since this is non-zero everywhere, we can find <span class="math inline">\(g(x)\)</span>.</p></li>
<li><p>(B) <span class="math display">\[\begin{aligned}
			f(x,y) &amp;= x^2+y^2 \\
			\Rightarrow\quad \quad\frac{\partial f}{\partial y} &amp;= 2y,
		\end{aligned}\]</span> so if <span class="math inline">\(y_0 = 0\)</span> then <span class="math inline">\(\frac{\partial f}{\partial y}(x_0,y_0) =0\)</span>. We therefore can’t find a differentiable function <span class="math inline">\(g(x)\)</span> describing the level curves of <span class="math inline">\(f\)</span> in a neighbourhood of <span class="math inline">\(y=0\)</span>. Looking at Figure <a href="#fig:implicitcircles" data-reference-type="ref" data-reference="fig:implicitcircles">30</a>, we see that no single-valued function can describe the level curves of <span class="math inline">\(f\)</span> in a neighbourhood of <span class="math inline">\(y=0\)</span>.</p>
<div class="center">
<figure>
<img src="implicitcircles.jpeg" id="fig:implicitcircles" style="width:50.0%" alt="" /><figcaption>In any neighbourhood of <span class="math inline">\(y=0\)</span>, we can’t describe the level curve of <span class="math inline">\(f(x,y) = x^2 + y^2\)</span> by a differentiable function <span class="math inline">\(g(x)\)</span>.</figcaption>
</figure>
</div></li>
<li><p>(C) <span class="math display">\[\begin{aligned}
			f(x,y) &amp;= (x+y)e^{xy} \\
			\Rightarrow\quad \quad\frac{\partial f}{\partial y} &amp;=  \frac{\partial}{\partial y} ((x+y)e^{xy}) \\
			&amp;= e^{xy} + (x+y)xe^{xy}\\
			&amp;= (1+x^2 + xy)e^{xy} \\
			\text{so} \quad \quad\quad \quad\frac{\partial f}{\partial y} \;=\;0 &amp; \leftrightarrow  1+x^2 + xy \;=\; 0\\
			\Rightarrow\quad \quad\quad \quad y&amp;= -\frac{(1+x^2)}{x} \;=\; -(x+\frac{1}{x}).
		\end{aligned}\]</span> So we have trouble at points <span class="math inline">\(x_0,y_0\)</span> with <span class="math inline">\(y_0= - (x_0+1/x_0)\)</span>, as shown in Figure <a href="#fig:implicitcurveproblem" data-reference-type="ref" data-reference="fig:implicitcurveproblem">31</a></p>
<div class="center">
<figure>
<img src="implicitcurveproblem.png" id="fig:implicitcurveproblem" style="width:50.0%" alt="" /><figcaption>The level curves of <span class="math inline">\(y=(x+y)e^{xy}\)</span> can be written in the form <span class="math inline">\(g(x)\)</span>, for a differentiable function <span class="math inline">\(g\)</span>, aside from in a neighbourhood of a point on the line <span class="math inline">\(y=-(x+1/x)\)</span>.</figcaption>
</figure>
</div></li>
</ul>
</div>
<div id="eg:ellipseimplicit" class="example">
<p> If <span class="math inline">\(f(x,y) = \frac{x^2}{a^2} + \frac{y^2}{b^2}\)</span> then <span class="math inline">\(f(x,y) = c, c&gt;0\)</span> is an ellipse, as shown in Figure <a href="#fig:ellipse" data-reference-type="ref" data-reference="fig:ellipse">32</a></p>
<div class="center">
<figure>
<img src="ellipse.jpeg" id="fig:ellipse" style="width:50.0%" alt="" /><figcaption>The curve can be written in the form <span class="math inline">\(g(x)\)</span> aside from in a neighbourhood of either point <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span>.</figcaption>
</figure>
</div>
<p><span class="math inline">\(f(x,y)\)</span> is differentiable so, in a neighbourhood of <span class="math inline">\(x_0\)</span>, the curve can be written as <span class="math inline">\(y=g(x)\)</span> provided <span class="math inline">\(\frac{\partial f}{\partial y}(x_0,y_0) \ne 0\)</span>. But <span class="math inline">\(\frac{\partial f}{\partial y} = \frac{2y}{b^2}\)</span> so this can be done except at points on <span class="math inline">\(x\)</span>-axis. <span class="math display">\[\begin{aligned}
			\text{In fact} \quad \quad\quad \quad g(x) &amp;= b\sqrt{c-\frac{x^2}{a^2}} \quad \quad\quad \quad\text{if } y_0 &gt; 0 \\
			\text{or} \quad \quad\quad \quad g(x) &amp;= -b\sqrt{c-\frac{x^2}{a^2}} \quad \quad\quad \quad\text{if } y_0 &lt; 0
		\end{aligned}\]</span></p>
<p>At points <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, <span class="math inline">\(\frac{\partial f}{\partial y} =0\)</span> so <span class="math inline">\(g(x)\)</span> is not differentiable. However at these points <span class="math inline">\(\frac{\partial f}{\partial x} \ne 0\)</span>, so instead of writing <span class="math inline">\(y=g(x)\)</span> we could find an <span class="math inline">\(h(y)\)</span> such that <span class="math inline">\(x=h(y)\)</span>.</p>
</div>
<p>If there is a point <span class="math inline">\(Q\)</span> on a level curve <span class="math inline">\(f=c\)</span> at which <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f=\underline{0}\)</span>, the value of <span class="math inline">\(c\)</span> is called a <u>critical</u> value (otherwise it is a <u>regular</u> value) and the level curve <u>cannot</u> be written either as <span class="math inline">\(y=g(x)\)</span> or as <span class="math inline">\(x=h(y)\)</span> in the neighbourhood of <span class="math inline">\(Q\)</span> (with g,h differentiable).</p>
<div id="eg:criticalvalue" class="example">
<p> <span class="math inline">\(f=x^3-y^2\)</span>, then <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f = 3x^2 \underline{e}_1 - 2y \underline{e}_2\)</span> so <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f=\underline{0}\)</span> at <span class="math inline">\(\underline{x}= \underline{0}\)</span>, so <span class="math inline">\(c=0\)</span> is a critical value for <span class="math inline">\(f(x,y)=c\)</span>. <span class="math display">\[\begin{aligned}
			f=0 \quad \quad\Leftrightarrow\quad \quad y&amp;= \pm \sqrt{x^3} \quad \quad\quad \quad\text{no unique function in neighbourhood of } \underline{0} \\
			x&amp;= y^{\frac{2}{3}} \quad \quad\quad \quad\text{not differentiable at } \underline{0}
		\end{aligned}\]</span></p>
<div class="center">
<figure>
<img src="criticalcurve.png" id="fig:criticalc" style="width:50.0%" alt="" /><figcaption>Level curves of the function <span class="math inline">\(f(x,y) = x^3 - y^2\)</span>.</figcaption>
</figure>
</div>
</div>
</section>
<section id="implicit-function-theorem-for-surfaces" class="level2 unnumbered">
<h2 class="unnumbered">Implicit function theorem for surfaces</h2>
<p>All of this generalises to higher dimensions. For example, the level sets of scalar fields in <span class="math inline">\(\mathbb{R}^3\)</span> (i.e. <span class="math inline">\(\mathbb{R}^n\)</span> with <span class="math inline">\(n=3\)</span>) will generally be <u>surfaces</u>. We therefore have the implicit function theorem for surfaces.</p>
<div id="thm:implicitfunctiontheoremsurfaces" class="theorem">
<p> Let <span class="math inline">\(f(x,y,z): U \to \mathbb{R}\)</span> be differentiable (<span class="math inline">\(U\)</span> an open subset of <span class="math inline">\(\mathbb{R}^3\)</span>) and let <span class="math inline">\((x_0,y_0,z_0) \in U\)</span> be a point on the level set <span class="math inline">\(f(x,y,z) = c\)</span>, so <span class="math inline">\(f(x_0,y_0,z_0) =c\)</span>.</p>
<p>If <span class="math inline">\(\frac{\partial f}{\partial z}(x_0,y_0,z_0) \ne 0\)</span> then the equation <span class="math inline">\(f(x,y,z)=c\)</span> implicitly defines a surface <span class="math inline">\(z=g(x,y)\)</span> in a neighbourhood of the point <span class="math inline">\((x_0,y_0,z_0)\)</span>, via <span class="math display">\[f(x,y,g(x,y)) \;=\; c, \quad \quad\quad \quad\quad \quad(I)\]</span> with <span class="math inline">\(g(x_0,y_0)=z_0\)</span>, and where <span class="math display">\[\begin{aligned}
			\frac{\partial g}{\partial x}(x_0,y_0) &amp;= -\frac{\frac{\partial f}{\partial x}(x_0,y_0,z_0)}{\frac{\partial f}{\partial z}(x_0,y_0,z_0)} \quad \quad\quad \quad\ \quad \quad(IIa) \\
			\frac{\partial g}{\partial y}(x_0,y_0) &amp;= -\frac{\frac{\partial f}{\partial y}(x_0,y_0,z_0)}{\frac{\partial f}{\partial z}(x_0,y_0,z_0)}. \quad \quad\quad \quad\ \quad \quad(IIb)
		\end{aligned}\]</span></p>
</div>
<p>As in the implicit function theorem for curves, conditions <span class="math inline">\((IIa)\)</span> and <span class="math inline">\((IIb)\)</span> must hold for <span class="math inline">\(g(x,y)\)</span> if it exists, since <span class="math display">\[f(x,y,g(x,y)) \;=\; c\]</span> for all <span class="math inline">\((x,y)\)</span> in some neighbourhood of <span class="math inline">\((x_0,y_0)\)</span>. If we partially differentiate both sides with respect to <span class="math inline">\(x\)</span>, and use the chain rule: <span class="math display">\[\begin{aligned}
		0\;=\; \frac{\partial}{\partial x}(f(x,y,g(x,y)) &amp;= \frac{\partial x}{\partial x} \frac{\partial f}{\partial x} + \frac{\partial y}{\partial x} \frac{\partial f}{\partial y} + \frac{\partial g}{\partial x} \frac{\partial f}{\partial z} \\
		&amp;= \frac{\partial f}{\partial x} + \frac{\partial g}{\partial x} \frac{\partial f}{\partial z},
	\end{aligned}\]</span> as <span class="math inline">\(\frac{\partial x}{\partial x}=1\)</span>, <span class="math inline">\(\frac{\partial y}{\partial x}=0\)</span> and <span class="math inline">\(z=g(x,y)\)</span>. Hence <span class="math display">\[\frac{\partial g}{\partial x} \;=\; - \frac{\frac{\partial f}{\partial x}}{\frac{\partial f}{\partial z}}\]</span> as required. The argument follows similarly for <span class="math inline">\(\frac{\partial g}{\partial y}\)</span>.</p>
<p><strong>Recall</strong>: As we saw in Subsection <a href="#sub:directionalderivatives" data-reference-type="ref" data-reference="sub:directionalderivatives">3.2</a>, <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span> at <span class="math inline">\(\underline{x}_0 = (x_0,y_0,z_0)\)</span> is <u>normal</u> to the tangent plane of the surface <span class="math inline">\(z=g(x,y)\)</span> at <span class="math inline">\((x_0,y_0)\)</span>. So the normal line is given in parametric form by <span class="math display">\[\underline{x}(t) \;=\; \underline{x}_0 + t\underline{\nabla\mkern-2mu}\mkern 3mu f,\]</span> and the tangent plane is given by <span class="math display">\[(\underline{x}- \underline{x}_0) . \underline{\nabla\mkern-2mu}\mkern 3mu f \;=\; 0\]</span></p>
<div id="eg:implicitfunctionsurface" class="example">
<p> This example is taken from the 2011 exam, with notation slightly changed.</p>
<p><u>Question</u>: Check if <span class="math inline">\(z\sin(\pi x) = \log(2z-y^2)\)</span> defines a function <span class="math inline">\(z=g(x,y)\)</span> around <span class="math inline">\(x=2\)</span>, <span class="math inline">\(y=-1\)</span>. Find the tangent plane and normal line to <span class="math inline">\(z=g(x,y)\)</span> at <span class="math inline">\((2,-1)\)</span>.</p>
<p><u>Answer</u>: Set <span class="math inline">\(f(x,y,z)= z\sin(\pi x) - \log(2z-y^2)\)</span>, then the question is asking about the level set <span class="math inline">\(f=0\)</span>. We have <span class="math display">\[\begin{aligned}
			f(2,-1,z) &amp;= z\sin(2\pi) - \log(2z-1) \\
			&amp;= -\log(2z-1) \\
			\text{So } \quad \quad\quad \quad f=0 \quad\Leftrightarrow\quad\log(2z-1) &amp;= 0 \\
			\Leftrightarrow\quad \quad\quad \quad 2z-1 &amp;= 1 \\
			\Leftrightarrow\quad \quad\quad \quad z&amp;=1.
		\end{aligned}\]</span></p>
<p>The Implicit Function Theorem then states that <span class="math inline">\(f(x,y,z)=0\)</span> defines a surface <span class="math inline">\(z=g(x,y)\)</span> near <span class="math inline">\((x_0,y_0,z_0)=(2,-1,1)\)</span> provided <span class="math inline">\(\frac{\partial f}{\partial z} \ne 0\)</span> there. But <span class="math display">\[\begin{aligned}
			\frac{\partial f}{\partial z} &amp;= \sin(\pi x) - \frac{2}{2z-y^2} \\
			\text{So} \quad \quad\frac{\partial f}{\partial z}(2,-1,1) &amp;= -\frac{2}{2-1} \;=\; -2 \; \ne \; 0.
		\end{aligned}\]</span></p>
<p>The other partial derivatives are: <span class="math display">\[\begin{aligned}
			\frac{\partial f}{\partial x} &amp;= \pi z\cos(\pi x) \quad \quad\Rightarrow\quad \quad\frac{\partial f}{\partial x} (2,-1,1) \;=\; \pi \\
			\frac{\partial f}{\partial y} &amp;= -\frac{-2y}{2z-y^2} \;=\; \frac{2y}{2z-y^2} \quad \quad\Rightarrow\quad \quad\frac{\partial f}{\partial y} (2,-1,1) \;=\; \frac{-2}{1} \;=\; -2,
		\end{aligned}\]</span> so <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f(2,-1,1) = (\pi,-2,-2)\)</span>.</p>
<p>[Aside: So partial derivatives of <span class="math inline">\(g(x,y)\)</span> are (not that we need them here): <span class="math display">\[\begin{aligned}
			\frac{\partial g}{\partial x} &amp;= -\frac{\frac{\partial f}{\partial x} }{ \frac{\partial f}{\partial z} } \;=\; \pi /2 \\
			\frac{\partial g}{\partial y} &amp;= -\frac{\frac{\partial f}{\partial y} }{ \frac{\partial f}{\partial z} } \;=\;  -1
		\end{aligned}\]</span> end aside].</p>
<p>So a normal line is <span class="math display">\[\begin{aligned}
			(x,y,z) &amp;= (2,-1,1) + t(\pi, -2,-2)  \\
			\Rightarrow\quad \quad\quad \quad\underline{x}(t) &amp;= (2+\pi t)\underline{e}_1 + (-1-2 t) \underline{e}_2 + (1-2t) \underline{e}_3,
		\end{aligned}\]</span> and the tangent plane is <span class="math display">\[\begin{aligned}
			((x,y,z) - (2,-1,1)) . (\pi, -2, -2) &amp;=0 \\
			\Rightarrow\quad \quad\quad \quad(x-2)\pi + (y+1) (-2) + (z-1)(-2) &amp;= 0\\
			\Rightarrow\quad \quad\quad \quad\pi x -2 y -2 z &amp;= 2 \pi \\
			\Rightarrow\quad \quad\quad \quad\frac{\pi}{2} x - y -z &amp;= \pi
		\end{aligned}\]</span></p>
<p>Note, that if we write <span class="math inline">\(z=g(x,y)\)</span> and rearrange to get <span class="math inline">\(g(x,y) = \frac{\pi}{2} x - y - \pi\)</span>, we see that <span class="math inline">\(\frac{\partial g}{\partial x}\)</span> and <span class="math inline">\(\frac{\partial g}{\partial y}\)</span> agree with the values found above, as they must.</p>
</div>
</section>
</section>
<section id="sec:differentiabilityofvectorfields" class="level1" data-number="7">
<h1 data-number="6"><span class="header-section-number">6</span> Differentiability of vector fields</h1>
<section id="sub:differentiablemapsfromrntorn" class="level2" data-number="7.1">
<h2 data-number="6.1"><span class="header-section-number">6.1</span> Differentiable maps <span class="math inline">\(\mathbb{R}^n \to \mathbb{R}^n\)</span></h2>
<p>We will now generalise the idea of differentiability of scalar fields from last term. Recall that for a scalar field <span class="math inline">\(f(\underline{x}) : U \to \mathbb{R}\)</span>, with <span class="math inline">\(U\)</span> open in <span class="math inline">\(\mathbb{R}^n\)</span>, <span class="math inline">\(f\)</span> is differentiable at <span class="math inline">\(\underline{a} \in U\)</span> if <span class="math display">\[\begin{aligned}
		f(\underline{a} + \underline{h}) - f(\underline{a}) \; &amp;=\; \underline{h}.\underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{a}) \;+\; R(\underline{h})   \quad \quad\quad \quad\quad \quad(a) \\ 
		\text{with} \quad \quad\quad \quad\lim_{\underline{h}\to \underline{0}}  \frac{R(\underline{h})}{| \underline{h}|} \;&amp;=\;  0, \quad \quad\quad \quad\quad \quad\quad \quad\quad \quad\quad \quad\quad (b)
	\end{aligned}\]</span> where you should note that the first term on RHS of <span class="math inline">\((a)\)</span>, <span class="math inline">\(\underline{h}.\underline{\nabla\mkern-2mu}\mkern 3mu f(\underline{a})\)</span>, is <span><em>linear</em></span> in <span class="math inline">\(\underline{h}\)</span>.</p>
<div id="def:def:differentiablevecfield" class="definition">
<p> Consider a <u>vector</u> field <span class="math inline">\(\underline{F}(\underline{x}): U \to \mathbb{R}^n\)</span>, <span class="math inline">\(U\)</span> open in <span class="math inline">\(\mathbb{R}^n\)</span>. Then <span class="math inline">\(\underline{F}\)</span> is defined to be <em>differentiable</em> at <span class="math inline">\(\underline{a} \in U\)</span> if there is a linear function <span class="math inline">\(\underline{L} : \mathbb{R}^n\to \mathbb{R}^n\)</span> such that <span class="math display">\[\begin{aligned}
			\underline{F}(\underline{a}+\underline{h}) - \underline{F}(\underline{a}) \;&amp;=\; \underline{L}(\underline{h}) \;+\; \underline{R}(\underline{h})  \quad \quad\quad \quad\quad \quad\quad \;\; (A) \\
			\text{with} \quad \quad\quad \quad\lim_{\underline{h}\to \underline{0}}  \frac{\underline{R}(\underline{h})}{| \underline{h}|}
			\;&amp;=\;  \underline{0}\,. \quad \quad\quad \quad\quad \quad\quad \quad\quad \quad\quad \quad\quad (B)
		\end{aligned}\]</span></p>
</div>
<p>Now linear functions <span class="math inline">\(\mathbb{R}^n \to \mathbb{R}^n\)</span> are matrices. To see what matrix use the standard basis, <span class="math display">\[\begin{aligned}
		\underline{F}(\underline{x}) &amp;= F_1(\underline{x}) \underline{e}_1 +  F_2(\underline{x}) \underline{e}_2 + \dots +  F_n(\underline{x}) \underline{e}_n  \\
		\underline{L}(\underline{h}) &amp;= L_1(\underline{h}) \underline{e}_1 +  L_2(\underline{h}) \underline{e}_2 + \dots +  L_n(\underline{h}) \underline{e}_n  \\
		\underline{R}(\underline{h}) &amp;= R_1(\underline{h}) \underline{e}_1 +  R_2(\underline{h}) \underline{e}_2 + \dots +  R_n(\underline{h}) \underline{e}_n,
	\end{aligned}\]</span> so the <span class="math inline">\(j\)</span>th components of <span class="math inline">\((A)\)</span> and <span class="math inline">\((B)\)</span> are <span class="math display">\[\begin{aligned}
		F_j(\underline{a}+\underline{h}) - F_j(\underline{a}) \;&amp;=&amp;\; L_j(\underline{h}) \;+\; R_j(\underline{h}) \quad \quad\quad \quad\quad \quad\quad \quad(A)_j   \\
		\text{with} \quad \quad\quad \quad\lim_{\underline{h}\to \underline{0}}  \frac{R_j(\underline{h})}{| \underline{h}|}
		\;&amp;=&amp;\;  0\,. \quad \quad\quad \quad\quad \quad\quad \quad\quad \quad\quad \quad\quad \quad(B)_j
	\end{aligned}\]</span> These are just conditions <span class="math inline">\((a)\)</span> and <span class="math inline">\((b)\)</span> for <span class="math inline">\(F_j(\underline{x})\)</span> to be differentiable as a map <span class="math inline">\(U \to \mathbb{R}\)</span>, i.e. as a scalar field. So we can use results from last term to see that <span class="math display">\[L_j(\underline{h}) \;\;=\;\; \underline{h}.\underline{\nabla\mkern-2mu}\mkern 3mu F_j(\underline{a}),\]</span> that is <span class="math display">\[\begin{aligned}
		L_1 \;&amp;=\; \underline{h}.\underline{\nabla\mkern-2mu}\mkern 3mu F_1(\underline{a}) \;\;=\;\; h_1 \frac{\partial F_1}{\partial x_1} + h_2 \frac{\partial F_1}{\partial x_2} + \dots + h_n \frac{\partial F_1}{\partial x_n}  \\
		L_2 \;&amp;=\; \underline{h}.\underline{\nabla\mkern-2mu}\mkern 3mu F_2(\underline{a}) \;\;=\;\; h_1 \frac{\partial F_2}{\partial x_1} + h_2 \frac{\partial F_2}{\partial x_2} + \dots + h_n \frac{\partial F_2}{\partial x_n}  \\
		\vdots \;&amp; \;\;\; \vdots \\
		L_n \;&amp;=\; \underline{h}.\underline{\nabla\mkern-2mu}\mkern 3mu F_n(\underline{a}) \;\;=\;\; h_1 \frac{\partial F_n}{\partial x_1} + h_2 \frac{\partial F_n}{\partial x_2} + \dots + h_n \frac{\partial F_n}{\partial x_n},
	\end{aligned}\]</span> or <span class="math display">\[\begin{aligned}
		\begin{pmatrix}
		L_1 \\
		L_2 \\
		\vdots \\
		L_n
		\end{pmatrix}  \;&amp;=\; 
		\begin{pmatrix}
		 h_1 \frac{\partial F_1}{\partial x_1} \;+\; h_2 \frac{\partial F_1}{\partial x_2} \;+\; \dots \;+\; h_n \frac{\partial F_1}{\partial x_n}  \\
		 h_1 \frac{\partial F_2}{\partial x_1} \;+\; h_2 \frac{\partial F_2}{\partial x_2} \;+\; \dots \;+\; h_n \frac{\partial F_2}{\partial x_n}  \\
		 \vdots  \\
		 h_1 \frac{\partial F_n}{\partial x_1} \;+\; h_2 \frac{\partial F_n}{\partial x_2} \;+\; \dots \;+\; h_n \frac{\partial F_n}{\partial x_n}  
		\end{pmatrix} \\
		\;&amp;=\; 
		\begin{pmatrix}
		  \frac{\partial F_1}{\partial x_1} &amp; \frac{\partial F_1}{\partial x_2}&amp; \dots &amp; \frac{\partial F_1}{\partial x_n}  \\
		 \frac{\partial F_2}{\partial x_1} &amp; \frac{\partial F_2}{\partial x_2}  &amp;\dots &amp;\frac{\partial F_2}{\partial x_n}  \\
		 \vdots  &amp; \vdots &amp;&amp; \vdots \\
		  \frac{\partial F_n}{\partial x_1} &amp; \frac{\partial F_n}{\partial x_2}  &amp;\dots&amp;  \frac{\partial F_n}{\partial x_n}  
		\end{pmatrix}  
		\begin{pmatrix}
		h_1 \\
		h_2 \\
		\vdots \\
		h_n
		\end{pmatrix}\,.
	\end{aligned}\]</span></p>
<p>The <span class="math inline">\(n\times n\)</span> matrix on the RHS of the last equation is called the <u>Jacobian matrix</u>, or <u>differential</u>, of <span class="math inline">\(\underline{F}(\underline{x})\)</span> at <span class="math inline">\(\underline{x}=\underline{a}\)</span>; it is written as <span class="math inline">\(D\underline{F}(\underline{a})\)</span>, or <span class="math inline">\(d\underline{F}(\underline{a})\)</span> (or <span class="math inline">\(D\underline{F}_{\underline{a}}\)</span> or <span class="math inline">\(d\underline{F}_{\underline{a}}\)</span> or even <span class="math inline">\(J_{ij}\)</span>).</p>
<div id="def:Jacobian" class="definition">
<p> The determinant of the differential, <span class="math display">\[\det(D\underline{v}) \equiv |D\underline{v}|\]</span> is called the <u>Jacobian</u>, <span class="math inline">\(J(\underline{v})\)</span>.</p>
</div>
<div id="eg:simpledifferential" class="example">
<p> If <span class="math display">\[\underline{v}(\underline{x}) \;=\; \begin{pmatrix}
			x^2-y^2 \\
			2xy 
			\end{pmatrix}  \;=\; 
			\begin{pmatrix}
			v_1 \\
			v_2
			\end{pmatrix},\]</span> then <span class="math display">\[D\underline{v}(\underline{x}) \;=\; 
		\begin{pmatrix}
			\frac{\partial v_1}{\partial x} &amp; \frac{\partial v_1}{\partial y} \\
			\frac{\partial v_2}{\partial x} &amp; \frac{\partial v_2}{\partial y}
		\end{pmatrix}
		\;=\; 
		\begin{pmatrix}
			2x&amp; -2y \\
			2y &amp; 2x
		\end{pmatrix}\]</span></p>
<p>The Jacobian is then given by <span class="math display">\[\begin{aligned}
			J(\underline{v}) \;&amp;=\; 
			\begin{vmatrix}
			2x&amp; -2y \\
			2y &amp; 2x
			\end{vmatrix}  \\
			&amp;= \; 4(x^2+y^2) \;\;=\;\; 4 |\underline{x}|^2
		\end{aligned}\]</span></p>
</div>
<div id="eg:identitymap" class="example">
<p> If <span class="math inline">\(\underline{x}\in \mathbb{R}^n\)</span> and <span class="math inline">\(\underline{v}(\underline{x}) \;=\; \underline{x}\)</span> then <span class="math display">\[D\underline{v}(\underline{x}) \;\;=\;\; 
		\begin{pmatrix}
			\frac{\partial x_1}{\partial x_1} &amp; \frac{\partial x_1}{\partial x_2} &amp; \dots &amp; \frac{\partial x_1}{\partial x_n} \\
			\vdots &amp; \vdots &amp; &amp; \vdots \\
			\frac{\partial x_n}{\partial x_1} &amp; \frac{\partial x_n}{\partial x_2} &amp; \dots &amp; \frac{\partial x_n}{\partial x_n}
		\end{pmatrix}
		\;\;=\;\; 
		\begin{pmatrix}
			1&amp;0&amp; \dots &amp;0 \\
			0&amp;1&amp; \dots &amp;0 \\
			\vdots&amp; &amp; \ddots&amp; \vdots \\
			0&amp;0&amp; \dots &amp; 1
		\end{pmatrix}
		\;\;=\;\; \mathbb{I}_n,\]</span> the <span class="math inline">\(n\times n\)</span> identity matrix, and <span class="math display">\[J(\underline{v}) \;\;=\;\; |\mathbb{I}_n| \;\;=\;\; 1\]</span></p>
</div>
</section>
<section id="diffeomorphisms-and-the-inverse-function-theorem" class="level2" data-number="7.2">
<h2 data-number="6.2"><span class="header-section-number">6.2</span> Diffeomorphisms and the inverse function theorem</h2>
<p>We can think of a vector field <span class="math inline">\(\underline{v}(\underline{x})\)</span> as a mapping <span class="math inline">\(\mathbb{R}^n \to \mathbb{R}^n\)</span>, or equivalently as a <u>coordinate transformation</u> on <span class="math inline">\(\mathbb{R}^n\)</span>. If we think of the components of <span class="math inline">\(\underline{h}\)</span> as the coordinates of a point <span class="math inline">\(\underline{x}= \underline{a} +\underline{h}\)</span> relative to an “origin" at <span class="math inline">\(\underline{a}\)</span>, then the components of <span class="math inline">\(\underline{v}(\underline{a}+\underline{h}) - \underline{v}(\underline{a})\)</span> are the transformed coordinates relative to the transformed origin <span class="math inline">\(\underline{v}(\underline{a})\)</span>. Then for differentiable <span class="math inline">\(\underline{v}\)</span> (and small <span class="math inline">\(\underline{h}\)</span>) <span class="math display">\[\begin{aligned}
\underline{v}(\underline{a}+\underline{h}) - \underline{v}(\underline{a}) \;\; &amp;\simeq \;\; ~~D
\underline{v}(\underline{a})\,.\,\underline{h}\\
\text{new coordinates} \;\; &amp;\simeq \;\; \text{matrix}  \; \times \; \text{old coordinates,}\end{aligned}\]</span> which is a <span class="math inline">\(\underline{linear}\)</span> transformation, invertible if the determinant of <span class="math inline">\(D\underline{v}(\underline{a})\)</span> (i.e. the Jacobian) is non-zero.</p>
<p>The <u>inverse function theorem</u> says that this invertibility can be extended beyond the linear behaviour:</p>
<div id="thm:inversefunctiontheorem" class="theorem">
<p> Let <span class="math inline">\(\underline{v}: U \to \mathbb{R}^n\)</span> (with <span class="math inline">\(U\)</span> open in <span class="math inline">\(\mathbb{R}^n\)</span>) be a differentiable vector field with continuous partial derivatives, and let <span class="math inline">\(\underline{a} \in U\)</span>. Then if <span class="math inline">\(J(\underline{v}(\underline{a})) \ne 0\)</span>, <span class="math inline">\(\exists\)</span> an open set <span class="math inline">\(\tilde{U} \subseteq U\)</span> containing <span class="math inline">\(\underline{a}\)</span> such that</p>
<ol>
<li><p><span class="math inline">\(\underline{v}(\tilde{U})\)</span> is open</p></li>
<li><p>The mapping <span class="math inline">\(\underline{v}\)</span> from <span class="math inline">\(\tilde{U}\)</span> to <span class="math inline">\(\underline{v}(\tilde{U})\)</span> has a differentiable inverse - i.e. there exists a differentiable vector field <span class="math inline">\(\underline{w}: \underline{v}(\tilde{U}) \to \mathbb{R}^n\)</span> such that <span class="math inline">\(\underline{w}(\underline{v}(\underline{x})) = \underline{x}\)</span> and <span class="math inline">\(\underline{v}(\underline{w}(\underline{y})) = \underline{y}\)</span></p></li>
</ol>
</div>
<div class="center">
<figure>
<img src="Inverse_function_theorem.png" id="fig:diffeomorphism" style="width:60.0%" alt="" /><figcaption>A diffeomorphism from <span class="math inline">\(\tilde{U}\)</span> to <span class="math inline">\(\tilde{V}\)</span></figcaption>
</figure>
</div>
<div id="def:diffeomorphism" class="definition">
<p>  </p>
<ul>
<li><p>A mapping <span class="math inline">\(\underline{v}: \tilde{U} \to V \subset \mathbb{R}^n\)</span> satisfying (i) and (ii) above is called a <u>diffeomorphism</u> of <span class="math inline">\(\tilde{U}\)</span> onto <span class="math inline">\(\tilde{V}=\underline{v}(\tilde{U})\)</span>, and <span class="math inline">\(\tilde{U}\)</span> and <span class="math inline">\(\tilde{V}\)</span> are said to be <u>diffeomorphic</u>.</p></li>
<li><p>More generally, a mapping <span class="math inline">\(\underline{v}: U \to V\)</span> is called a <u>local diffeomorphism</u> if for every point <span class="math inline">\(\underline{a}\in U\)</span> there is an open set <span class="math inline">\(\tilde{U}\subset U\)</span> containing <span class="math inline">\(\underline{a}\)</span> such that <span class="math inline">\(\underline{v}: \tilde{U} \to \underline{v}(\tilde{U})\)</span> is a diffeomorphism.</p></li>
</ul>
</div>
<p><strong>Remarks</strong> In general, suppose that <span class="math display">\[\begin{aligned}
		\underline{v}&amp;: U \to V \subset \mathbb{R}^n\\
		\underline{w}&amp;: V \to W \subset \mathbb{R}^n
	\end{aligned}\]</span> (with <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> both open in <span class="math inline">\(\mathbb{R}^n\)</span>) are both continuously differentiable vector fields (not necessarily diffeomorphisms).</p>
<div class="center">
<figure>
<img src="UtoVtoW.png" id="fig:compositionofmaps" alt="" /><figcaption>Composition of maps <span class="math inline">\(\underline{v}\)</span> and <span class="math inline">\(\underline{w}\)</span></figcaption>
</figure>
</div>
<p>Then <span class="math inline">\(\underline{w}(\underline{v}(\underline{x}))\)</span> is a mapping <span class="math inline">\(U \to W \subset \mathbb{R}^n\)</span> and its differential can be calculated using the chain rule: <span class="math display">\[\begin{aligned}
		D\underline{w}(\underline{v}(\underline{x})) \;&amp;=\; 
		\begin{pmatrix}
			\frac{\partial w_1(\underline{v}(\underline{x}))}{\partial x_1} &amp; \frac{\partial w_1(\underline{v}(\underline{x}))}{\partial x_2} &amp; \dots &amp; \frac{\partial w_1(\underline{v}(\underline{x}))}{\partial x_n} \\
			\vdots &amp; \vdots &amp; &amp; \vdots \\
			\frac{\partial w_n(\underline{v}(\underline{x}))}{\partial x_1} &amp; \frac{\partial w_n(\underline{v}(\underline{x}))}{\partial x_2} &amp; \dots &amp; \frac{\partial w_n(\underline{v}(\underline{x}))}{\partial x_n}
		\end{pmatrix}\\
		\;&amp;=\; \begin{pmatrix}
			\sum_j \frac{\partial w_1}{\partial v_j} \frac{\partial v_j}{\partial x_1}  &amp; \sum_j \frac{\partial w_1}{\partial v_j} \frac{\partial v_j}{\partial x_2} &amp; \dots &amp; \sum_j \frac{\partial w_1}{\partial v_j} \frac{\partial v_j}{\partial x_n}  \\
			\vdots &amp; \vdots &amp; &amp; \vdots \\
			\sum_j \frac{\partial w_n}{\partial v_j} \frac{\partial v_j}{\partial x_1}  &amp;\sum_j \frac{\partial w_n}{\partial v_j} \frac{\partial v_j}{\partial x_2} &amp; \dots &amp; \sum_j \frac{\partial w_n}{\partial v_j} \frac{\partial v_j}{\partial x_n}
		\end{pmatrix} \\
		&amp;\\
		&amp; \quad \quad\quad \quad\quad \quad\quad \quad\quad \quad\text{using chain rule on each matrix element,} \\
		&amp;\\
		\;&amp;=\; 
		\begin{pmatrix}
			\frac{\partial w_1}{\partial v_1} &amp; \frac{\partial w_1}{\partial v_2} &amp; \dots &amp; \frac{\partial w_1}{\partial v_n} \\
			\vdots &amp; \vdots &amp; &amp; \vdots \\
			\frac{\partial w_n}{\partial v_1} &amp; \frac{\partial w_n}{\partial v_2} &amp; \dots &amp; \frac{\partial w_n}{\partial v_n}
		\end{pmatrix}
		\begin{pmatrix}
			\frac{\partial v_1}{\partial x_1} &amp; \frac{\partial v_1}{\partial x_2} &amp; \dots &amp; \frac{\partial v_1}{\partial x_n} \\
			\vdots &amp; \vdots &amp; &amp; \vdots \\
			\frac{\partial v_n}{\partial x_1} &amp; \frac{\partial v_n}{\partial x_2} &amp; \dots &amp; \frac{\partial v_n}{\partial x_n}
		\end{pmatrix} \\
		\;&amp;=\;   D\underline{w}(\underline{v})  \; D\underline{v}(\underline{x}) \quad \quad\quad \quad\text{i.e. matrix multiplication}
	\end{aligned}\]</span></p>
<p>For the special case when <span class="math inline">\(\underline{v}\)</span> is a local diffeomorphism and <span class="math inline">\(\underline{w}\)</span> is its inverse map, <span class="math display">\[\begin{aligned}
		\underline{w}(\underline{v}(\underline{x})) \;&amp;=\; \underline{x}\\
		\Rightarrow D \underline{w}\; D\underline{v}\;&amp;=\; D \underline{w}(\underline{v}(\underline{x})) \;\;=\;\; D \underline{x}
		(\underline{x}) \;\;=\;\; \mathbb{I}_n,
	\end{aligned}\]</span> using Example <a href="#eg:identitymap" data-reference-type="ref" data-reference="eg:identitymap">[eg:identitymap]</a> above. Likewise <span class="math display">\[\begin{aligned}
		\underline{v}(\underline{w}(\underline{y})) \;&amp;=\; \underline{y}\\
		\Rightarrow D \underline{v}\; D\underline{w}\;&amp;=\; D \underline{v}(\underline{w}(\underline{y})) \;\;=\;\; D \underline{y}
		(\underline{y}) \;\;=\;\; \mathbb{I}_n.
	\end{aligned}\]</span></p>
<p>So <span class="math inline">\(D\underline{v}\)</span> is an invertible matrix, with inverse <span class="math inline">\((D\underline{v})^{-1} \;=\; D\underline{w}\)</span>. Taking determinants, <span class="math display">\[J(\underline{w}) \;\;=\;\; \frac{1}{J(\underline{v})},\]</span> and in particular, <span class="math inline">\(J(\underline{v})\ne 0\)</span>, which was the main condition of the inverse function theorem.</p>
<div id="def:orientations" class="definition">
<p> Such a <span class="math inline">\(\underline{v}\)</span> is called <u>orientation preserving</u> if <span class="math inline">\(J(\underline{v}) &gt;0\)</span>, and <u>orientation reversing</u> if <span class="math inline">\(J(\underline{v}) &lt;0\)</span>.</p>
</div>
<div id="eg:simpledifferentialcontinued" class="example">
<p> Continuing Example <a href="#eg:simpledifferential" data-reference-type="ref" data-reference="eg:simpledifferential">[eg:simpledifferential]</a>, we had <span class="math display">\[\underline{v}(\underline{x}) \;=\; \begin{pmatrix}
		x^2-y^2 \\
		2xy 
		\end{pmatrix}  \quad \quad\Rightarrow \quad \quad J(\underline{v}) \;=\; 4(x^2+y^2).\]</span></p>
<p>So for <span class="math inline">\((x,y)\ne (0,0), J(\underline{v}) &gt; 0\)</span>.</p>
<p>Hence if <span class="math inline">\(U = \mathbb{R}^2 -\{\underline{0}\}\)</span>, <span class="math inline">\(\underline{v}: U \to U\)</span> is an orientation preserving local diffeomorphism. However it is not a global diffeomorphism since <span class="math inline">\(\underline{v}(-\underline{x})=\underline{v}(\underline{x})\)</span> (so no inverse can exist globally). But <span class="math inline">\(\underline{v}\)</span> <u>does</u> map <span class="math inline">\(\{(x,y): x&gt;0\}\)</span> onto <span class="math inline">\(\mathbb{R}^2-\{(x,0),x\le 0 \}\)</span> diffeomorphically.</p>
</div>
<div id="eg:" class="example">
<p> Consider the transformation from polar coordinates <span class="math inline">\((r,\theta)\)</span> back to cartesians <span class="math inline">\((x,y)\)</span>. We have <span class="math display">\[\underline{v}(r,\theta) \;\;=\;\; 
			\begin{pmatrix}
				x(r,\theta) \\
				y(r,\theta) 
				\end{pmatrix}\;\;=\;\;
				\begin{pmatrix}
				r \cos \theta \\
				r \sin \theta
			\end{pmatrix}\]</span></p>
<p><u>Differential</u>: <span class="math display">\[D\underline{v}\;\;=\;\; \begin{pmatrix}
			\frac{\partial x}{\partial r} &amp; \frac{\partial x}{\partial \theta} \\
			\frac{\partial y}{\partial r} &amp; \frac{\partial y}{\partial \theta}
		\end{pmatrix}
		\;\;=\;\;
		\begin{pmatrix}
			\cos \theta &amp; -r \sin \theta \\
			\sin \theta &amp; r \cos \theta
		\end{pmatrix}\]</span></p>
<p><u>Jacobian</u>: <span class="math display">\[\begin{aligned}
			J(\underline{v}(r,\theta)) \;&amp;=\; 
			\begin{vmatrix}
			\frac{\partial x}{\partial r} &amp; \frac{\partial x}{\partial \theta} \\
			\frac{\partial y}{\partial r} &amp; \frac{\partial y}{\partial \theta} 
			\end{vmatrix} \;\;=\;\;
			\begin{vmatrix}
			\cos \theta &amp; -r \sin \theta \\
			\sin \theta &amp; r \cos \theta 
			\end{vmatrix}  \\\
			\;&amp;=\; r \cos^2 \theta + r \sin^2 \theta \;\;=\;\; r
		\end{aligned}\]</span></p>
<p>For <span class="math inline">\(r&gt;0\)</span>, <span class="math inline">\(J(\underline{v})&gt;0\)</span>, and the transformation is therefore orientation preserving.</p>
<p>The inverse mapping is <span class="math display">\[\underline{w}(x,y) \;\;=\;\; \begin{pmatrix}
			r(x,y) \\ \theta(x,y) 
		\end{pmatrix} \;\;=\;\; 
		\begin{pmatrix}
			\sqrt{x^2+y^2} \\ \tan^{-1} \left(\frac{y}{x}\right)
		\end{pmatrix}\]</span></p>
<p><u>Exercise</u>: check this!</p>
</div>
</section>
</section>
<section id="volume-line-and-surface-integrals" class="level1" data-number="8">
<h1 data-number="7"><span class="header-section-number">7</span> Volume, line and surface integrals</h1>
<section id="double-integrals-and-fubinis-theorem" class="level2" data-number="8.1">
<h2 data-number="7.1"><span class="header-section-number">7.1</span> Double integrals and Fubini’s theorem</h2>
<p>We’ll start with the familiar case of one-dimensional integrals. Recall the single integral computes the area under a curve, as illustrated in figure <a href="#fig:1D" data-reference-type="ref" data-reference="fig:1D">36</a>.</p>
<div class="center">
<figure>
<img src="1D_disc.jpg" id="fig:1D" style="width:50.0%" alt="" /><figcaption> Graph showing a section of the (red) curve given by <span class="math inline">\(y=h(x)\)</span>, with the discretised area under the curve given by the sum of the black rectangles of width <span class="math inline">\(\Delta x_i\)</span>.</figcaption>
</figure>
</div>
<p>As the widths of the rectangles tend to zero, so the sum of their areas tends to the integral of the curve over the desired range, defining the integral via a Riemann sum: <span class="math display">\[\int_a^b h(x)\,dx =\lim_{n\to\infty} \sum_{i=0}^{n-1} h(x_i^*)\Delta
x_i\,,\]</span> where the interval <span class="math inline">\([a,b]\)</span> is partitioned as <span class="math inline">\(a=x_0&lt;x_1&lt;...&lt;x_i&lt;...&lt;x_n=b\)</span> , <span class="math inline">\(\Delta x_i = x_{i+1}-x_i\)</span> , and the choice of <span class="math inline">\(x_i^*\in[x_i,x_{i+1}]\)</span> is arbitrary as long as the limit exists (in the figure they were all taken at the left-hand ends).</p>
<p>In general the <span class="math inline">\(\Delta x_i\)</span>’s can be different sizes, but if they are, the limit <span class="math inline">\(n\to \infty\)</span> must include the extra requirement that <span class="math inline">\(\sup (\Delta x_i)\to 0\)</span>. From here on we will assume equally-spaced partitions, and mostly assume that the functions we deal with are such that the relevant limits all exist.</p>
</section>
<section id="sub:fubini" class="level2 unnumbered">
<h2 class="unnumbered">Double integrals</h2>
<p>As for the single integral, the double integral, written as <span class="math inline">\(\int_R f(x,y)\,dA\)</span> (or sometimes <span class="math inline">\(\iint_R f(x,y)\,dA\)</span>), can be used to calculate the volume under the surface defined by the equation <span class="math inline">\(z=f(x,y)\)</span> where <span class="math inline">\(f(x,y)\)</span> is continuous over <span class="math inline">\(R\subset\mathbb{R}^2\)</span>, the region over which we wish to perform the integration. This is illustrated in figure <a href="#fig:surf" data-reference-type="ref" data-reference="fig:surf">37</a>.</p>
<div class="center">
<figure>
<img src="surf_proj.jpg" id="fig:surf" style="width:60.0%" alt="" /><figcaption> The section of the surface <span class="math inline">\(z=f(x,y)\)</span> lying above the region <span class="math inline">\(R=\{\,(x,y)\in\mathbb{R}^2\,|\,x\in[1,4]\)</span>, <span class="math inline">\(y\in[1,4]\,\}\)</span> .</figcaption>
</figure>
</div>
<p>This double integral can be defined in a similar fashion to the single integral using a Riemann sum. We start by splitting the region of integration <span class="math inline">\(R\)</span> into <span class="math inline">\(N\)</span> smaller areas <span class="math inline">\(\Delta A_k\)</span> (see figure <a href="#fig:disc_surf" data-reference-type="ref" data-reference="fig:disc_surf">38</a>, where the areas <span class="math inline">\(\Delta A_k\)</span> are chosen to be rectangles).</p>
<div class="center">
<figure>
<img src="disc_surf.jpg" id="fig:disc_surf" style="width:60.0%" alt="" /><figcaption> A sketch of the discretised surface <span class="math inline">\(z=f(x,y)\)</span>. The double integral can be approximated by the sum of the volumes of all the small cuboids; if we take the limit of infinitely many cuboids, the sum tends to the integral.</figcaption>
</figure>
</div>
<p>As for single integrals, where we add the areas of the small rectangles, we can add up the smaller volumes (prisms, with volumes <span class="math inline">\(\textrm{(area of base $=\Delta A_k$)} \times \textrm{(height)}\)</span>) to give an approximation to the double integral. As we increase the number of prisms the approximation becomes more and more accurate, and the integral can be defined as the limit of the sum: <span class="math display">\[\int_R f(x,y)\,dA = \lim_{N\to\infty} \sum_{k=1}^{N} 
f(x_k^*,y_k^*)\,\Delta A_k \,.\]</span> Here <span class="math inline">\((x_k^*,y_k^*)\)</span> is in the base of the <span class="math inline">\(k^{\rm th}\)</span> prism. If we choose the small areas to be rectangles on a regular grid, then <span class="math inline">\(\Delta A_k =
\Delta x_i\Delta y_j\)</span> with <span class="math inline">\(\Delta x_i = x_{i+1}-x_{i}\)</span>, <span class="math inline">\(\Delta y_j =
y_{j+1}-y_{j}\)</span> and <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are partitioned in a similar way to that used before: <span class="math inline">\(x_0&lt; x_1&lt;...&lt;x_i&lt;...&lt;x_n\)</span>, <span class="math inline">\(y_0&lt; y_1&lt;...&lt;y_j&lt;...&lt;y_m\)</span>. We then obtain <span class="math display">\[\int_R f(x,y)\,dA = \lim_{n,m\to\infty}
\sum_{i=0}^{n-1}\sum_{j=0}^{m-1}
f(x_i^*,y_j^*)\Delta x_i\Delta y_j \,,\]</span> where <span class="math inline">\(x_i^*\)</span> and <span class="math inline">\(y_j^*\)</span> are the coordinates of the points at which the function is evaluated and are in the ranges <span class="math inline">\(x_i^*\in[x_i,x_{i+1}]\)</span>, <span class="math inline">\(y_j^*\in[y_j,y_{j+1}]\)</span>. These points are often taken to be the mid-points. If we take the limit <span class="math inline">\(m\to\infty\)</span> first, and only then take <span class="math inline">\(n\to\infty\)</span>, we get: <span class="math display">\[\begin{aligned}
\lim_{n,m\to\infty} \sum_{i=0}^{n-1}\sum_{j=0}^{m-1}
f(x_i^*,y_j^*)\Delta y_j\Delta
x_i&amp;=\lim_{n\to\infty}\sum_{i=0}^{n-1}\left(\int\limits_y
f(x_i^*,y)dy \right) \Delta
x_i\\[3pt]
&amp;=\int\limits_x\left(\int\limits_y f(x,y)\,dy\right) dx\,.\end{aligned}\]</span></p>
<p>Let’s see an example of calculating a double integral:</p>
<div id="eg:easy" class="example">
<p> Integrate the function <span class="math inline">\(f(x,y)=6xy^2\)</span> over <span class="math inline">\(R=[2,4]\times[1,2]\)</span>. <span class="math display">\[\begin{aligned}
\int_2^4\int_1^2 6xy^2\,dy\,dx&amp;=\int_2^4\left[2xy^3\right]_1^2dx\\
&amp;=\int_2^4(16x-2x)\,dx\\
&amp;=\left[7x^2\right]_2^4 = 84\,.\end{aligned}\]</span> If we’d taken <span class="math inline">\(n\to\infty\)</span> first instead, we would have ended up with the opposite order of integrations, but the final result is unchanged: <span class="math display">\[\begin{aligned}
\int_1^2\int_2^4 6xy^2dx\,dy
&amp;=\int_1^2\left[3x^2y^2\right]_2^4 dy\\[2pt]
&amp;=\int_1^2 36y^2 dy\\[2pt]
&amp;=\left[12y^3\right]_1^2
=84\,.\end{aligned}\]</span> As we can see, we obtain the same final result as before.</p>
</div>
<p>Things become a little more complicated if the region of integration, let’s call it <span class="math inline">\(A\)</span>, is not a rectangle. Suppose that it is defined to be the set of points in the <span class="math inline">\(x,y\)</span> plane lying between two curves <span class="math inline">\(y_0(x)\)</span> and <span class="math inline">\(y_1(x)\)</span> with <span class="math inline">\(a\le x\le b\,\)</span>: <span class="math display">\[A=\{(x,y)\in\mathbb{R}^2 \,|~ a\le x\le b\,,~y_0(x)\le y\le
y_1(x)\}\,.\]</span> (To visualise this, it might help to draw a picture!) Then taking <span class="math inline">\(m\to\infty\)</span> first: <span class="math display">\[\int_Af(x,y)\,dx\,dy=\int_a^b\int_{y_0(x)}^{y_1(x)}f(x,y)\,dy\,dx\,.\]</span> Instead we could take <span class="math inline">\(n\to\infty\)</span> first, taking care to rearrange the limits (see example <a href="#eg:harder" data-reference-type="ref" data-reference="eg:harder">[eg:harder]</a> below for this in action). Again, the final answer will be the same.</p>
<p><strong>Fubini’s theorem</strong> sums this all up.</p>
<div id="thm:fubini" class="theorem">
<p> If the function <span class="math inline">\(f(x,y)\)</span> is continuous over a bounded and closed (i.e. compact) region of integration <span class="math inline">\(A\)</span>, then the double integral over that region can be written as an <strong>iterated integral</strong>, with the integrals in either order: <span class="math display">\[\boxed{\int_A f(x,y)\,dA = \int_y \int_x f(x,y)\,dx\,dy = \int_x \int_y
	f(x,y)\,dy\,dx\,.}\]</span></p>
</div>
<p>In order to calculate an integral in this form we take the inner integration first while treating the outer variable as a constant, and then do the outer integration. In this way the problem of two- (or more!) dimensional integration has been reduced to doing a bunch of one-dimensional integrals, one after the other.</p>
<p><strong>Important note:</strong> If the region and/or the function is unbounded (the latter option arising, for example, if <span class="math inline">\(A\)</span> is open and <span class="math inline">\(f(x,y)\)</span>, while continuous on <span class="math inline">\(A\)</span>, tends to infinity somewhere on its boundary), then Fubini’s theorem still holds <strong>provided that the double integral is absolutely convergent</strong>, meaning that the integral of <span class="math inline">\(|f(x,y)|\)</span> over <span class="math inline">\(A\)</span> must be finite. If this doesn’t hold then the result might not be true, with the iterated integrals in the two orders giving different answers – see questions 61, 63 and 64 from the problem sheets for some examples.</p>
<div id="eg:harder" class="example">
<p> Consider integrating <span class="math inline">\(f(x,y)=4xy-y^3\)</span> over the region drawn in figure <a href="#fig:area1" data-reference-type="ref" data-reference="fig:area1">39</a> below, where the region we wish to integrate over is the area between two curves.</p>
<figure>
<img src="Figs/area1.jpg" id="fig:area1" alt="" /><figcaption> Graph of the region of integration, lying between the two curves.</figcaption>
</figure>
<p>From the graph we can see that <span class="math inline">\(0\le x\le 1\)</span> and <span class="math inline">\(x^3\le y\le
\sqrt{x}\)</span>, so in the notations of the previous page we should take <span class="math inline">\(a=0\)</span>, <span class="math inline">\(b=1\)</span>, <span class="math inline">\(y_0(x)=x^3\)</span>, and <span class="math inline">\(y_1(x)=\sqrt{x}\)</span>. The integral of <span class="math inline">\(f(x,y)=4xy-y^3\)</span> over this region can be calculated as: <span class="math display">\[\begin{aligned}
\int_0^1\int_{x^3}^{\sqrt{x}}(4xy-y^3)\,dy\,dx
&amp;=\int_0^1\left[2xy^2-\frac{y^4}{4})\right]_{x^3}^{\sqrt{x}}dx\\[2pt]
&amp;=\int_0^1 (\frac{7}{4}x^2-2x^7+\frac{x^{12}}{4})\,dx\\[2pt]
&amp;=\left[\frac{7x^{3}}{12}-\frac{x^8}{4}+\frac{x^{13}}{52}\right]_0^1
=\frac{55}{156}\,.\end{aligned}\]</span> If we want to change the order of integration, we must take care over the limits, as they are functions. To integrate with respect to <span class="math inline">\(x\)</span> first so we must calculate the limits of the inner integral in the form <span class="math inline">\(x=g(y)\)</span>; on inspection of the graph, figure <a href="#fig:area1" data-reference-type="ref" data-reference="fig:area1">39</a>, we can see that the lower limit will be given by the line <span class="math inline">\(y=\sqrt{x}\)</span> which must be re-written as <span class="math inline">\(x=y^2\)</span>, similarly the upper limit will be <span class="math inline">\(x=y^{1/3}\)</span>. The outer integral, with respect to <span class="math inline">\(y\)</span>, has lower and upper limits given by <span class="math inline">\(y=0\)</span> and <span class="math inline">\(y=1\)</span> respectively. Now we are ready to integrate! <span class="math display">\[\begin{aligned}
\int_0^1\int_{y^2}^{y^{1/3}}(4xy-y^3)\,dx\,dy
&amp;=\int_0^1\left[2x^2y-y^3x\right]_{y^2}^{y^{1/3}}dy\\[2pt]
&amp;=\int_0^1(2y^{5/3}-y^{10/3}-y^5)dy\\[2pt]
&amp;=\left[\frac{3y^{8/3}}{4}-\frac{3y^{13/3}}{13}-\frac{y^6}{6}\right]_0^1
=\frac{55}{156}\,.\end{aligned}\]</span></p>
</div>
<p>In the example just treated, changing the order of integration didn’t make much difference to the calculation, but sometimes it can be crucial:</p>
<div class="example">
<p>Evaluate the integral of the function <span class="math inline">\(f(x,y)= e^{-x^2}\)</span> over the triangle <span class="math inline">\(A\)</span> shown in figure <a href="#fig:triangle" data-reference-type="ref" data-reference="fig:triangle">40</a>.</p>
<figure>
<img src="Figs/triangle.jpg" id="fig:triangle" alt="" /><figcaption> Graph of the region of integration <span class="math inline">\(A\)</span>, a triangle with base and height <span class="math inline">\(=1\)</span>.</figcaption>
</figure>
<p>Attempting to take the <span class="math inline">\(x\)</span> integral first, we have <span class="math display">\[I=\int_A e^{-x^2}dA\\
= \int_0^1\int_y^1 e^{-x^2}dx\,dy\,,\]</span> and then we seem to be stuck: the integral w.r.t. <span class="math inline">\(x\)</span> has no elementary solution, and can only be given in terms of the error function. Thankfully all is not lost: using Fubini we can change the order of integration and obtain the answer:<br />
<span class="math display">\[\begin{aligned}
I&amp;=\int_A e^{-x^2}dA\\[2pt]
&amp;= \int_0^1\int_0^x e^{-x^2}dy\,dx\\[2pt]
&amp;=\int_0^1 xe^{-x^2}dx\\[2pt]
&amp;= \left[-{\textstyle\frac{1}{2}}\,e^{-x^2}\right]_0^1 
=  {\textstyle\frac{1}{2}}\,(1-e^{-1})\,.\end{aligned}\]</span></p>
</div>
<p><em>Note:</em> to calculate an area in the plane, for example between two curves, simply set <span class="math inline">\(f(x,y)=1\)</span>: <span class="math display">\[\boxed{\int_R 1\,dA = \int_R dA = \textrm{Area of } R}\]</span> an integral which can be evaluated in whichever order is easiest.</p>
<p>Sometimes it is better to use a non-rectangular grid of elementary areas <span class="math inline">\(\Delta A_k\)</span>, but the idea is the same.</p>
<div id="circeg" class="example">
<p> Integrate <span class="math inline">\(f(x,y)=x^2+y^2\)</span> over the unit circle centred on the origin.</p>
<p>Using polar coordinates, the elementary areas are <span class="math inline">\(\Delta A=\Delta
r_i\times(r_j\Delta\theta_j)\)</span>, and so <span class="math display">\[\begin{aligned}
\int\!\int_A(x^2+y^2)\,dA 
&amp;=\int_0^{2\pi}\int_0^1r^2\,r\,dr\,d\theta\\
&amp;=\int_0^{2\pi}\int_0^1r^3\,dr\,d\theta\\
&amp;=\int_0^{2\pi}\left[{\textstyle\frac{1}{4}}r^4\right]^1_0\,d\theta\\
&amp;=\int_0^{2\pi}{\textstyle\frac{1}{4}}\,d\theta\,=\,\pi/2\,.\end{aligned}\]</span> There will be more on the systematics of this later in the term.</p>
</div>
</section>
<section id="sub:volumeintegrals" class="level2" data-number="8.2">
<h2 data-number="7.2"><span class="header-section-number">7.2</span> Volume integrals</h2>
<p><strong>Volume integrals</strong> are the obvious extension to all of this, and Fubini’s theorem applies to them too (and also to four, five and so on dimensional integrals, though we’ll stop at three). To begin, let’s divide up our volume and define the integral as the limit of a Riemann sum.</p>
<div class="center">
<figure>
<img src="vol.png" id="fig:vol" style="width:60.0%" alt="" /><figcaption> Diagram showing a volume to be integrated over, <span class="math inline">\(V\)</span>, with its bounding surface, <span class="math inline">\(S\)</span>. <span class="math inline">\(\Delta V_i\)</span> is a volume element in the partition, situated at <span class="math inline">\(\underline{x}_i\)</span>. </figcaption>
</figure>
</div>
<p>Let <span class="math inline">\(f(\underline{x})\)</span> be a continuous scalar field defined on a volume <span class="math inline">\(V\in\mathbb{R}^3\)</span> enclosed by the surface <span class="math inline">\(S\)</span>. We define the volume integral of <span class="math inline">\(f\)</span> over <span class="math inline">\(V\)</span> (<span class="math inline">\(I = \int_V f(\underline{x})\,dV\)</span>) as the limit of a Riemann sum associated with a partition of <span class="math inline">\(V\)</span> into many, <span class="math inline">\(N\)</span>, small volumes <span class="math inline">\(\Delta V_i\)</span>, as in figure <a href="#fig:vol" data-reference-type="ref" data-reference="fig:vol">41</a>, as the number of these small volumes tends to infinity and their sizes all tend to zero: <span class="math display">\[I = \int_V f(\underline{x})\,dV = 
\lim\limits_{N\to \infty}\sum\limits_{i=1}^{N} f(\underline{x}_i)\Delta
V_i\,.\]</span></p>
<p>Some notes:</p>
<ul>
<li><p>The limit should be independent of the partition taken, as we saw with double integrals.</p></li>
<li><p>Geometrically the volume (triple) integral is a 4-dimensional ‘hypervolume’ lying ‘below’ the graph of <span class="math inline">\(f(x,y,z)\)</span> in <span class="math inline">\(\mathbb{R}^4\)</span>. This is a natural extension of single integrals giving the area under the curve and double integrals giving the (3-D) volume under the surface, but it is hard to visualise!</p></li>
<li><p>Physically, if <span class="math inline">\(f(\underline{x})\)</span> is the density of some quantity (e.g. number of flying ants per unit volume), then <span class="math inline">\(I = \int_V f(\underline{x})\,dV\)</span> is the amount of ‘stuff’ (total number of flying ants) inside all of <span class="math inline">\(V\)</span>.</p></li>
<li><p>As in the double integral case, we can calculate the volume inside a surface by setting <span class="math inline">\(f(x,y,z)=1\)</span>: <span class="math display">\[\boxed{\,\int_V 1\,dV = \int_V dV = \textrm{Volume inside } S.}\]</span></p></li>
</ul>
<p>Now consider a simple shape such as the sphere shown in figure <a href="#fig:ball" data-reference-type="ref" data-reference="fig:ball">42</a>, which can be split into an upper and lower surface <span class="math inline">\(z=g_U(x,y)\)</span> and <span class="math inline">\(z=g_L(x,y)\)</span> respectively. (Note that the sphere does not need to be centred on the origin for this to be possible.)</p>
<div class="center">
<figure>
<img src="ball.png" id="fig:ball" style="width:60.0%" alt="" /><figcaption> Diagram showing the volume to be integrated over, <span class="math inline">\(V\)</span> with its bounding surface, <span class="math inline">\(S\)</span>. The circle on the <span class="math inline">\(x,y\)</span> plane is the projection of the volume onto the plane, and it is labelled <span class="math inline">\(A\)</span>. Simple shapes like the sphere can be split into an upper surface <span class="math inline">\(z=g_U(x,y)\)</span> and a lower surface <span class="math inline">\(z=g_L(x,y)\)</span>.</figcaption>
</figure>
</div>
<p>If we consider in this case a simple partition which is parallel to the coordinate planes then <span class="math display">\[\Delta V_i = \Delta x_r\Delta y_s\Delta z_t\,,\]</span> where <span class="math inline">\(\Delta x_r = x_{r+1}-x_r\)</span>, <span class="math inline">\(\Delta y_s = y_{s+1}-y_s\)</span>, <span class="math inline">\(\Delta z_t =
z_{t+1}-z_t\)</span>.</p>
<p>Taking the limits of the Riemann sum, <span class="math display">\[\begin{aligned}
I
&amp;=\lim\limits_{N\to \infty}\sum\limits_{i=1}^{N} f(\underline{x}_i)\Delta V_i\\
&amp;= \lim\limits_{N\to \infty}\sum\limits_{r,s,t} f(x_r^*, y_s^*, z_t^*)\Delta x_r\Delta y_s\Delta z_t\\
&amp;= \lim\limits_{\Delta x_r, \Delta y_s\to 0}\sum\limits_{r,s}\left(\lim\limits_{\Delta z_t\to 0}\sum_{t} f(x_r^*, y_s^*, z_t^*)\Delta z_t\right)\Delta x_r\Delta y_s\quad \textrm{take $z$ limit first}\\
&amp;= \lim\limits_{\Delta x_r, \Delta y_s\to 0}\sum\limits_{r,s}\left(\int\limits_{z=g_L(x_r^*, y_s^*)}^{z=g_U(x_r^*, y_s^*)} f(x_r^*, y_s^*, z)dz\right)\Delta x_r\Delta y_s\quad \textrm{and now $x$, $y$ limits}\\
&amp;=\int\limits_A\left(\int\limits_{z=g_L(x, y)}^{z=g_U(x, y)} f(x, y,
z)dz\right)dx\,dy\,,\end{aligned}\]</span> where <span class="math inline">\(x^*_r\in[x_r, x_{r+1}]\)</span>, <span class="math inline">\(y^*_s\in[y_s, y_{s+1}]\)</span>, <span class="math inline">\(z^*_t\in[z_t, z_{t+1}]\)</span>. We may also disentangle the area integral to write <span class="math inline">\(I\)</span> as a three-times iterated integral: <span class="math display">\[I \,=\, \int_x\int_y\int_z f(\underline{x})\,dz\,dy\,dx\,.\]</span> By Fubini’s theorem, we can change the order of integration as long as <span class="math inline">\(f(\underline{x})\)</span> is continuous over the closed volume, as in the following example.</p>
<div id="yurt" class="example">
<p> Find the mass <span class="math inline">\(M\)</span> of air inside a hemispherical volume of radius <span class="math inline">\(r\)</span> centred on the origin, when the air density varies with height as <span class="math inline">\(\rho=cz+\rho_0\)</span> (and <span class="math inline">\(c\)</span> and <span class="math inline">\(\rho_0\)</span> are constants).</p>
<p>Doing the integrals in the order <span class="math inline">\(x\)</span> first, then <span class="math inline">\(y\)</span>, then <span class="math inline">\(z\)</span>, we have <span class="math display">\[M
=\int_0^r\int_{-r_z}^{r_z}\int_{-\sqrt{r_z^2-y^2}}^{\sqrt{r_z^2-y^2}}
\rho(z)\,dx\,dy\,dz\]</span> where <span class="math inline">\(r_z=\sqrt{r^2-z^2}\)</span>. Noting that <span class="math inline">\(\rho(z)\)</span> can be taken outside the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> integrals, <span class="math display">\[M = \int_0^r\rho(z)\left(
\int_{-r_z}^{r_z}\int_{-\sqrt{r_z^2-y^2}}^{\sqrt{r_z^2-y^2}}
\,dx\,dy\right)\,dz\,.\]</span> Now the quantity in round brackets is just the area <span class="math inline">\(A(z)\)</span> of the horizontal ‘slice’ of the hemisphere at height <span class="math inline">\(z\)</span>, so it’s equal to <span class="math inline">\(\pi r_z^2\)</span>, and <span class="math display">\[\begin{aligned}
M
&amp;= \pi\int_0^r(cz+\rho_0)r_z^2\,dz\\
&amp;= \pi\int_0^r(cz+\rho_0)(r^2-z^2)\,dz\\
&amp;= \pi\int_0^rcr^2z+\rho_0r^2-cz^3-\rho_0z^2\,dz\\[3pt]
&amp;=
\pi\left[{\textstyle\frac{1}{2}}cr^2z^2+\rho_0r^2z-{\textstyle\frac{1}{4}}cz^4-{\textstyle\frac{1}{3}}\rho_0z^3
\right]_0^r\\[4pt]
&amp;=\pi({\textstyle\frac{1}{4}}cr^4+{\textstyle\frac{2}{3}}\rho_0r^3)\,.\end{aligned}\]</span></p>
</div>
<div id="spherevol" class="example">
<p> Use the volume integral to calculate the volume of a sphere of radius <span class="math inline">\(a\)</span> (which we know to be <span class="math inline">\(V = \frac{4}{3}\pi a^3\)</span>).</p>
<p>We can calculate this volume as <span class="math inline">\(\int_V f\,dV\)</span>, where <span class="math inline">\(V\)</span> is the set of points <span class="math inline">\(\{(x,y,z)\in\mathbb{R}^3: x^2+y^2+z^2 \le a^2\}\)</span> and <span class="math inline">\(f=1\)</span>. We have: <span class="math display">\[\begin{aligned}
\int_V dV
&amp;= \int_A\left(\int_{z=g_L(x, y)}^{z=g_U(x, y)}
dz\right)dx\,dy\\
&amp;=\int_A\left(\int_{z=-\sqrt{a^2-x^2-y^2}}^{z=\sqrt{a^2-x^2-y^2}}
dz\right)dx\,dy\\
&amp;=\int_A 2\sqrt{a^2-x^2-y^2}dx\,dy\\
&amp;=
\int_{-a}^a\int_{-\sqrt{a^2-y^2}}^{\sqrt{a^2-y^2}}2\sqrt{a^2-x^2-y^2}\,dx\,dy\\
&amp;\textrm{Use a substitution to complete the x-integration:
$x=\sqrt{a^2-y^2}\cos\theta$, $dx=-\sqrt{a^2-y^2}\sin\theta\,d\theta$}\\
&amp;=\int_{-a}^a \left(\int_{\pi}^{2\pi}2(a^2-y^2)\sin^2\theta\,d\theta\right)dy\\
&amp;=\int_{-a}^a (a^2-y^2)\pi\,dy
\,=\,\pi(2a^3- \frac{2a^3}{3})\,=\,\frac{4}{3}\pi a^3\textrm{, as expected.}\end{aligned}\]</span></p>
</div>
<p>Later, we’ll rederive this result slightly less painfully, via a change of variables.</p>
</section>
<section id="sec:surf_line" class="level2" data-number="8.3">
<h2 data-number="7.3"><span class="header-section-number">7.3</span> Line integrals</h2>
<p>So far the integrals have been over ‘flat’ regions in one, two or three dimensions, but for applications it is important to generalise to curved lines and surfaces.</p>
<p>A <em>regular arc</em> <span class="math inline">\(C\subset \mathbb{R}^n\)</span> is a parametrised curve <span class="math inline">\(\underline{x}(t)\)</span> for which the Cartesian components <span class="math inline">\(x_a(t)\)</span>, <span class="math inline">\(a=1\dots n\)</span> are continuous with continuous first derivatives, where <span class="math inline">\(t\)</span> lies in some (maybe infinite) interval <span class="math inline">\([\alpha,\beta]\)</span>. A <em>regular curve</em> consists of a finite number of regular arcs joined end to end.</p>
<p>If <span class="math inline">\(\underline{v}(\underline{x})\)</span> is a vector field in <span class="math inline">\(\mathbb{R}^n\)</span>, then its restriction to a regular arc, <span class="math inline">\(\underline{v}(\underline{x}(t))\)</span>, is a vector function of <span class="math inline">\(t\)</span> and its scalar product with the tangent <span class="math inline">\(d\underline{x}(t)/dt\)</span> to the arc is a scalar function of <span class="math inline">\(t\)</span>. We can therefore integrate it along the arc to get a real number, called the <em>line integral</em> of <span class="math inline">\(\underline{v}\)</span> along the arc <span class="math inline">\(C\)</span>: <span class="math inline">\(t\mapsto \underline{x}(t),~t=\alpha\dots\beta\)</span>, denoted <span class="math inline">\(\int_C\underline{v}\cdot d\underline{x}\)</span> : <span class="math display">\[\begin{equation} \boxed{
\int_C\underline{v}\cdot d\underline{x} = 
\int_{\alpha}^{\beta}\underline{v}(\underline{x}(t))\cdot
\frac{d\underline{x}(t)}{dt}\,dt\,.
}
\label{lineintdef} \end{equation}\]</span> An important fact is that, as suggested by the notation, the line integral does not depend on the choice of parametrisation of <span class="math inline">\(C\)</span>. This follows from the chain rule, but it is instructive to check it for yourself in some examples.</p>
<p>If <span class="math inline">\(C\)</span> is a regular curve made up of one or more regular arcs, then the line integral of <span class="math inline">\(\underline{v}\)</span> along <span class="math inline">\(C\)</span> is the sum of the line integrals over these arcs; it is also denoted as <span class="math inline">\(\int_C\underline{v}\cdot
d\underline{x}\)</span> .</p>
<p>Finally, if the integral is performed over a <em>closed</em> regular curve then it is often written as <span class="math inline">\(\oint_C\underline{v}\cdot d\underline{x}\)</span> .</p>
<p>Some variants:</p>
<div class="center">
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Interpretation</th>
<th style="text-align: center;">Form</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Length of curve, <span class="math inline">\(C\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\int_C ds = \int_a^b
||\frac{d\underline{x}(t)}{dt}||\,dt\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Mass, if <span class="math inline">\(f\)</span> is a density function</td>
<td style="text-align: center;"><span class="math inline">\(\int_C fds =
\int_a^bf(\underline{x}(t))\,||\frac{d\underline{x}(t)}{dt}||\,dt\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Work done, if <span class="math inline">\(\underline{F}\)</span> is a force</td>
<td style="text-align: center;"><span class="math inline">\(\int_C\underline{F}\cdot d\underline{x}\)</span></td>
</tr>
</tbody>
</table>
</div>
<p>Here is a quick list of useful parametrisations (with a positive orientation i.e. anti-clockwise) for some common curves in two dimensions:</p>
<div class="center">
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Curve</th>
<th style="text-align: center;">Parametric Equations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Ellipse: <span class="math inline">\(\frac{x^2}{a^2}+\frac{y^2}{b^2}=1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x(t)=a\cos(t)\)</span>, <span class="math inline">\(y(t)=b\sin(t)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(y=f(x)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x(t)=t\)</span>, <span class="math inline">\(y(t)=f(t)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(x=g(y)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x(t)=g(t)\)</span>, <span class="math inline">\(y(t)=t\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Straight line segment from <span class="math inline">\((x_0,y_0)\)</span> to <span class="math inline">\((x_1,y_1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x(t)=(1-t)x_0+tx_1\)</span>, <span class="math inline">\(y(t)=(1-t)y_0+ty_1\)</span></td>
</tr>
</tbody>
</table>
<p><span id="tab:par" label="tab:par">[tab:par]</span></p>
</div>
<div class="example">
<p>Let <span class="math inline">\(\underline{u}(\underline{x})\)</span> be the vector field <span class="math inline">\((x^2z,xyz,x)\)</span> and <span class="math inline">\(C\)</span> be the circle parallel to the <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> plane with centre <span class="math inline">\(\underline{a}=(a_1,a_2,a_3)\)</span> and radius <span class="math inline">\(r\)</span>, given by <span class="math display">\[\underline{x}(t)=\underline{a}+r\cos t\,\underline{e}_1+r\,\sin t\,\underline{e}_2\,,\quad
0\le t\le 2\pi\,.\]</span> Evaluate <span class="math inline">\(\oint_C\underline{u}\cdot d\underline{x}\)</span>.</p>
<p>Calculating, we have <span class="math display">\[\frac{d\underline{x}}{dt}=-r\,\sin t\,\underline{e}_1+r\,\cos t\,\underline{e}_2 =
(-r\,\sin t,r\,\cos t,0)\]</span> and <span class="math display">\[\underline{x}(t)=(a_1+r\,\cos t,a_2+r\,\sin t,a_3)\]</span> so <span class="math display">\[\underline{u}(\underline{x}(t))=
((a_1+r\,\cos t)^2a_3,(a_1+r\,\cos t)(a_2+r\,\sin t)a_3,a_1+r\,\cos t)\]</span> and <span class="math display">\[\underline{u}(\underline{x}(t))\cdot\frac{d\underline{x}}{dt}=
-r\,\sin t(a_1+r\,\cos t)^2a_3 +r\,\cos t(a_1+r\,\cos t)(a_2+r\,\sin
t)a_3\,.\]</span> Hence <span class="math display">\[\begin{aligned}
\oint_C\underline{u}\cdot d\underline{x}
&amp;=
\int_0^{2\pi}
\left(-r\,\sin t(a_1+r\,\cos t)^2a_3 +r\,\cos t(a_1+r\,\cos t)(a_2+r\,\sin 
t)a_3\right)dt\\[2pt]
&amp;=\dots\\[2pt]
&amp;= \pi r^2 a_2a_3\,.\end{aligned}\]</span> Note: if we had instead parametrized <span class="math inline">\(C\)</span> as <span class="math display">\[\underline{x}(t)=\underline{a}+r\cos 2t\,\underline{e}_1+r\,\sin 2t\,\underline{e}_2\,,\quad
0\le t\le \pi\]</span> the steps of the calculation would have changed slightly, but the final answer is unchanged – it’s worthwhile to check this for yourself.</p>
</div>
<div class="example">
<p>Consider a circle of radius 1, centred at the origin. Let <span class="math inline">\(C\)</span> be the arc of this circle which lies in the first quadrant, taken in an anticlockwise direction. Find the value of the line integral of <span class="math inline">\(\underline{F}(x,y) = (-y, -xy)\)</span> along <span class="math inline">\(C\)</span>.</p>
<p>First we must parametrise the path, <span class="math inline">\(C\)</span>: <span class="math inline">\(\underline{x}(t) = (\cos(t),
\sin(t))\)</span>, <span class="math inline">\(0\le t\le \pi/2\)</span> (the restriction on the range of <span class="math inline">\(t\)</span> is because the arc lies only in the first quadrant). Therefore <span class="math inline">\(\frac{d\underline{x}(t)}{dt} = (-\sin(t), \cos(t))\)</span>. Next note that <span class="math inline">\(\underline{F}(\underline{x}(t)) = \underline{F}(x(t),y(t)) = (-\sin(t),
-\cos(t)\sin(t))\)</span>, so <span class="math display">\[\begin{aligned}
\int_C \underline{F}\cdot d\underline{x} &amp;=
\int_0^\frac{\pi}{2} (-\sin(t), -\cos(t)\sin(t))\cdot(-\sin(t),
\cos(t))\,dt\\
&amp;= \int_0^\frac{\pi}{2} (\sin^2(t)-\cos^2(t)\sin(t))\,dt\\
&amp;= \int_0^\frac{\pi}{2}\left( {\textstyle\frac{1}{2}}(1-\cos(2t)) -
\cos^2(t)\sin(t)\right)dt\\
&amp;= \Bigl[{\textstyle\frac{1}{2}}(t-{\textstyle\frac{1}{2}}\sin(2t))
+{\textstyle\frac{1}{3}}\cos^3(t) \Bigr]_0^{\frac{\pi}{2}}
= {\textstyle\frac{1}{4}}{\pi}-{\textstyle\frac{1}{3}}\,.\end{aligned}\]</span> Once you have understood Green’s theorem [next chapter!], try to use it to double-check this result.</p>
</div>
<p>To summarize: the steps for performing a line integral of a vector field <span class="math inline">\(\underline{v}(\underline{x})\)</span> along a regular arc <span class="math inline">\(C\)</span> are as follows:<br />
</p>
<ul>
<li><p>parametrise <span class="math inline">\(C\)</span> somehow, as <span class="math inline">\(t\mapsto\underline{x}(t)\)</span>, with <span class="math inline">\(t\)</span> in some range;</p></li>
<li><p>compute <span class="math inline">\(\frac{d\underline{x}(t)}{dt}\)</span> and <span class="math inline">\(\underline{v}(\underline{x}(t))\)</span>;</p></li>
<li><p>compute their scalar product and re-write the integrand in terms of <span class="math inline">\(t\)</span>;</p></li>
<li><p>perform the integration between the limits identified in the first part.</p></li>
</ul>
<p>For a regular curve made up of a number of regular arcs, just do the above steps for each arc, and then add up the results.</p>
</section>
<section id="surface-integrals-i-defining-a-surface" class="level2" data-number="8.4">
<h2 data-number="7.4"><span class="header-section-number">7.4</span> Surface integrals I: defining a surface</h2>
<p>As with a line integral where the integration of a vector field along a curve yields a real number, a three-dimensional vector field can be integrated over a two-dimensional surface <span class="math inline">\(S\)</span> sitting in <span class="math inline">\(\mathbb{R}^3\)</span>, to give a double integral analogue of the line integral. Surface integrals are of particular importance in electromagnetism and fluid mechanics.</p>
<p>The first task is to specify the surface. There are (at least) two standard ways to do this:</p>
<p><strong>Method 1:</strong> Give the surface in <em>parametric form</em> as <span class="math inline">\(\underline{x}(u,v)\)</span> where the real parameters <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> lie in some region <span class="math inline">\(U\subset\mathbb{R}^2\)</span> called the <em>parameter domain</em>.</p>
<div id="eg:spheresurf" class="example">
<p> Points on a sphere of radius <span class="math inline">\(a\)</span> centred on the origin can be parametrised in spherical (polar) coordinates, with <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> usually written as <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\phi\)</span>, as <span class="math display">\[\underline{x}(\theta,\phi)=( x(\theta,\phi), y(\theta,\phi), z(\theta,\phi))\]</span> where <span class="math display">\[x(\theta,\phi)=a\sin\theta\,\cos\phi\,,~~
y(\theta,\phi)=a\sin\theta\,\sin\phi\,,~~
z(\theta,\phi)=a\cos\theta\,,\]</span> and <span class="math inline">\(0\le\theta\le\pi\)</span>, <span class="math inline">\(0\le\phi\le 2\pi\)</span> .</p>
</div>
<p><em>Small aside:</em>  The parametrisation for the surface of a sphere comes from the spherical polar coordinate system, a three-dimensional extension of two-dimensional polar coordinates. Figure <a href="#fig:polar" data-reference-type="ref" data-reference="fig:polar">43</a> shows how we get these coordinates: first calculate <span class="math inline">\(r&#39; =
r\sin(\theta)\)</span>. Then <span class="math inline">\(x = r&#39;\cos(\phi) = r\sin(\theta)\cos(\phi)\)</span>, <span class="math inline">\(y
= r&#39;\sin(\phi) = r\sin(\theta)\sin(\phi)\)</span>, while <span class="math inline">\(z = r\cos(\theta)\)</span>. As ever, <span class="math inline">\(r = \sqrt{x^2+y^2+z^2}\)</span> is the distance from the origin, while <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\phi\)</span> are known as the polar and azimuthal angles respectively, with <span class="math inline">\(\theta\in[0,\pi]\)</span> and <span class="math inline">\(\phi\in[0,2\pi]\)</span>. Beware that some texts have these the other way around, so that <span class="math inline">\(\theta\)</span> is the azimuthal and <span class="math inline">\(\phi\)</span> the polar angle. Note though that here we fix <span class="math inline">\(r\)</span> to be equal to <span class="math inline">\(a\)</span>, the radius of the sphere, as we want to stay on its surface.</p>
<p>The following table gives some more examples:</p>
<div class="center">
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Surface</th>
<th style="text-align: center;">Parametric Equations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">General</td>
<td style="text-align: center;"><span class="math inline">\(\underline{x}(u,v) = x(u,v)\underline{e}_1 + y(u,v)\underline{e}_2 + z(u,v)\underline{e}_3\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Sphere/part sphere, radius <span class="math inline">\(a\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x=a\sin(u)\cos(v)\)</span>, <span class="math inline">\(y=a\sin(v)\sin(u)\)</span>, <span class="math inline">\(z=a\cos(u)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Cylinder, radius <span class="math inline">\(a\)</span>, centred on <span class="math inline">\(z\)</span>-axis</td>
<td style="text-align: center;"><span class="math inline">\(x = a\cos(u)\)</span>, <span class="math inline">\(y=a\sin(u)\)</span>, <span class="math inline">\(z=v\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(z=f(x,y)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x=u\)</span>, <span class="math inline">\(y=v\)</span>, <span class="math inline">\(z=f(u,v)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(y=g(x,z)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x=u\)</span>, <span class="math inline">\(y=g(u,v)\)</span>, <span class="math inline">\(z=v\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(x=h(y,z)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x=h(u,v)\)</span>, <span class="math inline">\(z=v\)</span>, <span class="math inline">\(y=u\)</span></td>
</tr>
</tbody>
</table>
<p><span id="tab:par_surf" label="tab:par_surf">[tab:par_surf]</span></p>
</div>
<div class="center">
<figure>
<img src="polar.png" id="fig:polar" style="width:50.0%" alt="" /><figcaption> Spherical polar coordinates <span class="math inline">\((r,\theta,\phi)\)</span>.</figcaption>
</figure>
</div>
<p>Returning to the general case, <span class="math inline">\(\frac{\partial\underline{x}}{\partial u}\)</span> and <span class="math inline">\(\frac{\partial\underline{x}}{\partial v}\)</span> are two tangent vectors to <span class="math inline">\(S\)</span> at <span class="math inline">\(\underline{x}(u,v)\)</span>, and so their cross product <span class="math display">\[\frac{\partial\underline{x}(u,v)}{\partial u}\times
\frac{\partial\underline{x}(u,v)}{\partial v}\]</span> is a normal vector to <span class="math inline">\(S\)</span> there, and <span class="math display">\[\widehat{\underline{n}}=
\Bigl(\frac{\partial\underline{x}(u,v)}{\partial u}\times
\frac{\partial\underline{x}(u,v)}{\partial v}\Bigr)
\bigg/ %
\left|{\frac{\partial\underline{x}(u,v)}{\partial u}\times
\frac{\partial\underline{x}(u,v)}{\partial v}}\right|\]</span> is a unit normal to <span class="math inline">\(S\)</span> at <span class="math inline">\(\underline{x}(u,v)\)</span>. If <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> are swapped over, then we also get a unit normal to <span class="math inline">\(S\)</span> at <span class="math inline">\(\underline{x}(u,v)\)</span>, but one pointing in the opposite direction (which for a surface sitting in <span class="math inline">\(\mathbb{R}^3\)</span> is the only other option).</p>
<p>It’s a good exercise to check for example <a href="#eg:spheresurf" data-reference-type="ref" data-reference="eg:spheresurf">[eg:spheresurf]</a> that this recipe gives the answer you’d expect, that is a unit vector pointing in the radial direction. For this case the relevant partial derivatives are <span class="math display">\[\begin{aligned}
\frac{\partial \underline{x}}{\partial \theta} 
&amp;= (a\cos\theta\cos\phi, a\cos\theta\sin\phi, -a\sin\theta)\\
\frac{\partial \underline{x}}{\partial \phi} 
&amp;= (-a\sin\theta\sin\phi, a\cos\phi\sin\theta, 0)\end{aligned}\]</span> and so <span class="math display">\[\underline{x}_{\theta}\times\underline{x}_{\phi} \,=\,
(a^2\sin^2\theta\cos\phi,a^2\sin^2\theta\sin\phi,
a^2\sin\theta\cos\theta) = a\sin\theta\,\underline{x}\,.\]</span> Finally constructing the unit normal vector gives <span class="math display">\[\widehat{\underline{n}} = \frac{a\sin\theta\,\underline{x}}{a\sin\theta\,|\underline{x}|} =
\frac{(x,y,z)}{a}\,,\]</span> which is indeed the expected answer, if you think about it.</p>
<p><strong>Method 2:</strong> Express the surface as (part of) a <strong>level surface</strong> (recall from term 1) of a scalar field <span class="math inline">\(f\)</span>, i.e. give the surface implicitly as <span class="math inline">\(f(x,y,z)=\textrm{const}\)</span>. Then the gradient of <span class="math inline">\(f\)</span>, <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f\)</span>, is a normal vector to <span class="math inline">\(S\)</span>, and <span class="math display">\[\begin{equation} \label{eqn:delf}
\widehat{\underline{n}} = \frac{\underline{\nabla\mkern-2mu}\mkern 3mu f}{|\underline{\nabla\mkern-2mu}\mkern 3mu f|}\,, \end{equation}\]</span> is a unit normal.</p>
<div id="eg:prelim" class="example">
<p> For the sphere discussed above, we can take <span class="math inline">\(f(x,y,z) := x^2 + y^2 + z^2 -a^2 = 0\)</span> (or <span class="math inline">\(f(x,y,z) := x^2 + y^2 + z^2
= a^2\)</span> would work just as well). Then <span class="math display">\[\begin{aligned}
\widehat{\underline{n}} &amp;= \frac{\underline{\nabla\mkern-2mu}\mkern 3mu f}{|\underline{\nabla\mkern-2mu}\mkern 3mu f|}\\
&amp;= \frac{(2x,2y,2z)}{\sqrt{4x^2+4y^2+4z^2}}\\
&amp;= \frac{(x,y,z)}{\sqrt{x^2+y^2+z^2}} = \frac{(x,y,z)}{a}\,.\end{aligned}\]</span> This agrees with the result from method 1.</p>
</div>
<p>Note: if we’d instead defined the surface of the sphere by <span class="math inline">\(h(x,y,z)=-f(x,y,z)=a^2-x^2-y^2-z^2=0\)</span>, then the normal vector obtained by using <span class="math inline">\(f\)</span> (which we’ll call <span class="math inline">\(\widehat{\underline{n}}_f\)</span>) would have been replaced by <span class="math display">\[\widehat{\underline{n}}_h = \frac{(-x,-y,-z)}{\sqrt{x^2+y^2+z^2}} =
-\widehat{\underline{n}}_f\]</span> This reflects the same ambiguity in the sign of the normal vector that was seen when swapping <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> in method 1.</p>
</section>
<section id="surface-integrals-ii-evaluating-the-integral" class="level2" data-number="8.5">
<h2 data-number="7.5"><span class="header-section-number">7.5</span> Surface integrals II: evaluating the integral</h2>
<p>We will once again use a Riemann sum to define the surface integral of a continuous vector field <span class="math inline">\(\underline{F}(\underline{x})\)</span> over a surface <span class="math inline">\(S\)</span> lying in <span class="math inline">\(\mathbb{R}^3\)</span>. The parametrised position vector of a point on the surface is <span class="math inline">\(\underline{x} = \underline{x}(u,v)\)</span> with <span class="math inline">\((u,v)\in
U\)</span>, the parameter domain. We will also assume that the partial derivatives of <span class="math inline">\(\underline{x}\)</span> exist and are continuous, and that the unit normal vector <span class="math inline">\(\widehat{\underline{n}}(u,v)\)</span> is continuous – this means that the surface is what we call orientable. (This last point may seem obvious but it is not always true e.g. the Möbius strip is a non-orientable surface.) The general setup is illustrated in figure <a href="#fig:surf_dA" data-reference-type="ref" data-reference="fig:surf_dA">45</a>. Then the surface integral is <em>defined</em> as <span class="math display">\[\begin{equation} \label{eqn:surf_int}
\int_S\underline{F}\cdot d\underline{A}= \lim\limits_{\Delta A_k\to
0}\sum\limits_k \underline{F}(\underline{x}^*_k)\cdot \widehat{\underline{n}}_k\,\Delta A_k\,. \end{equation}\]</span> Note the dot product between the normal to the surface and the vector field: this implies that we are looking at the vector field contributions which are perpendicular to the surface.</p>
<p>To turn this rather-formal definition into something which can be used in practice, we use either method 1 or method 2 to specify the surface, and then convert everything into a ‘flat’ two-dimensional area integral of the sort seen in section <a href="#sub:fubini" data-reference-type="ref" data-reference="sub:fubini">[sub:fubini]</a> above.</p>
<table id="fig:surf_dA" class="imageTable">
<caption> Plot (a) shows a hemispherical surface, over which we may wish to integrate a vector field; plot (b) shows an area element, <span class="math inline">\(\Delta
A_{ij}\)</span>, of the surface with unit normal vector <span class="math inline">\(\widehat{\underline{n}}_{ij}\)</span></caption>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="hemis.jpg" title="fig:" id="fig:surf_dA" style="width:45.0%" alt=" Plot (a) shows a hemispherical surface, over which we may wish to integrate a vector field; plot (b) shows an area element, \Delta
A_{ij}, of the surface with unit normal vector \widehat{\underline{n}}_{ij}" /></td>
<td style="text-align: center;"><img src="surf_dA.png" title="fig:" id="fig:surf_dA" style="width:45.0%" alt=" Plot (a) shows a hemispherical surface, over which we may wish to integrate a vector field; plot (b) shows an area element, \Delta
A_{ij}, of the surface with unit normal vector \widehat{\underline{n}}_{ij}" /></td>
</tr>
<tr class="even">
<td style="text-align: center;">(a)</td>
<td style="text-align: center;">(b)</td>
</tr>
</tbody>
</table>
<p>. <span id="fig:surf_dA" label="fig:surf_dA">[fig:surf_dA]</span></p>
<p><strong>Method 1:</strong> We construct the area elements <span class="math inline">\(\Delta
A_k\)</span> by approximating them as parallelograms given by the partitioning of the surface along lines of constant <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span>. Remember <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> are in the parameter domain <span class="math inline">\(U\)</span>, split as shown in figure <a href="#fig:surf_dA" data-reference-type="ref" data-reference="fig:surf_dA">45</a>(b) and indexed <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> respectively, and that the modulus of the cross product of two vectors in equal to the area of the parallelogram that they span. Thus <span class="math display">\[\begin{align}
% \label{eqn:nA}
\widehat{\underline{n}}_k\Delta A_k&amp;\approx  (\underline{x}(u_i +\Delta u_i, v_j) -
\underline{x}(u_i, v_j))\times(\underline{x}(u_i, v_j+\Delta v_j) - \underline{x}(u_i,
v_j))\nonumber\\
&amp;\approx  (\Delta u_i\frac{\partial \underline{x}}{\partial u})\times (\Delta v_j\frac{\partial \underline{x}}{\partial v})\textrm{.}
\label{eqn:area_el}\end{align}\]</span> Substituting equation <span class="math inline">\(\eqref{eqn:area_el}\)</span> into equation <span class="math inline">\(\eqref{eqn:surf_int}\)</span> gives us <span class="math display">\[\int_S\underline{F}\cdot d\underline{A}
= \lim\limits_{\Delta u_i, \Delta v_j\to
0}\sum\limits_{i,j} \underline{F}(\underline{x}^*_{ij})\cdot \left(\frac{\partial
\underline{x}(u_i,v_j)}{\partial u}\times \frac{\partial
\underline{x}(u_i,v_j)}{\partial v}\right)\Delta u_i\Delta v_j\]</span> and, taking the limit, we get the key formula, the ‘surface’ version of the line integral definition (<a href="#lineintdef" data-reference-type="ref" data-reference="lineintdef">[lineintdef]</a>): <span class="math display">\[\begin{equation} \boxed{
\int_S\underline{F}\cdot d\underline{A}
= \int_U \underline{F}(\underline{x}(u,v))\cdot \left(\frac{\partial
\underline{x}}{\partial u}\times \frac{\partial \underline{x}}{\partial v}\right)
du\,dv\,.
}
\label{eqn:Sint} \end{equation}\]</span> This is a double integral over the parameter domain <span class="math inline">\(U\)</span>, and can be written neatly as <span class="math display">\[\int_S \underline{F}\cdot d\underline{A} = \int_U
\underline{F}\cdot \underline{N}\,du\,dv\,,\]</span> where <span class="math inline">\(\underline{N} = \underline{x}_u\times\underline{x}_v\)</span> is a normal vector to <span class="math inline">\(S\)</span> (but not of unit length).</p>
<div id="method1eg" class="example">
<p> Find the integral of <span class="math inline">\(\underline{F} = \underline{e}_3\)</span> over the surface, <span class="math inline">\(S\)</span>, given by the hemisphere of radius 1, centred at the origin, with <span class="math inline">\(z&gt;0\)</span>, as shown in figure <a href="#fig:surf_dA" data-reference-type="ref" data-reference="fig:surf_dA">45</a> (a). We have <span class="math display">\[\int_S \underline{F}\cdot d\underline{A} = \int_U
\underline{F}(\underline{x})\cdot \left(\frac{\partial \underline{x}}{\partial u}\times
\frac{\partial \underline{x}}{\partial v}\right) du\,dv\,,\]</span> where <span class="math inline">\(r = 1\)</span>, and taking <span class="math inline">\(U=\{(u, v)\in\mathbb{R}^2: 
0\le u\le\frac{\pi}{2}, 0\le v\le 2\pi\}\)</span> captures the part of the surface of the unit sphere with <span class="math inline">\(z\ge 0\)</span>. We also calculated <span class="math inline">\(\underline{x}_u\times \underline{x}_v\)</span> in the discussion following example <a href="#eg:spheresurf" data-reference-type="ref" data-reference="eg:spheresurf">[eg:spheresurf]</a>, and substituting all our values and completing the calculation, <span class="math display">\[\begin{aligned}
\int_S \underline{F}\cdot d\underline{A}&amp;=
\int_0^{2\pi}\int_0^{\frac{\pi}{2}}\underline{F}(\underline{x})\cdot
\left(\frac{\partial \underline{x}}{\partial u}\times \frac{\partial
\underline{x}}{\partial v}\right) du\,dv\\
&amp;= \int_0^{2\pi}\int_0^{\frac{\pi}{2}} \underline{e}_3\cdot
(\sin^2(u)\cos(v)\underline{e}_1 + \sin^2(u)\sin(v)\underline{e}_2 +
\sin(u)\cos(u)\underline{e}_3)\,du\,dv\\
&amp;= \int_0^{2\pi}\int_0^{\frac{\pi}{2}} \sin(u)\cos(u)\,du\,dv\\
&amp;= \int_0^{2\pi}\left[{\textstyle\frac{1}{2}}\sin^2(u)\right]^{\frac{\pi}{2}}_0 dv
= \int_0^{2\pi}\!{\textstyle\frac{1}{2}}\,dv = \pi\,.\end{aligned}\]</span></p>
</div>
<p><strong>Method 2:</strong> Suppose that <span class="math inline">\(S\)</span> is given as the level set (or part of the level set) of a function <span class="math inline">\(f(x,y,z)\)</span>, and furthermore that <span class="math inline">\(\partial f/\partial z\neq 0\)</span> on <span class="math inline">\(S\)</span>. Then, by the implicit function theorem for surfaces, the points of <span class="math inline">\(S\)</span> can be written as <span class="math inline">\((x,y,g(x,y))\)</span> for some function <span class="math inline">\(g(x,y)\)</span>, where the <span class="math inline">\((x,y)\)</span> ranges over some region <span class="math inline">\(A\)</span> of the <span class="math inline">\(x\)</span>,<span class="math inline">\(y\)</span> plane, which is the projection of <span class="math inline">\(S\)</span> onto that plane. (This is not possible for every surface; for example the <span class="math inline">\(x\)</span>,<span class="math inline">\(z\)</span> plane cannot be parametrised this way, and neither can the surface of a whole sphere.) We can then apply method 1 taking the parameters to be the <span class="math inline">\(x,\,y\)</span> coordinates, so that <span class="math inline">\({\bf x}(x,y)=(x,y,g(x,y))=
x\,\underline{e}_1+y\,\underline{e}_2+g(x,y)\,\underline{e}_3\)</span>, and (after a short calculation) <span class="math display">\[\frac{\partial \underline{x}}{\partial x}\times \frac{\partial \underline{x}}{\partial y}=
-{\bf e}_1\frac{\partial g}{\partial x}-{\bf e}_2\frac{\partial
g}{\partial y}+{\bf e}_3\,.\]</span> The partial derivatives of <span class="math inline">\(g\)</span> can be calculated as in the implicit function theorem for surfaces, noting that the function of two variables, <span class="math inline">\(F(x,y)\)</span>, defined by <span class="math inline">\(F(x,y)=f(x,\,y,\,g(x,y))\)</span>, is constant, so that <span class="math display">\[0=\frac{\partial F}{\partial x}=\frac{\partial f}{\partial
x}+\frac{\partial f}{\partial z}\frac{\partial g}{\partial x}\]</span> <span class="math display">\[0=\frac{\partial F}{\partial y}=\frac{\partial f}{\partial
y}+\frac{\partial f}{\partial z}\frac{\partial g}{\partial y}\]</span> Using these equations, <span class="math display">\[\frac{\partial \underline{x}}{\partial x}\times \frac{\partial \underline{x}}{\partial y}=
{\bf e}_1\frac{\partial f}{\partial x}/\frac{\partial f}{\partial z}
+{\bf e}_2\frac{\partial f}{\partial y}/\frac{\partial f}{\partial
z}+{\bf e}_3=(\underline{\nabla\mkern-2mu}\mkern 3mu f)/({\bf e}_3\cdot\underline{\nabla\mkern-2mu}\mkern 3mu f)\,,\]</span> enabling the surface integral of <span class="math inline">\(\bf F\)</span> over <span class="math inline">\(S\)</span> to be written as an area integral over the region <span class="math inline">\(A\)</span> in the <span class="math inline">\(x,y\)</span>-plane: <span class="math display">\[\int_S\underline{F}\cdot d\underline{A}=\int_A \frac{\underline{F}\cdot
\underline{\nabla\mkern-2mu}\mkern 3mu f}{\underline{e}_3\cdot \underline{\nabla\mkern-2mu}\mkern 3mu f}\,dx\,dy\,.\]</span></p>
<p><em>Note:</em> whenever we compute a surface integral, there is a choice as to the direction to take the normal vectors to the surface – ‘in’ or ‘out’ for a closed surface, or ‘upwards’ or ‘downwards’ for a surface lying above the <span class="math inline">\(x\)</span>,<span class="math inline">\(y\)</span> plane, for example. In the derivation of the formula just given, <span class="math inline">\(z\)</span> component of <span class="math inline">\(\frac{\partial \underline{x}}{\partial
x}\times \frac{\partial \underline{x}}{\partial y}\)</span> was equal to <span class="math inline">\(1\)</span>, so it corresponds to the ‘upwards’ choice of normals. If the downwards option was the one you were after, the formula should be negated.</p>
<div class="center">
<figure>
<img src="planes.png" id="fig:planes" style="width:70.0%" alt="" /><figcaption> Plot of the tangent plane to a surface at a point <span class="math inline">\(\underline{x}_k\)</span>, making an angle <span class="math inline">\(\psi\)</span> with the <span class="math inline">\(x\)</span>,<span class="math inline">\(y\)</span> plane.</figcaption>
</figure>
</div>
<p>We can give an alternative derivation of the method 2 formula starting from the definition of the surface integral in terms of a Riemann sum, equation <span class="math inline">\(\eqref{eqn:surf_int}\)</span>. We shall use equation <span class="math inline">\(\eqref{eqn:delf}\)</span> for the unit normal, <span class="math inline">\(\widehat{\underline{n}}_k =
\frac{\underline{\nabla\mkern-2mu}\mkern 3mu f}{|\underline{\nabla\mkern-2mu}\mkern 3mu f|}\)</span> , where <span class="math inline">\(f(x,y,z)=\textrm{const}\)</span> defines the surface. Instead of approximating the small area element by a parallelogram we can use a geometrical argument. Figure <a href="#fig:planes" data-reference-type="ref" data-reference="fig:planes">46</a> shows the tangent plane to <span class="math inline">\(S\)</span> at a point of interest, <span class="math inline">\(\underline{x}_k\)</span>, on <span class="math inline">\(S\)</span>, and an area <span class="math inline">\(\Delta A_k\)</span> on that plane together with the ‘shadow’ <span class="math inline">\(\Delta A=\Delta x\Delta y\)</span> that it casts on the <span class="math inline">\(x\)</span>,<span class="math inline">\(y\)</span> plane. From the figure we can see that <span class="math inline">\(\frac{\Delta A}{\Delta A_k} = \cos(\psi)\)</span> , while <span class="math inline">\(\cos(\psi) =
\underline{e}_3\cdot\widehat{\underline{n}}_k\)</span> from definition of dot product. Hence we can write <span class="math display">\[\Delta A_k = \frac{\Delta x\Delta y}{\cos(\psi)} = 
\frac{\Delta x\Delta y}{\underline{e}_3\cdot\widehat{\underline{n}}_k}~~\mbox{and}~~
\widehat{\underline{n}}_k\,\Delta A_k = 
\frac{\widehat{\underline{n}}_k\,\Delta x\Delta
y}{\underline{e}_3\cdot\widehat{\underline{n}}_k}\,.\]</span> Returning to the Riemann sum, and substituting <span class="math inline">\(\widehat{\underline{n}}_k=\frac{\underline{\nabla\mkern-2mu}\mkern 3mu f}{|\underline{\nabla\mkern-2mu}\mkern 3mu f|}\)</span> in the formula just given for <span class="math inline">\(\widehat{\underline{n}}_k\,\Delta_k\)</span> , we have <span class="math display">\[\begin{aligned}
\int_S\underline{F}\cdot d\underline{A} &amp;= \lim\limits_{\Delta A_k\to 0}\sum\limits_k \underline{F}(\underline{x}^*_k)\cdot \widehat{\underline{n}}_k\Delta A_k\\
&amp;= \lim\limits_{\Delta x_i, \Delta y_j\to 0}\sum\limits_{i,j} \underline{F}(\underline{x}^*_{i,j})\cdot \frac{\underline{\nabla\mkern-2mu}\mkern 3mu f}{\left|\underline{\nabla\mkern-2mu}\mkern 3mu f\right|}\frac{\Delta x_i\Delta y_j}{\underline{e}_3\cdot \frac{\underline{\nabla\mkern-2mu}\mkern 3mu f}{\left|\underline{\nabla\mkern-2mu}\mkern 3mu f\right|}}\\
&amp;=\lim\limits_{\Delta x_i, \Delta y_j\to 0}\sum\limits_{i,j} \frac{\underline{F}(\underline{x}^*_{i,j})\cdot \underline{\nabla\mkern-2mu}\mkern 3mu f}{\underline{e}_3\cdot \underline{\nabla\mkern-2mu}\mkern 3mu f}\Delta x_i\Delta y_j\\
&amp;= \int_A \frac{\underline{F}\cdot \underline{\nabla\mkern-2mu}\mkern 3mu f}{\underline{e}_3\cdot \underline{\nabla\mkern-2mu}\mkern 3mu f} \,dx\,dy\,,\end{aligned}\]</span> where <span class="math inline">\(A\)</span> is the area of the surface projected onto the <span class="math inline">\(x\)</span>,<span class="math inline">\(y\)</span> plane. Let’s return to the previous example and calculate the surface integral using method 2.</p>
<div id="method2eg" class="example">
<p> Recompute the integral of <span class="math inline">\(\underline{F} = \underline{e}_3\)</span> over the surface, <span class="math inline">\(S\)</span>, given by the hemisphere of radius 1 and centred at the origin with <span class="math inline">\(z&gt;0\)</span>, as shown in figure <a href="#fig:surf_dA" data-reference-type="ref" data-reference="fig:surf_dA">45</a>(a), using method 2. Here the surface can be represented by <span class="math inline">\(f(x,y,z) = x^2 +y^2 +z^2 =1\)</span>, <span class="math inline">\(A\)</span> is the unit circle centred at the origin, and <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu f = (2x,2y,2z)\)</span>. Hence <span class="math display">\[\begin{aligned}
\int_S\underline{F}\cdot d\underline{A}
&amp;= \int_A \frac{\underline{F}\cdot
\underline{\nabla\mkern-2mu}\mkern 3mu f}{\underline{e}_3\cdot \underline{\nabla\mkern-2mu}\mkern 3mu f}\,dx\,dy\\[3pt]
&amp;= \int_A \frac{\underline{e}_3\cdot \underline{\nabla\mkern-2mu}\mkern 3mu f}{\underline{e}_3\cdot \underline{\nabla\mkern-2mu}\mkern 3mu 
f}\,dx\,dy\\[3pt]
&amp;= \int_A dx\,dy = \pi\,,\end{aligned}\]</span> since the area of the unit disk is <span class="math inline">\(\pi\)</span>. This agrees with our previous calculation, as of course it had to.</p>
</div>
<p>To recap: there are two ways to evaluate a surface integral, and which one is the best to use depends on the form of the surface you are integrating over:</p>
<div class="center">
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Equation of surface</th>
<th style="text-align: center;">Form of surface integral</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Parametric: <span class="math inline">\(\underline{x}(u,v)\)</span> as in example <a href="#method1eg" data-reference-type="ref" data-reference="method1eg">[method1eg]</a></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \int_S\underline{F}\cdot d\underline{A} 
% = \int_U \vec{F}\cdot \vec{N}\,du\,dv 
= \int_U \underline{F}\cdot
(\underline{x}_u\times\underline{x}_v)\,du\,dv\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Implicit/level surface: <span class="math inline">\(f(x,y,z)=\textrm{const}\)</span> as in example <a href="#method2eg" data-reference-type="ref" data-reference="method2eg">[method2eg]</a></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \int_S\underline{F}\cdot d\underline{A}= \int_A
\frac{\underline{F}\cdot \underline{\nabla\mkern-2mu}\mkern 3mu f}{\underline{e}_3\cdot \underline{\nabla\mkern-2mu}\mkern 3mu f}\,dx\,dy\)</span></td>
</tr>
</tbody>
</table>
</div>
<p>These two forms of the surface integral are equivalent, but one may be easier than the other for any given example so you must practise! The problem sheets contain plenty of examples, many of them in the context of the three theorems that will be discussed next.</p>
</section>
</section>
<section id="greens-stokes-and-divergence-theorems" class="level1" data-number="9">
<h1 data-number="8"><span class="header-section-number">8</span> Green’s, Stokes’ and divergence theorems</h1>
<section id="the-three-big-theorems" class="level2" data-number="9.1">
<h2 data-number="8.1"><span class="header-section-number">8.1</span> The three big theorems</h2>
<p>1. <em>Green’s theorem in the plane</em></p>
<p>Let <span class="math inline">\(P(x,y)\)</span> and <span class="math inline">\(Q(x,y)\)</span>, <span class="math inline">\((x,y)\in\mathbb{R}^2\)</span>, be continuously differentiable scalar fields in 2 dimensions. Then <span class="math display">\[\begin{equation} \label{eqn:green}
\boxed{\,\oint_C \bigl(P(x,y)\,dx + Q(x,y)\,dy\bigr) = \int_A
\Bigl(\frac{\partial Q}{\partial x} - \frac{\partial P}{\partial
y}\Bigr)\,dx\,dy\,} \end{equation}\]</span> where <span class="math inline">\(C\)</span> is the boundary of <span class="math inline">\(A\)</span>, traversed in a positive (anti-clockwise) direction. A good way to remember which way is positive is to imagine you are walking around the boundary with the area of integration to your left; then you are walking in a positive direction!</p>
<p>Green’s theorem in the plane can also be written in vector form, embedding the <span class="math inline">\(x\)</span>,<span class="math inline">\(y\)</span> plane into <span class="math inline">\(\mathbb{R}^3\)</span> (with <span class="math inline">\(z=0\)</span>) and setting <span class="math inline">\(\underline{F}(x,y,z) = (P(x,y),Q(x,y),R)\)</span> with <span class="math inline">\(R\)</span> arbitrary: <span class="math display">\[\oint_C \underline{F}\cdot d\underline{x} = \int_A (\underline{\nabla\mkern-2mu}\mkern 3mu \times
\underline{F})\cdot\underline{e}_3\,dA\,.\]</span> It’s a good exercise to check that you agree with this statement!</p>
<p>2. <em>Stokes’ theorem</em></p>
<p>This generalises the vector form of Green’s theorem to arbitrary surfaces in <span class="math inline">\(\mathbb{R}^3\)</span>.</p>
<p>Take a continuously differentiable vector field <span class="math inline">\(\underline{F}(x,y,z)\)</span> in <span class="math inline">\(\mathbb{R}^3\)</span>, and a surface <span class="math inline">\(S\)</span> also in <span class="math inline">\(\mathbb{R}^3\)</span> with area elements <span class="math inline">\(d\underline{A}=\widehat{\underline{n}}\,dA\)</span> and boundary curve <span class="math inline">\(C \equiv \partial S\)</span>. Then <span class="math display">\[\begin{equation} \label{eqn:stokes}
\boxed{\,\oint_C \underline{F}\cdot d\underline{x} = \int_S (\underline{\nabla\mkern-2mu}\mkern 3mu \times
\underline{F})\cdot d\underline{A}\,
% = \int_S (\del\times \vec{F})\cdot\vec{\hat{n}}\,dA\, 
} \end{equation}\]</span></p>
<p>As with Green’s theorem, we need to make a comment about orientations. The surface <span class="math inline">\(S\)</span> has two choices of normal vector (say <span class="math inline">\(\widehat{\underline{n}}\)</span> and <span class="math inline">\(-\widehat{\underline{n}}\)</span>), and the curve <span class="math inline">\(C=\partial S\)</span> also has two possible choices of orientation. In either integral, changing from one orientation to the other (changing from <span class="math inline">\(\widehat{\underline{n}}\)</span> to <span class="math inline">\(-\widehat{\underline{n}}\)</span>, or vice versa, in the case of the surface integral) changes the overall sign of the answer. So, given a surface with a choice of normal, how do we know which orientation we should take for the boundary (or equivalently, given a choice of boundary orientation, which normal should we take for the surface) in order to get the equality of Stokes’ theorem?</p>
<p>The answer is given by the <strong>right hand rule:</strong></p>
<p>Curl the fingers of your right hand, and extend your thumb. If you imagine placing your hand on the surface, near the boundary, with your thumb pointing in the direction of the surface normal, then your fingers curl in the direction of the orientation of the boundary.</p>
<p>Equivalently, if you were to stand on the boundary with your head pointing in the direction of the normal, and walk around the boundary such that the surface is on your left, then you are walking in the direction the boundary should be oriented.</p>
<p>3. <em>The divergence theorem:</em></p>
<p>As the name suggests, this theorem involves the divergence operator. If <span class="math inline">\(\underline{F}\)</span> is a continuously differentiable vector field defined over the volume <span class="math inline">\(V\)</span> with bounding surface <span class="math inline">\(S\)</span>, then <span class="math display">\[\begin{equation} \label{eqn:divergencetheorem}
\boxed{\,\int_S \underline{F}\cdot d\underline{A} = \int_V \underline{\nabla\mkern-2mu}\mkern 3mu 
\cdot \underline{F}\, dV\,} \end{equation}\]</span> As in Stokes’ theorem, <span class="math inline">\(d\underline{A} = \widehat{\underline{n}}\,dA\)</span>, while <span class="math inline">\(\widehat{\underline{n}}\)</span> is the outward unit normal.</p>
<p>Proofs? See later!</p>
<p>These theorems can be considered as higher-dimensional analogues of the fundamental theorem of calculus: in each case the integral of a differentiated object over some region is equated to the integral of the undifferentiated object over the boundary of that region, as illustrated in figure <a href="#fig:compare" data-reference-type="ref" data-reference="fig:compare">47</a>.</p>
<div class="center">
<figure>
<img src="Int_thrms.png" id="fig:compare" style="width:90.0%" alt="" /><figcaption> The integration regions for the divergence theorem, Stokes’ theorem, and the fundamental theorem of calculus. Note the similarities between the formulae: the left hand side of each has one less integral than the right hand side, and this is ‘compensated’ by the presence of a derivative on each right hand side. Also notice that the domains of the right hand side integrations, <span class="math inline">\(V\)</span>, <span class="math inline">\(S\)</span> and <span class="math inline">\(I\)</span>, are bounded by the domains of the left hand sides, <span class="math inline">\(S\)</span>, <span class="math inline">\(C\)</span> and <span class="math inline">\(\{a,b\}\)</span> respectively. </figcaption>
</figure>
</div>
</section>
<section id="examples" class="level2" data-number="9.2">
<h2 data-number="8.2"><span class="header-section-number">8.2</span> Examples</h2>
<div class="example">
<p>(Green) Check Green’s theorem when <span class="math inline">\(P(x,y) = y^2 - 7y\)</span>, <span class="math inline">\(Q(x,y) = 2xy+2x\)</span> and the area of integration is bounded by the unit circle <span class="math inline">\(x^2+y^2 = 1\)</span>. Calculating the RHS of equation <span class="math inline">\(\eqref{eqn:green}\)</span> first: <span class="math display">\[\begin{aligned}
\int_A (\frac{\partial Q}{\partial x} - \frac{\partial P}{\partial
y})dx\,dy &amp;= \int_A (2y+2)-(2y-7)\,dx\,dy\\
&amp;= 9\int_A dx\,dy = 9\pi\,,\end{aligned}\]</span> since <span class="math inline">\(\int_Adx\,dy\)</span> is the area of the unit circle (recall from section 1). Next we parametrise the circle as before, so that <span class="math inline">\(dx =
-\sin t\,dt\)</span>, <span class="math inline">\(dy = \cos t\,dt\)</span>, and calculate the LHS of equation <span class="math inline">\(\eqref{eqn:green}\)</span>: <span class="math display">\[\begin{aligned}
\oint_C (P\frac{dx}{dt} + Q\frac{dy}{dt})\,dt &amp;=
\int_0^{2\pi}\left((\sin^2t - 7\sin t)(-\sin t) + (2\cos t\sin t +
2\cos t)(\cos t)\right)dt\\
&amp;= \int_0^{2\pi}(-\sin^3t + 7\sin^2t + 2\cos^2t\sin t + 2\cos^2t)\,dt
\,=\, 9\pi\end{aligned}\]</span> This agrees with the previous calculation, but was more arduous. Usually (not always) the area integral is the easier part, so if faced with a tough closed line integral, see if Green’s Theorem is applicable.</p>
</div>
<div class="example">
<p>(Stokes) Evaluate <span class="math inline">\(I=\oint_C\underline{F}\cdot d\underline{x}\)</span> where <span class="math display">\[\underline{F}=x^2e^{5z}\underline{e}_1+x\,\cos y\,\underline{e}_2+3y\,\underline{e}_3\]</span> and <span class="math inline">\(C\)</span> is the circle defined by <span class="math inline">\(x=0\)</span>, <span class="math inline">\(y=2+2\cos\theta\)</span>, <span class="math inline">\(z=2+2\sin\theta\)</span>, <span class="math inline">\(0\le\theta\le 2\pi\)</span> .</p>
<p>We’ll do this in two ways. First, the direct route. We have <span class="math display">\[\underline{x}(\theta)=(2+2\cos\theta)\,\underline{e}_2+(2+2\sin\theta)\,\underline{e}_3\]</span> so <span class="math display">\[\frac{d\underline{x}}{d\theta}=-2\sin\theta\,\underline{e}_2+2\cos\theta\,\underline{e}_3\]</span> and <span class="math display">\[\underline{F}(\underline{x}(\theta))\cdot\frac{d\underline{x}}{d\theta}=
3(2+2\cos\theta)2\cos\theta\,.\]</span> Hence <span class="math display">\[I=\int_0^{2\pi}12(1+\cos\theta)\cos\theta\,d\theta = 12\pi\,.\]</span> Alternatively, Stokes’ theorem can be used. Calculating, <span class="math display">\[\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{F}=3\,\underline{e}_1+5x^2e^{5z}\underline{e}_2+\cos y\,\underline{e}_3\,.\]</span> Take <span class="math inline">\(S\)</span> to be the planar (flat) disk spanning <span class="math inline">\(C\)</span>. Note that <span class="math inline">\(C\)</span> is such that <span class="math inline">\(y\)</span> initially decreases as <span class="math inline">\(\theta\)</span> increases from 0, and that <span class="math inline">\(z\)</span> increases similarly. By the right hand rule, we should therefore take the normal on <span class="math inline">\(S\)</span> in the positive <span class="math inline">\(x\)</span> direction. So <span class="math inline">\(\widehat{\underline{n}}=\underline{e}_1\)</span> everywhere on <span class="math inline">\(S\)</span>, <span class="math inline">\(d\underline{A}=\underline{e}_1\,dA\)</span>, and <span class="math inline">\((\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{F})\cdot d\underline{A}=3\,dA\)</span>. Hence <span class="math display">\[I=\iint_A3\,dA=3\times(\mbox{area of $S$}) = 12\pi\quad\mbox{as before.}\]</span> Clearly, if we had taken the normal as <span class="math inline">\(-\underline{e}_1\)</span> instead, we would have got the opposite sign for the surface integral, and the two answers wouldn’t have agreed.</p>
</div>
<div class="example">
<p>(Stokes again) Let <span class="math inline">\(S\)</span> be the upper (<span class="math inline">\(z\ge 0\)</span>) half of the sphere <span class="math inline">\(x^2+y^2+z^2=1\)</span> ; evaluate the surface integral <span class="math display">\[I=\int_S(x^3e^y\underline{e}_1-3x^2e^y\underline{e}_2)\cdot d\underline{A}\,.\]</span> To do this directly is tricky; instead we’ll attempt to use Stokes’ theorem. Observe that if <span class="math inline">\(\underline{F}=x^3e^y\underline{e}_3\)</span>, then <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{F}=(x^3e^y\underline{e}_1-3x^2e^y\underline{e}_2)\)</span>, which is the thing we want to integrate over the hemisphere. Hence by Stokes’ theorem <span class="math display">\[I=\oint_C\underline{F}\cdot d\underline{x}\]</span> where <span class="math inline">\(C\)</span> is the boundary of <span class="math inline">\(S\)</span>, which can be parametrised via <span class="math inline">\(\underline{x}(\theta)=\cos\theta\,\underline{e}_1+\sin\theta\,\underline{e}_2\)</span>, <span class="math inline">\(0\le\theta\le 2\pi\)</span>. Then <span class="math inline">\(\frac{d\underline{x}}{d\theta}=-\sin\theta\,\underline{e}_1+\cos\theta\,\underline{e}_2\)</span>, which has zero scalar product with <span class="math inline">\(\underline{F}\)</span> for all <span class="math inline">\(\theta\)</span>. Hence <span class="math inline">\(I=0\)</span>.</p>
</div>
<div class="example">
<p>(Divergence) Evaluate <span class="math inline">\(I=\int_S(3x\,\underline{e}_1+2y\,\underline{e}_2)\cdot d\underline{A}\)</span> where <span class="math inline">\(S\)</span> is the sphere <span class="math inline">\(x^2+y^2+z^2=9\)</span>.<br />
Here <span class="math inline">\(\underline{F}=(3x,2y,0)\)</span> so <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \cdot\underline{F}=3+2=5\)</span> and so, by the divergence theorem, <span class="math display">\[I=\int_V5\,dV=5\frac{4}{3}\pi\,3^3=180\pi\]</span> where we used the fact that the volume of <span class="math inline">\(V\)</span>, the interior of <span class="math inline">\(S\)</span>, is <span class="math inline">\(\frac{4}{3}\pi\,3^3\)</span>.</p>
</div>
<div class="example">
<p>(Divergence again) Let <span class="math inline">\(R\)</span> be the region of <span class="math inline">\(\mathbb{R}^3\)</span> bounded by the surface <span class="math inline">\(z=x^2+y^2\)</span> (a paraboloid) and the plane <span class="math inline">\(z=1\)</span>, and let <span class="math inline">\(S\)</span> be its boundary. Evaluate <span class="math inline">\(I=\int_S\underline{F}\cdot d\underline{A}\)</span> where <span class="math inline">\(\underline{F}=(y,x,z^2)\)</span>.<br />
Using the divergence theorem, <span class="math display">\[\begin{aligned}
I&amp;=\int_V\underline{\nabla\mkern-2mu}\mkern 3mu \cdot\underline{F}\,dV\\[2pt]
&amp;=\int_V2z\,dV\\[2pt]
&amp;=\int_0^12z\,\pi\,r_z^2\,dz\quad\mbox{where $r_z=\sqrt{z}$, as in example
\ref{yurt}}\\[2pt]
&amp;=\int_0^12\,\pi\,z^2\,dz=\frac{2\pi}{3}\,.\end{aligned}\]</span></p>
</div>
</section>
<section id="subsec:conservation" class="level2" data-number="9.3">
<h2 data-number="8.3"><span class="header-section-number">8.3</span> Conservation laws and the continuity equation</h2>
<p>This is an important application of the divergence theorem; it might also help you to get an intuition for the meaning of the surface integral <span class="math inline">\(\int_S \underline{F}\cdot d\underline{A}\)</span>, which is usually interpreted as the flux of some quantity <span class="math inline">\(\underline{F}\)</span> through the surface of interest, <span class="math inline">\(S\)</span>. Flux is the rate of flow per unit area, which is measured perpendicular to the face of the surface, so it is <span class="math inline">\(dA\)</span> multiplied by the unit normal vector <span class="math inline">\(\widehat{\underline{n}}\)</span> with which the dot product with <span class="math inline">\(\underline{F}\)</span> is taken. Typical fluxes of interest are the magnetic flux (<span class="math inline">\(\underline{F}=\underline{B}\)</span>), the electric flux (<span class="math inline">\(\underline{F}=\underline{E}\)</span>), and transport fluxes such as mass (<span class="math inline">\(\underline{F}=\rho\underline{v}\)</span>) (of fluid perhaps), heat or energy.</p>
<p>To give a concrete example, let us consider a swarm of bees and suppose that at time <span class="math inline">\(t\)</span> and position <span class="math inline">\(\underline{x}\in\mathbb{R}^3\)</span> their density (number of bees per unit volume) is <span class="math inline">\(\rho (\underline{x},t)\)</span>, and that near that point they are flying with average velocity <span class="math inline">\(\underline{v}(\underline{x},t)\)</span>. Then the flux of bees is <span class="math inline">\(\underline{j} = \rho\underline{v}\)</span>, meaning that the number of bees per unit time passing through a small area <span class="math inline">\(\Delta A\)</span> with unit normal <span class="math inline">\(\widehat{\underline{n}}\)</span> is <span class="math inline">\(\underline{j}\cdot\widehat{\underline{n}}\,\Delta A\)</span>.</p>
<div class="center">
<figure>
<img src="ants.png" id="fig:ants" alt="" /><figcaption> Cartoon of flying bees, travelling through the surface <span class="math inline">\(\Delta A\)</span> at a velocity <span class="math inline">\(\underline{v}\)</span>.</figcaption>
</figure>
</div>
<p>To see this, imagine you are one of the flying bees near to the area element <span class="math inline">\(\Delta A\)</span>; in a small time interval <span class="math inline">\(\delta t\)</span> this element will appear to move with a distance <span class="math inline">\(\underline{v}\delta t\)</span> and so the element will have swept out a volume <span class="math inline">\(\Delta A \widehat{\underline{n}}\cdot\underline{v}\delta
t\)</span>, as shown in figure <a href="#fig:ants" data-reference-type="ref" data-reference="fig:ants">48</a>. The total number of bees in this volume is <span class="math inline">\(\rho\Delta A
\widehat{\underline{n}}\cdot\underline{v}\delta t\)</span>, and they will all cross the area element <span class="math inline">\(\Delta A\)</span> in this time <span class="math inline">\(\delta t\)</span>; this implies that the rate at which the bees fly through <span class="math inline">\(\Delta A\)</span> is <span class="math inline">\(\rho\Delta A
\widehat{\underline{n}}\cdot\underline{v}\)</span>. Now imagine we have a larger surface <span class="math inline">\(S\)</span> made up of many small area elements <span class="math inline">\(\widehat{\underline{n}}\,dA\)</span>. The total flux of bees across the whole surface <span class="math inline">\(S\)</span> can be found by subdividing <span class="math inline">\(S\)</span> into its constiuent area elements and adding up the fluxes across each of these. Taking the limit as the sizes of these small area elements tend to zero, the total flux through <span class="math inline">\(S\)</span> is <span class="math display">\[\lim\limits_{\Delta A\to 0}\sum\limits_{\textrm{all }\Delta
A\textrm{&#39;s}} \rho\,\Delta A\,\widehat{\underline{n}}\cdot \underline{v} = \int_S
\underline{j}\cdot d\underline{A}\,.\]</span> We can now think about the implications of the “conservation of bees" to this situation. The total number of bees in some fixed volume <span class="math inline">\(V\)</span> at time <span class="math inline">\(t\)</span> is <span class="math display">\[B(t) = \int_V\rho\,dV =
\int_V\rho(x,y,z,t)\,dx\,dy\,dz\]</span> and the rate of change of <span class="math inline">\(B(t)\)</span> is <span class="math display">\[\frac{dB}{dt} = \frac{d}{dt}\int_V\rho\,dV =
\int_V \frac{\partial\rho}{\partial t}\,dV\]</span> (where the derivative can be taken inside the integral since the volume <span class="math inline">\(V\)</span> is fixed). At the same time, the rate of flow of bees out of <span class="math inline">\(V\)</span> is <span class="math display">\[R=\int_S\underline{j}\cdot d\underline{A}\]</span> where <span class="math inline">\(S\)</span> is the boundary of <span class="math inline">\(V\)</span>. Assuming no bees are being born (hatched?) or killed, it must be true that <span class="math display">\[\frac{dB}{dt}=-R\]</span> where the minus sign is because <span class="math inline">\(R\)</span> is the rate of flow <em>out</em> of <span class="math inline">\(V\)</span>, while it is flow <em>into</em> <span class="math inline">\(V\)</span> which causes <span class="math inline">\(B\)</span> to increase. Substituting in the formulae obtained above for <span class="math inline">\(B\)</span> and <span class="math inline">\(R\)</span>, <span class="math display">\[\int_V\frac{\partial\rho}{\partial t}\,dV 
=-\int_S\underline{j}\cdot d\underline{A} 
=-\int_V\underline{\nabla\mkern-2mu}\mkern 3mu \cdot\underline{j}\,dV\]</span> using the divergence theorem for the second equality. It’s important to remember that it is the <em>three</em>-dimensional divergence (involving <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span> derivatives) that appears on the right-hand side, since it arose from applying the divergence theorem to a three-dimensional surface integral in <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span>. Hence, <span class="math display">\[\int_V\left(\frac{\partial\rho}{\partial t}+\underline{\nabla\mkern-2mu}\mkern 3mu \cdot\underline{j}\right)dV
=0\]</span> must hold, and must do so for <em>all</em> volumes <span class="math inline">\(V\)</span>. The only way for this to be true is for the thing being integrated to be zero everywhere, or in other words <span class="math display">\[\frac{\partial\rho}{\partial t}= -\underline{\nabla\mkern-2mu}\mkern 3mu \cdot\underline{j}\,.\]</span> This is called the <em>continuity equation</em> and besides its relevance to beekeeping, it crops up in fluid mechanics, electromagnetism, and many other situations where some conservation law is in play.</p>
<p>Bees are perhaps not the best example, since they are not continuous and so the dot product in the integral will consider only the part of the bee crossing the surface perpendicularly. So what happens to the other part of the bee? (This is why we should really consider continuous quantities e.g. flow of water, magnetic fluxes etc.)</p>
<p>To quote Monty Python, “Eric the half a bee”:</p>
<p>“Half a bee, philosophically, must <em>ipso facto</em> half not be. But half the bee has got to be, <em>vis-à-vis</em> its entity - d’you see? But can a bee be said to be or not to be an entire bee when half the bee is not a bee, due to some ancient injury?”</p>
</section>
<section id="path-independence-of-line-integrals" class="level2" data-number="9.4">
<h2 data-number="8.4"><span class="header-section-number">8.4</span> Path independence of line integrals</h2>
<p>Having seen an application of the divergence theorem, we now discuss an important special case of Stokes’ theorem.</p>
<p>In general, line integrals will depend on the path taken between their end points. This is not always the case, though, and vector fields for which the line integral is path independent are rather special. They are called <em>conservative</em> vector fields. We begin with a short example.</p>
<div class="example">
<p>Calculate the line integral <span class="math inline">\(\int_C \underline{F}\cdot d\underline{x}\)</span>, for <span class="math inline">\(\underline{F} =(y\cos(x), \sin(x))\)</span> between <span class="math inline">\((0,0)\)</span> and <span class="math inline">\((1,1)\)</span> over the two paths shown in figure <a href="#fig:conF" data-reference-type="ref" data-reference="fig:conF">49</a> below.</p>
<div class="center">
<figure>
<img src="conF.jpg" id="fig:conF" style="width:60.0%" alt="" /><figcaption> The field plot of <span class="math inline">\(\underline{F}\)</span> with two distinct paths shown, <span class="math inline">\(C_1\)</span> and <span class="math inline">\(C_2 = C_{21} + C_{22}\)</span>.</figcaption>
</figure>
</div>
<p>Let us first calculate <span class="math inline">\(\int_{C_1} \underline{F}\cdot d\underline{x}\)</span>. The parametrisation (recall the table of parametrisations given in section <a href="#sec:surf_line" data-reference-type="ref" data-reference="sec:surf_line">8.3</a>) of this path can be taken to be <span class="math inline">\(\underline{x}(t) = (t,t)\)</span> (<span class="math inline">\(0\le
t\le 1\)</span>), giving <span class="math inline">\(d\underline{x} = (1,1)\,dt\)</span> and <span class="math inline">\(\underline{F}(\underline{x}(t))=
(t\cos(t), \sin(t))\)</span>. We can now perform the integration: <span class="math display">\[\int_{C_1} \underline{F}\cdot d\underline{x} 
=\int_0^1 (t\cos(t) + \sin(t))\,dt\\
=\int_0^1{d(t\sin(t))\over dt}\,dt 
=\sin(1)\,.\]</span> Okay, now let’s try along the second path. It can be split into two sub-paths <span class="math inline">\(C_{21}\)</span> and <span class="math inline">\(C_{22}\)</span> , parametrised as <span class="math inline">\(\underline{x}(t) = (t,0)\)</span> and <span class="math inline">\(\underline{x}(t) = (1,t)\)</span> respectively, with <span class="math inline">\(t\)</span> running from <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span> in each case. Using this setup we obtain for <span class="math inline">\(C_{21}\)</span>: <span class="math inline">\(d\underline{x} = (1,0)\,dt\)</span>, <span class="math inline">\(\underline{F}(\underline{x}(t)) =
(0,\sin(t))\)</span>, and so <span class="math inline">\(\underline{F}\cdot d\underline{x} = 0\)</span>. For <span class="math inline">\(C_{22}\)</span>: <span class="math inline">\(d\underline{x} = (0,1)\,dt\)</span>, <span class="math inline">\(\underline{F}(\underline{x}(t)) = (t\cos(1),\sin(1))\)</span>, and so <span class="math inline">\(\underline{F}\cdot
d\underline{x} = \sin(1)\)</span>. Putting these together to perform the line integral along <span class="math inline">\(C_{2}\)</span> gives <span class="math display">\[\int_{C_2} \underline{F}\cdot d\underline{x} 
= \int_{C_{21}} \underline{F}\cdot
d\underline{x}+\int_{C_{22}} \underline{F}\cdot d\underline{x}\\
=\int_{C_{22}} \underline{F}\cdot d\underline{x}\\
=\int_0^1 \sin(1)\,dt
=\sin(1)\,.\]</span> Both paths give us the same answer!</p>
</div>
<p>Now, we only showed path independence for two very simple paths between two particular points, and to get the general result, in other words to prove that the field is conservative, we would need to check all possible paths joining all pairs of points. This would be both tediously (infinitely!) time consuming, and rather hard in the case of very wiggly paths. We will now show that there is a simple method to show path independence for all possible paths, which uses Stokes’ theorem in a crucial way.</p>
<p>Suppose that <span class="math inline">\(\underline{F}(\underline{x})\)</span> is a continuously differentiable vector field defined on an open subset <span class="math inline">\(D\)</span> of <span class="math inline">\(\mathbb{R}^3\)</span>. Let <span class="math inline">\(C_{1}\)</span> and <span class="math inline">\(C_{2}\)</span> be any two paths from point <span class="math inline">\(\underline{a}\)</span> to point <span class="math inline">\(\underline{b}\)</span> in <span class="math inline">\(D\)</span>, as shown in figure <a href="#fig:2path" data-reference-type="ref" data-reference="fig:2path">50</a>.</p>
<div class="center">
<figure>
<img src="2paths.png" id="fig:2path" style="width:50.0%" alt="" /><figcaption> Two paths between points <span class="math inline">\(\underline{a}\)</span> and <span class="math inline">\(\underline{b}\)</span> in a domain <span class="math inline">\(D\)</span>.</figcaption>
</figure>
</div>
<p>Let us investigate the conditions required for<br />
<span class="math display">\[\Delta I := \int_{C_1} \underline{F}\cdot d\underline{x} - \int_{C_2}
\underline{F}\cdot d\underline{x}\]</span> to be zero, i.e. path independence. Suppose we have parametrised <span class="math inline">\(C_2\)</span> by a parameter <span class="math inline">\(t\)</span> running from <span class="math inline">\(t_{\underline{a}}\)</span> to <span class="math inline">\(t_{\underline{b}}\)</span>, and that <span class="math inline">\(\overline{C}_2\)</span> is the path along <span class="math inline">\(C_2\)</span> taken in the opposite direction. Then <span class="math display">\[\int_{\overline{C}_2} \underline{F}\cdot d\underline{x} 
= \int_{t_{\underline{b}}}^{t_{\underline{a}}}\underline{F}(\underline{x}(t))\cdot
\frac{d\underline{x}}{dt}dt =
-\int_{t_{\underline{a}}}^{t_{\underline{b}}}\underline{F}(\underline{x}(t))\cdot
\frac{d\underline{x}}{dt}\,dt\nonumber \\
=-\int_{C_2} \underline{F}\cdot d\underline{x}\,.\]</span> Combining these equations we have<br />
<span class="math display">\[\Delta I = \int_{C_1} \underline{F}\cdot d\underline{x} + \int_{\overline{C}_2}
\underline{F}\cdot d\underline{x} = \oint_C \underline{F}\cdot d\underline{x}\,,\]</span> where <span class="math inline">\(C\)</span> is the closed path consisting of <span class="math inline">\(C_1\)</span> followed by <span class="math inline">\(\overline{C}_2\)</span>. Now if <span class="math inline">\(C\)</span> is the boundary of a surface <span class="math inline">\(S\)</span> in <span class="math inline">\(D\)</span> then, by Stokes’ theorem, <span class="math display">\[\Delta I = \int_S\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{F}\cdot d\underline{A}\,.\]</span> and so <span class="math inline">\(\Delta I\)</span> will be zero if <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{F} = \underline{0}\)</span> throughout <span class="math inline">\(D\)</span>, giving us path independence. However for this to work we need not only that <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{F}=\underline{0}\)</span> in <span class="math inline">\(D\)</span>, but also that every closed path in <span class="math inline">\(D\)</span> is the boundary of some surface in <span class="math inline">\(D\)</span>. Fortunately, there is a standard condition which ensures that this is the case. A region <span class="math inline">\(D\)</span> is called <em>simply connected</em> if any closed curve in <span class="math inline">\(D\)</span> can be continuously shrunk to a point in <span class="math inline">\(D\)</span>, which in particular implies the condition we need, namely that every closed curve in <span class="math inline">\(D\)</span> is the boundary of a surface in <span class="math inline">\(D\)</span>. Two examples: the two-dimensional surface of a sphere is simply connected, while the two-dimensional surface of a torus is not simply connected – see figure <a href="#fig:torus" data-reference-type="ref" data-reference="fig:torus">52</a>.</p>
<table id="fig:torus" class="imageTable">
<caption> Examples of simply and non simply connected spaces: the surface of a sphere (a) and of a torus (b). The closed curve on (a) can be shrunk to a point and is the boundary of a part of the surface, while the closed curve on (b) can’t be shrunk to a point, and is not the boundary of a part of the surface.</caption>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="sphere.jpg" title="fig:" id="fig:torus" style="width:47.0%" alt=" Examples of simply and non simply connected spaces: the surface of a sphere (a) and of a torus (b). The closed curve on (a) can be shrunk to a point and is the boundary of a part of the surface, while the closed curve on (b) can’t be shrunk to a point, and is not the boundary of a part of the surface." /></td>
<td style="text-align: center;"><img src="torus.jpg" title="fig:" id="fig:torus" style="width:47.0%" alt=" Examples of simply and non simply connected spaces: the surface of a sphere (a) and of a torus (b). The closed curve on (a) can be shrunk to a point and is the boundary of a part of the surface, while the closed curve on (b) can’t be shrunk to a point, and is not the boundary of a part of the surface." /></td>
</tr>
<tr class="even">
<td style="text-align: center;">(a)</td>
<td style="text-align: center;">(b)</td>
</tr>
</tbody>
</table>
<p>Three-dimensional spaces are harder to visualise, but for example <span class="math inline">\(D=\mathbb{R}^3\)</span> is simply-connected, while if we drill out a cylinder around the <span class="math inline">\(z\)</span> axis to leave the set of points <span class="math display">\[D&#39;=\left\{(x,y,z)\in\mathbb{R}^3\,:~ x^2+y^2&gt;1\right\}\]</span> then <span class="math inline">\(D&#39;\)</span> is not simply connected. (Check that you can see why – can you identify a closed curve in <span class="math inline">\(D&#39;\)</span> which can’t be contracted to a point?)</p>
<p>To summarise: if a vector field <span class="math inline">\(\underline{F}\)</span> satisfies <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{F} = \underline{0}\)</span> in some simply-connected region <span class="math inline">\(D\)</span>, and if <span class="math inline">\(C_1\)</span> and <span class="math inline">\(C_2\)</span> are two paths in <span class="math inline">\(D\)</span> joining points <span class="math inline">\(\underline{a}\)</span> and <span class="math inline">\(\underline{b}\)</span>, then <span class="math display">\[\int_{C_1}\underline{F}\cdot d\underline{x}=
\int_{C_2}\underline{F}\cdot d\underline{x}\]</span> and the line integral depends only on the end points – it is <em>path independent</em> and the vector field <span class="math inline">\(\underline{F}\)</span> is conservative.</p>
<section id="the-scalar-potential" class="level3 unnumbered">
<h3 class="unnumbered">The scalar potential</h3>
<p>A further observation: last term we saw that one way for <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{F}\)</span> to be zero in some region <span class="math inline">\(D\)</span> is for <span class="math inline">\(\underline{F}\)</span> to be the gradient of a scalar field there. A natural question is to ask whether it is possible to go the other way, and deduce from <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{F}=\underline{0}\)</span> that <span class="math inline">\(\underline{F}=\underline{\nabla\mkern-2mu}\mkern 3mu \phi\)</span> for some <span class="math inline">\(\phi\)</span>. If the region <span class="math inline">\(D\)</span> is simply connected, then the answer is yes. Suppose that <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{F}=\underline{0}\)</span> in <span class="math inline">\(D\)</span>, and define a scalar field <span class="math inline">\(\phi\)</span> by <span class="math display">\[\phi(\underline{x}) = \int_{\underline{x}_0}^{\underline{x}}\underline{F}\cdot d\underline{x}\]</span> where <span class="math inline">\(\underline{x}_0\)</span> is some (fixed) reference point in <span class="math inline">\(D\)</span>. By path independence, this is well-defined. But what is its gradient?</p>
<p>We can prove this in a few different ways. One method (which is covered in the lectures), is just to calculate the partial derivatives directly. Consider the partial derivative of <span class="math inline">\(\phi\)</span> with respect to <span class="math inline">\(x\)</span>, <span class="math display">\[\frac{\partial \phi}{\partial x} = \lim_{h \to 0} \frac{\phi(\underline{x}+h\underline{e}_1) - \phi(\underline{x})}{h} = \lim_{h\to 0} \frac{\int_{\underline{x_0}}^{\underline{x}+ h\underline{e}_1}\underline{F}\cdot d\underline{x}- \int_{\underline{x_0}}^{\underline{x}}\underline{F}\cdot d\underline{x}}{h}.\]</span></p>
<p>Since we have that <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \times \underline{F} = 0\)</span> over a simply-connected region <span class="math inline">\(D\)</span>, then the line integral of <span class="math inline">\(\underline{F}\)</span> is path independent over <span class="math inline">\(D\)</span>. For the first of the two integrals in the expression above, let us therefore choose to integrate along a path that goes first from <span class="math inline">\(\underline{x}_0\)</span> to <span class="math inline">\(\underline{x}\)</span>, then from <span class="math inline">\(\underline{x}\)</span> to <span class="math inline">\(\underline{x}+ h\underline{e}_1\)</span> in a straight line, as shown in figure <a href="#fig:2path2" data-reference-type="ref" data-reference="fig:2path2">53</a> (where <span class="math inline">\(\underline{h}\)</span> is taken to be <span class="math inline">\(h\underline{e_1}\)</span>).</p>
<div class="center">
<figure>
<img src="phipath.png" id="fig:2path2" style="width:60.0%" alt="" /><figcaption> A path <span class="math inline">\(C\)</span> from <span class="math inline">\(\underline{x}_0\)</span> to <span class="math inline">\(\underline{x}\)</span>, and <span class="math inline">\(\Delta
C\)</span> from <span class="math inline">\(\underline{x}\)</span> to <span class="math inline">\(\underline{x} + \underline{h}\)</span>, where <span class="math inline">\(\underline{h}\)</span> is a small increment.</figcaption>
</figure>
</div>
<p>We can therefore compute the line integral of <span class="math inline">\(\underline{F}\)</span> from <span class="math inline">\(\underline{x}_0\)</span> to <span class="math inline">\(\underline{x}+h\underline{e}_1\)</span> as the sum of the line integrals along the two parts of this path, and hence <span class="math display">\[\frac{\partial \phi}{\partial x} = \lim_{h\to 0} \frac{\int_{\underline{x_0}}^{\underline{x}}\underline{F}\cdot d\underline{x}+ \int_{\underline{x}}^{\underline{x}+ h\underline{e}_1}\underline{F}\cdot d\underline{x}- \int_{\underline{x_0}}^{\underline{x}}\underline{F}\cdot d\underline{x}}{h} = \lim_{h\to 0} \frac{1}{h}\int_{\underline{x}}^{\underline{x}+ h\underline{e}_1}\underline{F}\cdot d\underline{x}\,.\]</span> If we parameterise this path as <span class="math inline">\(\underline{x}(t) = (x+th,y,z),\, 0\le t \le 1\)</span>, then we have <span class="math inline">\(\underline{F}(\underline{x}(t)) = \underline{F}(x+th,y,z)\)</span> and <span class="math inline">\(\frac{d \underline{x}}{dt} = (h,0,0)\)</span>, so <span class="math display">\[\int_{\underline{x}}^{\underline{x}+ h\underline{e}_1}\underline{F}\cdot d\underline{x}= \int_0^1 \underline{F}(x+th,y,z) \cdot h\underline{e}_1\, dt = h\int_0^1 F_1(x+th,y,z)\, dt,\]</span> where <span class="math inline">\(F_1\)</span> is the <span class="math inline">\(\underline{e}_1\)</span> component of <span class="math inline">\(\underline{F}\)</span>. Substituting this back in to our expression for <span class="math inline">\(\frac{\partial \phi}{\partial x}\)</span> gives <span class="math display">\[\frac{\partial \phi}{\partial x} =  \lim_{h\to 0} \int_0^1 F_1(x+th,y,z)\, dt.\]</span></p>
<p>A nice way to evaluate this expression is using the mean value theorem for integrals, which in general states that <span class="math inline">\(\int_a^b G(x)\,dx=G(x^*)(b-a)\)</span> for some <span class="math inline">\(x^*\in[a,b]\)</span>. In this case, this says that there exists a <span class="math inline">\(t^* \in [0,1]\)</span> such that <span class="math inline">\(\int_0^1 F_1(x+th,y,z) = F_1(z+t^*h,y,z)\)</span>, and then taking the limit gives <span class="math inline">\(\frac{\partial \phi}{\partial x} = F_1(x,y,z)\)</span> by continuity.</p>
<p>Alternatively, we can consider a Taylor expansion of <span class="math inline">\(F_1(x+th,y,z)\)</span>, and then we see that <span class="math display">\[\begin{aligned}
		\frac{\partial \phi}{\partial x} &amp;=  \lim_{h\to 0} \int_0^1 (F_1(x,y,z) + th\frac{\partial}{\partial x}F_1(x,y,z) + \ldots) \, dt \\
		&amp;=  \lim_{h\to 0} \left[ tF_1(x,y,z) + \frac{1}{2}t^2h\frac{\partial}{\partial x}F_1(x,y,z) + \ldots \right]_0^1 \\
		&amp;= \lim_{h\to 0} \left(F_1(x,y,z) + \frac{1}{2}h\frac{\partial}{\partial x}F_1(x,y,z) + \ldots\right),
	\end{aligned}\]</span> where all the terms contained within <span class="math inline">\(\ldots\)</span> are of order at least <span class="math inline">\(h^2\)</span>, and hence upon taking the limit we obtain <span class="math display">\[\frac{\partial \phi}{\partial x} = F_1(x,y,z).\]</span></p>
<p>The partial derivatives with respect to <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span> can be calculated following exactly the same procedure, and so we find <span class="math display">\[\underline{\nabla\mkern-2mu}\mkern 3mu \phi (\underline{x}) = F_1(x,y,z)\underline{e}_1 + F_2(x,y,z)\underline{e}_2 + F_3(x,y,z)\underline{e}_3 = \underline{F}(\underline{x}),\]</span> as required.</p>
<p>Here’s an alternative (though similar) approach, which doesn’t require us to consider the different components separately, and has the bonus of showing that <span class="math inline">\(\phi\)</span> is fully differentiable in the sense seen last term. If we return to <a href="#fig:2path2" data-reference-type="ref" data-reference="fig:2path2">53</a>, then (similarly to before), for <span class="math inline">\(\underline{x}+\underline{h}\in D\)</span>, we can write: <span class="math display">\[\phi(\underline{x}+\underline{h})-\phi(\underline{x}) = \int_{\Delta C}\underline{F}\cdot
d\underline{x}\,.\]</span> Choosing the small increment to the path to be a straight line, we can parametrise <span class="math inline">\(\Delta C\)</span> as <span class="math inline">\(\underline{x}(t) =
\underline{x} + \underline{h}\,t\)</span>, where <span class="math inline">\(0\le t\le 1\)</span>. Now <span class="math display">\[\int_{\Delta C}\underline{F}\cdot d\underline{x} =
\int_0^1\underline{F}(\underline{x}+\underline{h}\,t)\cdot\underline{h}\,dt =
\underline{F}(\underline{x}+t_*\,\underline{h})\cdot\underline{h}\,,\qquad \text{for some } t^*\in [0,1]\,,\]</span> where again the last step comes from the integral form of the mean value theorem. So, we have <span class="math display">\[\begin{equation} \phi(\underline{a}+\underline{h})-\phi(\underline{a}) = \underline{F}(\underline{a})\cdot\underline{h} +
\underbrace{\underline{F}(\underline{a}+t_*\,\underline{h})\cdot\underline{h}-
\underline{F}(\underline{a})\cdot\underline{h}}_{R(\underline{h})}\textrm{.}\label{diffc} \end{equation}\]</span> Denoting the unit vector in the direction <span class="math inline">\(\underline{h}\)</span> by <span class="math inline">\(\widehat{\underline{n}}_h\)</span>, <span class="math display">\[\frac{R(\underline{h})}{|\underline{h}|}=
\left(\underline{F}(\underline{a}+t_*\,\underline{h})-\underline{F}(\underline{a})
\right)\cdot\widehat{\underline{n}}_h\]</span> which tends to zero as <span class="math inline">\(\underline{h}\to\underline{0}\)</span> if <span class="math inline">\(\underline{F}\)</span> is continuous. Hence <span class="math inline">\(\phi\)</span> is differentiable at <span class="math inline">\(\underline{a}\)</span>, and the piece linear in <span class="math inline">\(\underline{h}\)</span> allows us to identify <span class="math display">\[\underline{\nabla\mkern-2mu}\mkern 3mu \phi(\underline{a})
=\underline{F}(\underline{a})\,.\]</span></p>
<p>To conclude: if <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{F}=\underline{0}\)</span> in <span class="math inline">\(D\)</span> and <span class="math inline">\(D\)</span> is simply connected, then</p>
<p><span class="math display">\[\boxed{\,\exists\,\phi~~\textrm{s.t.}~~\underline{F} =
\underline{\nabla\mkern-2mu}\mkern 3mu \phi}\]</span> in <span class="math inline">\(D\)</span>. The function <span class="math inline">\(\phi\)</span> (or sometimes its negative) is called the <em>scalar potential</em>.</p>
<p>One more question: starting with <span class="math inline">\(\underline{F}=\underline{\nabla\mkern-2mu}\mkern 3mu \phi\)</span>, can we show path independence directly? The answer is again yes. This follows from the answer to exercise 68 on problem sheet 7, but for completeness the relevant calculation is repeated here. Let <span class="math inline">\(C\)</span> be any curve running from <span class="math inline">\(\underline{a}\)</span> to <span class="math inline">\(\underline{b}\)</span>, and <span class="math inline">\(t\mapsto \underline{x}(t)\)</span>, <span class="math inline">\(t=t_{\underline{a}}\dots t_{\underline{b}}\)</span> be any parametrisation of it, so that <span class="math inline">\(\underline{x}(t_{\underline{a}})=\underline{a}\)</span> and <span class="math inline">\(\underline{x}(t_{\underline{b}})=\underline{b}\)</span> . Then <span class="math display">\[\begin{aligned}
\int_{C}\underline{F}\cdot
d\underline{x}
&amp;=\int_{t_{\underline{b}}}^{t_{\underline{a}}}\underline{\nabla\mkern-2mu}\mkern 3mu \phi(\underline{x}(t))\cdot
\frac{d\underline{x}}{dt}\,dt\\
&amp;=\int_{t_{\underline{b}}}^{t_{\underline{a}}}\frac{\partial \phi}{\partial
x_i}\frac{dx_i}{dt}\,dt
\qquad\qquad\mbox{(Einstein notation!)}\\[2pt]
&amp;=\int_{t_{\underline{b}}}^{t_{\underline{a}}}\frac{d\phi(\underline{x}(t))}{dt}\,dt
\qquad~\,\quad\mbox{(Chain rule)}\\[4pt]
&amp;=\phi(\underline{x}(t_{\underline{a}}))-\phi(\underline{x}(t_{\underline{b}}))
\quad~~\,\mbox{(Fundamental Theorem of Calculus)}\\[4pt]
&amp;=\phi(\underline{a})-\phi(\underline{b})\,.\end{aligned}\]</span> Since we have not specified <span class="math inline">\(C\)</span> beyond giving its end points <span class="math inline">\(\underline{a}\)</span> and <span class="math inline">\(\underline{b}\)</span>, the integral is path independent.</p>
<p>Finally we can use our double ended arrows! In a simply connected region <span class="math inline">\(D\)</span>, <span class="math display">\[\boxed{\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{F}=\underline{0}\,\Leftrightarrow\,
\textrm{path independence of }I\,\Leftrightarrow\,\exists\,\phi 
\textrm{ s.t. }
\underline{F}=\underline{\nabla\mkern-2mu}\mkern 3mu \phi.}\]</span></p>
<div class="example">
<p>Compute <span class="math inline">\(I=\int_C\underline{F}\cdot d\underline{x}\)</span> for <span class="math inline">\(\underline{F}=
(y\,\cos(xy),x\,\cos(xy)-z\,\sin(yz),-y\,\sin(yz))\)</span> , where <span class="math inline">\(C\)</span> is specified by <span class="math display">\[t\mapsto \underline{x}(t)=\left(\frac{\sin(t)}{\sin(1)},
\frac{\log(1{+}t)}{\log(2)},\frac{1-e^t}{1-e}\right)\,,\quad 0\le t\le
1\,.\]</span> Answer: first note that <span class="math inline">\(\underline{x}(0)=(0,0,0)\)</span> and <span class="math inline">\(\underline{x}(1)=(1,1,1)\)</span> . Then compute <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{F}=\dots
=\underline{0}\)</span> , on all of <span class="math inline">\(\mathbb{R}^3\)</span> (which is simply connected). Hence <span class="math inline">\(\underline{F}=\underline{\nabla\mkern-2mu}\mkern 3mu \phi\)</span> for some <span class="math inline">\(\phi\)</span>. To find <span class="math inline">\(\phi\)</span> we need to solve <span class="math display">\[(1)~\phi_x=F_1\,;\qquad
(2)~\phi_y=F_2\,;\qquad
(3)~\phi_z=F_3\,.\]</span> From (1), <span class="math inline">\(\phi=\sin(xy)+f(y,z)\)</span> for some function <span class="math inline">\(f\)</span> of <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span>; then from (2), <span class="math inline">\(f(y,z)=\cos(yz)+g(z)\)</span>. Finally from (3), <span class="math inline">\(g(z)=\mbox{constant}=A\)</span>, say. Hence <span class="math display">\[\phi(x,y,z)=\sin(xy)+\cos(yz)+A\]</span> and <span class="math display">\[I=\phi(1,1,1)-\phi(0,0,0)=(\sin(1)+\cos(1)+A) - (1+A) =
\sin(1)+\cos(1)-1\,.\]</span></p>
</div>
<p><em>Some vocabulary:</em> if <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \times\underline{F}=\mathbf{0}\)</span>, <span class="math inline">\(\underline{F}\)</span> is said to be <em>closed</em>; and if <span class="math inline">\(\underline{F}=\underline{\nabla\mkern-2mu}\mkern 3mu \phi\)</span>, <span class="math inline">\(\underline{F}\)</span> is said to be <em>exact</em>. Even though it wasn’t phrased in this way, we saw in subsection <a href="#sub:applyingdeltwice" data-reference-type="ref" data-reference="sub:applyingdeltwice">4.3</a> that exact <span class="math inline">\(\Rightarrow\)</span> closed, and we have just shown that closed <span class="math inline">\(\Rightarrow\)</span> exact whenever the space <span class="math inline">\(D\)</span> on which <span class="math inline">\(\underline{F}\)</span> is defined is simply connected. However, if <span class="math inline">\(D\)</span> is not simply connected, this may fail, and the extent of this failure gives some information about the ‘shape’ (or topology) of <span class="math inline">\(D\)</span>. This features in a scene in the film ‘A beautiful mind’…</p>
<div id="eg:topology" class="example">
<p> A quick example to see what can go wrong on a non-simply connected space.</p>
<p>Let <span class="math inline">\(\underline{F}(\underline{x}) = \left( \frac{-y}{x^2 + y^2}, \frac{x}{x^2 + y^2}, 0 \right)\)</span> be a vector field defined on <span class="math inline">\(D = \mathbb{R}^3 - \{\underline{0}\}\)</span>. <span class="math inline">\(D\)</span> is a non-simply connected region, as can be seen by considering any circle around the origin. Then <span class="math inline">\(\underline{F}\)</span> is closed, since we have <span class="math display">\[\partial_x F_2 = \partial_y F_1=  \frac{y^2 - x^2}{(x^2 + y^2)^2},\]</span> and hence <span class="math inline">\(\underline{\nabla\mkern-2mu}\mkern 3mu \times \underline{F}= \underline{0}\)</span>.</p>
<p>Now consider <span class="math inline">\(\int_C \underline{F}\cdot d\underline{x}\)</span>, where <span class="math inline">\(C\)</span> is the circle of radius 1 in the <span class="math inline">\(x,y\)</span>-plane centred on the origin, which we can parameterise as <span class="math inline">\(\underline{x}(t) = (\cos(t),\sin(t),0)\)</span> for <span class="math inline">\(0\le t \le 2\pi\)</span>. Then using our standard method for computing line integrals, we have <span class="math inline">\(\frac{d\underline{x}(t)}{dt} = (-\sin(t),\cos(t),0)\)</span> and <span class="math inline">\(\underline{F}(\underline{x}(t))= (-\sin(t),\cos(t),0)\)</span>, and hence <span class="math display">\[\int_C \underline{F}\cdot d\underline{x}= \int_0^{2\pi} \underline{F}(\underline{x}(t)) \cdot \frac{d\underline{x}(t)}{dt} dt = \int_0^{2\pi}1 \,dt = 2\pi.\]</span></p>
<p>If we now consider the left and right semicircles <span class="math inline">\(C_L\)</span> and <span class="math inline">\(C_R\)</span> as shown in Figure <a href="#fig:circlelineintegral" data-reference-type="ref" data-reference="fig:circlelineintegral">54</a>, then we must have <span class="math inline">\(\int_{C_L} \underline{F}\cdot d\underline{x}\ne \int_{C_R} \underline{F}\cdot d\underline{x}\)</span>, as otherwise <span class="math inline">\(\int_C \underline{F}\cdot d\underline{x}= \int_{C_R} \underline{F}\cdot d\underline{x}- \int_{C_L} \underline{F}\cdot d\underline{x}\)</span>, in contradiction to the direct calculation we did above.</p>
<div class="center">
<figure>
<img src="Circlelineintegral.jpeg" id="fig:circlelineintegral" style="width:50.0%" alt="" /><figcaption>The curve <span class="math inline">\(C\)</span>, and the left and right semicircles <span class="math inline">\(C_L\)</span> and <span class="math inline">\(C_R\)</span>.</figcaption>
</figure>
</div>
<p>Line integrals of <span class="math inline">\(\underline{F}\)</span> on <span class="math inline">\(D\)</span> are therefore not necessarily path independent, and we cannot find a scalar field <span class="math inline">\(\phi\)</span> such that <span class="math inline">\(\underline{F}= \underline{\nabla\mkern-2mu}\mkern 3mu \phi\)</span> on <span class="math inline">\(D\)</span>. <span class="math inline">\(\underline{F}\)</span> is therefore not exact.</p>
<p>The existence of a vector field which is closed, but not exact, is due to the topology of <span class="math inline">\(D\)</span>.</p>
</div>
</section>
<section id="aside-green-rightarrow-cauchy" class="level3 unnumbered">
<h3 class="unnumbered">Aside: Green <span class="math inline">\(\Rightarrow\)</span> Cauchy</h3>
<p>One final remark, which might be relevant if you are taking the complex variable course (otherwise, don’t worry about it). In two dimensions Stokes becomes Green, stating that if <span class="math inline">\(P(x,y)\)</span> and <span class="math inline">\(Q(x,y)\)</span> are continuously differentiable on <span class="math inline">\(A\subset\mathbb{R}^2\)</span> then <span class="math display">\[\oint_{C=\partial A}P(x,y)\,dx+Q(x,y)\,dy = 
\int_A\left(\frac{\partial Q}{\partial x} -
\frac{\partial P}{\partial y} \right) dA\,.\]</span> A special (‘zero-curl’) case is the fact that that if <span class="math inline">\(P(x,y)\)</span> and <span class="math inline">\(Q(x,y)\)</span> are continuously differentiable on <span class="math inline">\(A\subset\mathbb{R}^2\)</span> and satisfy <span class="math inline">\(\frac{\partial Q}{\partial x} =
\frac{\partial P}{\partial y}\)</span> there, then <span class="math display">\[\oint_{C=\partial A}P(x,y)\,dx+Q(x,y)\,dy = 0\,.\]</span> This might remind you of Cauchy’s integral theorem, which states that if <span class="math inline">\(f:\mathbb{C}\to\mathbb{C}\)</span> is holomorphic on some region <span class="math inline">\(A\subset\mathbb{C}\)</span>, then <span class="math display">\[\oint_{C=\partial A}f(z)\,dz=0\,.\]</span> This isn’t a coincidence. In fact Cauchy is a consequence of Green, at least if <span class="math inline">\(f\)</span> is assumed to have continuous partial derivatives<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. To prove this, write <span class="math display">\[f(z)=f(x+iy)=u(x,y)+i\,v(x,y)\,.\]</span> Given that <span class="math inline">\(f\)</span> is holomorphic, the following (Cauchy-Riemann) equations hold: <span class="math display">\[\frac{\partial u}{\partial x}=
\frac{\partial v}{\partial y}~~~\mbox{(CR1)}\,;\qquad
\frac{\partial u}{\partial y}=
-\frac{\partial v}{\partial x}~~~\mbox{(CR2)}\,.\]</span> Since <span class="math inline">\(dz=dx+i\,dy\)</span>, we have <span class="math display">\[\oint_Cf(z)\,dz =
\oint_C(u+iv)\,(dx+i\,dy) =
\oint_C(u\,dx-v\,dy) + i \oint_C(v\,dx+u\,dy)\,.\]</span> Using Green with <span class="math inline">\(P=u\)</span> and <span class="math inline">\(Q=-v\)</span> the first integral on the right-hand side can be rewritten as <span class="math display">\[\oint_C(u\,dx-v\,dy) = \int_A\left(-\frac{\partial v}{\partial x} -
\frac{\partial u}{\partial y}\right) dA\]</span> which vanishes since the integrand on the RHS is zero by (CR2). Likewise the second integral is <span class="math display">\[\oint_C(v\,dx+u\,dy) = \int_A\left(\frac{\partial u}{\partial x} -
\frac{\partial v}{\partial y}\right) dA\]</span> and this is also zero, by (CR1). Hence <span class="math inline">\(\oint_Cf(z)\,dz =0\)</span>, as stated by Cauchy.</p>
</section>
</section>
<section id="sec:Jac" class="level2" data-number="9.5">
<h2 data-number="8.5"><span class="header-section-number">8.5</span> Changing integration variables</h2>
<p>Simply put, changing variables can make life easier. How and why a change of variables makes calculations easier can be seen by revisiting example <a href="#circeg" data-reference-type="ref" data-reference="circeg">[circeg]</a>, but this time, somewhat perversely, using Cartesian coordinates:</p>
<div id="eg:polar" class="example">
<p> Integrate <span class="math inline">\(f(x,y)=x^2+y^2\)</span> over the unit disc, using Cartesian coordinates.</p>
<div class="center">
<figure>
<img src="circle.jpg" id="fig:circle" style="width:50.0%" alt="" /><figcaption> The region of integration is the area between two curves, which together make a circle.</figcaption>
</figure>
</div>
<p>The equation of a unit circle is given implicitly by <span class="math inline">\(x^2+y^2=1\)</span>, but in order to perform our iterated integral (with respect to <span class="math inline">\(y\)</span> first) we must consider the upper and lower halves of the circle as individual curves given by <span class="math inline">\(y=\sqrt{1-x^2}\)</span> and <span class="math inline">\(y=-\sqrt{1-x^2}\)</span> respectively, with <span class="math inline">\(-1\le x\le 1\)</span>. <span class="math display">\[\begin{aligned}
\int_{-1}^1\int_{-\sqrt{1-x^2}}^{\sqrt{1-x^2}}(x^2+y^2)\,dy\,dx
&amp;=\int_{-1}^1
\left[x^2y+{\textstyle\frac{1}{3}}y^3\right]_{-\sqrt{1-x^2}}^{\sqrt{1-x^2}}dx
=\int_{-1}^{1}{\textstyle\frac{2}{3}}(1+2x^2)\sqrt{1-x^2}\,dx\\[2pt]
&amp;\textrm{Using the substitution $x=\sin\theta$,
$\sqrt{1-x^2}dx=\cos^2\theta\,d\theta$:}\\
&amp;=\int_{-\frac{\pi}{2}}^{\frac{\pi}{2}}
{\textstyle\frac{2}{3}}(\cos^2\theta+2\sin^2\theta\cos^2\theta)\,d\theta\\
&amp;\textrm{Use trig double angle identities to simplify and get:}\\
&amp;={\textstyle\frac{2}{3}}\int_{-\frac{\pi}{2}}^{\frac{\pi}{2}}
({\textstyle\frac{3}{4}}+{\textstyle\frac{1}{2}}\cos 2\theta-{\textstyle\frac{1}{4}}\cos 4\theta)\,d\theta\\
&amp;=
\left[{\textstyle\frac{1}{2}}\theta
+{\textstyle\frac{1}{6}}\sin 2\theta
-{\textstyle\frac{1}{24}}\sin 4\theta
\right]_{-\frac{\pi}{2}}^{\frac{\pi}{2}}
\,=\,{\textstyle\frac{1}{2}}\pi\,.\end{aligned}\]</span></p>
<p>That was quite hard work, so let’s recap on how changing variables can simplify life. We’ll change to polar coordinates: <span class="math inline">\((x,y)\to(r,\theta)\)</span> where <span class="math inline">\(x=r\cos\theta\)</span>, <span class="math inline">\(y=r\sin\theta\)</span>. Our limits must also change to <span class="math inline">\(0\le r\le 1\)</span>, <span class="math inline">\(0\le\theta\le 2\pi\)</span>, and also <span class="math inline">\(dA=rdrd\theta\)</span>; we will see later why this is so. This form of <span class="math inline">\(dA\)</span> is very important and the extra <span class="math inline">\(r\)</span>, which may look out of place, is crucial. Therefore we can write: <span class="math display">\[\begin{aligned}
\int_{-1}^1\int_{-\sqrt{1-x^2}}^{\sqrt{1-x^2}}(x^2+y^2)\,dy\,dx 
&amp;=\int_0^{2\pi}\int_0^1 r^3 drd\theta\\[2pt]
&amp;=\int_0^{2\pi} \left[{\textstyle\frac{1}{4}}r^4\right]_0^1d\theta
=\left[{\textstyle\frac{1}{4}}\theta\right]_0^{2\pi} \,=\, {\textstyle\frac{1}{2}}\pi\,.\end{aligned}\]</span></p>
</div>
<p>The change of variables made our computation much simpler, but how do we change from one set of variables to another in general? A change of variables is a change of coordinate systems, and usually (though not always) the good choice is pretty obvious – e.g. if you are dealing with a circular area of integration, polar coordinates will probably be best. One further word of warning: if we start with two variables in the integration (e.g. <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>) then we need to keep two variables free after the coordinate change (e.g. <span class="math inline">\(r\)</span>, <span class="math inline">\(\theta\)</span>). So NEVER, when changing variables to make an integration easier, substitute actual values for the variables (so NEVER do this: <span class="math inline">\(r=3\)</span>)!!! The values are for the integration limits.</p>
<p><strong>This small section is to give some intuition for what will follow:</strong></p>
<p>We briefly look at the change from Cartesian coordinates to polar coordinates from a geometric point of view before giving the general method.</p>
<div class="center">
<figure>
<img src="arc.jpg" id="fig:arc" style="width:50.0%" alt="" /><figcaption> A small area <span class="math inline">\(dA\)</span> in terms of polar coordinates, i.e. small changes in <span class="math inline">\(r\)</span> and <span class="math inline">\(\theta\)</span> instead of in <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</figcaption>
</figure>
</div>
<p>If we start at the point <span class="math inline">\(B=(r,\theta)\)</span> on the diagram shown in figure <a href="#fig:arc" data-reference-type="ref" data-reference="fig:arc">56</a>, small increases in <span class="math inline">\(r\)</span> and <span class="math inline">\(\theta\)</span> will give us the region traced out by the points <span class="math inline">\(B=(r,\theta)\)</span>, <span class="math inline">\(C=(r+dr,\theta)\)</span>, <span class="math inline">\(D=(r+dr,\theta +d\theta)\)</span> and <span class="math inline">\(E=(r,\theta+d\theta)\)</span>. When <span class="math inline">\(d\theta\)</span> and <span class="math inline">\(dr\)</span> are very small we can approximate this by a rectangle, and its area <span class="math inline">\(dA\)</span> is approximately equal to the product of the lengths <span class="math inline">\(|BC|\)</span> and <span class="math inline">\(|BE|\)</span>. It is clear that <span class="math inline">\(|BC| = dr\)</span>, while <span class="math inline">\(|BE|\)</span> is approximately equal to the length of the corresponding circular arc, which can be obtained by considering it as a proportion of the full circumference, <span class="math inline">\(C=2\pi r\)</span>. The proportion is simply given by the ratio of the angle of the arc to that of the whole circle, so <span class="math inline">\(|BE|=2\pi r \frac{d\theta}{2\pi} = rd\theta\)</span> and the infinitesimal area is given by <span class="math display">\[\begin{equation} \label{eqn:arc}
dA = |BC||BE| = rdrd\theta\,. \end{equation}\]</span> You can also see that this holds by calculating the area of the sector <span class="math inline">\(OCDO\)</span> and subtracting the area of <span class="math inline">\(OBEO\)</span>, and then neglecting higher order terms as they become negligible when <span class="math inline">\(dr\)</span> is small: <span class="math inline">\(dA=\frac{d\theta}{2\pi}(\pi (r+dr)^2-\pi r^2)\sim r dr d\theta\)</span>.</p>
<p><strong>Now back to the general case:</strong></p>
<p>In the above example the change of variables from <span class="math inline">\((x,y)\)</span> to <span class="math inline">\((r,\theta)\)</span> was (apart from the special point at the origin, which is exceptional enough to be ignored) a diffeomorphism from one set of coordinates to another. Consider a general diffeomorphism <span class="math inline">\(\underline{v}: U\to
V=\underline{v}(U)\)</span>, with inverse <span class="math inline">\(\underline{w}\)</span>, and suppose that <span class="math inline">\(V\)</span>, with coordinates <span class="math inline">\((x,y)\)</span>, is an area over which we wish to integrate some scalar field <span class="math inline">\(f\)</span>: <span class="math inline">\(V\to\mathbb{R}\)</span>. The big picture is shown in figure <a href="#fig:diffeo" data-reference-type="ref" data-reference="fig:diffeo">58</a> (a), while figure <a href="#fig:diffeo" data-reference-type="ref" data-reference="fig:diffeo">58</a> (b) zooms in on a single infinitesimal area element in <span class="math inline">\(U\)</span> and its image in <span class="math inline">\(V\)</span>.</p>
<table id="fig:diffeo" class="imageTable">
<caption> On the left is a diffeomorphism, <span class="math inline">\(\underline{v}\)</span>, and its inverse, <span class="math inline">\(\underline{w}\)</span>, mapping to and from an area of integration <span class="math inline">\(V\)</span>. On the right are infinitesimal areas in the coordinate systems <span class="math inline">\((u,v)\in U\)</span> (lower) and <span class="math inline">\((x,y)\in V\)</span> (upper). Note that the transformation illustrated is rather special in that small squares in <span class="math inline">\(U\)</span> are mapped to small squares in <span class="math inline">\(V\)</span> – it is a <em>conformal</em> mapping. In general the image of a small square in <span class="math inline">\(U\)</span> would be a parallelogram in <span class="math inline">\(V\)</span>.</caption>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="diffeo1.jpg" title="fig:" id="fig:diffeo" style="width:45.0%" alt=" On the left is a diffeomorphism, \underline{v}, and its inverse, \underline{w}, mapping to and from an area of integration V. On the right are infinitesimal areas in the coordinate systems (u,v)\in U (lower) and (x,y)\in V (upper). Note that the transformation illustrated is rather special in that small squares in U are mapped to small squares in V – it is a conformal mapping. In general the image of a small square in U would be a parallelogram in V." /></td>
<td style="text-align: center;"><img src="diffeo2.jpg" title="fig:" id="fig:diffeo" style="width:45.0%" alt=" On the left is a diffeomorphism, \underline{v}, and its inverse, \underline{w}, mapping to and from an area of integration V. On the right are infinitesimal areas in the coordinate systems (u,v)\in U (lower) and (x,y)\in V (upper). Note that the transformation illustrated is rather special in that small squares in U are mapped to small squares in V – it is a conformal mapping. In general the image of a small square in U would be a parallelogram in V." /></td>
</tr>
<tr class="even">
<td style="text-align: center;">(a)</td>
<td style="text-align: center;">(b)</td>
</tr>
</tbody>
</table>
<p>The integral of <span class="math inline">\(f\)</span> over <span class="math inline">\(V\)</span> can be found as the limit of a Riemann sum using the initial integration variables <span class="math inline">\((x,y)\in V\)</span>, as in section <a href="#sub:fubini" data-reference-type="ref" data-reference="sub:fubini">[sub:fubini]</a>: <span class="math display">\[\begin{align}
I 
&amp;= \int_V f(x,y)\,dxdy\\
% \label{eqn:genI}
&amp;= \lim\limits_{N\to\infty}\sum\limits_{k=0}^N f(\underline{x}_k^*)\,\Delta A_k\\
&amp;= \lim \limits_{\Delta x_{i},\,\Delta y_{j}\to 0}\sum\limits_{i,j}
f(\underline{x}_{ij}^*)\, \Delta x_{i}\Delta y_{j}\,.\end{align}\]</span> where the choice of partition of <span class="math inline">\(V\)</span> is taken to be parallel to the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> axes in <span class="math inline">\(V\)</span>, i.e. <span class="math inline">\(\Delta A_k = \Delta x_{i}\Delta y_{j}\)</span>.</p>
<p>However, the value of the integral does not depend on the partition taken to compute it, so let us use another one, the image under <span class="math inline">\(\underline{u}\)</span> of a partition of <span class="math inline">\(U\)</span> parallel to the <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> axes in <span class="math inline">\(U\)</span>. From the lower panel of figure <a href="#fig:diffeo" data-reference-type="ref" data-reference="fig:diffeo">58</a> (b), a typical area element from such a partition can be specified by its lower left, lower right, and upper left corners, which have position vectors <span class="math inline">\((u,v)\)</span>, <span class="math inline">\((u+du,v)\)</span>, and <span class="math inline">\((u,v+dv)\)</span> respectively.</p>
<p>These three corners are mapped to the points <span class="math inline">\(\underline{v}(u,v)\)</span>, <span class="math inline">\(\underline{v}(u+du,v)\)</span>, and <span class="math inline">\(\underline{v}(u,v+dv)\)</span> in <span class="math inline">\(V\)</span> by the diffeomorphism <span class="math inline">\(\underline{v}\)</span>, which define the in general skewed area element <span class="math inline">\(dA_k\)</span> in <span class="math inline">\(V\)</span>. As this area element is small we can treat it as an approximate parallelogram and compute its area via the cross product of vectors along two neighbouring sides (temporarily embedding the <span class="math inline">\(x\)</span>,<span class="math inline">\(y\)</span> plane into <span class="math inline">\(\mathbb{R}^3\)</span> in order to define the cross product). Thus <span class="math display">\[\begin{aligned}
\Delta A_k &amp;\approx  \Vert
(\underline{v}(u+du,v)-\underline{v}(u,v))
\times (\underline{v}(u,v+du)-\underline{v}(u,v))
\Vert\quad\mbox{(area of parallelogram)}\\
&amp;\approx  
\Vert du \frac{\partial \underline{v}}{\partial u}
\times dv \frac{\partial \underline{v}}{\partial v}\Vert
\qquad\qquad\qquad\,\mbox{(from the definition of the
partial derivatives)}\\
&amp;= |\,
\left|\begin{array}{ccc}
\underline{e_1}&amp;\underline{e_2}&amp;\underline{e_3}\\[2pt]
\frac{\partial v_1}{\partial u}&amp;\frac{\partial v_2}{\partial u}&amp;0\\[4pt]
\frac{\partial v_1}{\partial v}&amp;\frac{\partial v_2}{\partial v}&amp;0
\end{array}\right|\,| ~du\,dv
\qquad\mbox{(definition of cross product)}\\[3pt]
&amp;=
|\,
\left| \begin{array}{cc}
\frac{\partial v_1}{\partial u}&amp;\frac{\partial v_2}{\partial u}\\[3pt]
\frac{\partial v_1}{\partial v}&amp;\frac{\partial v_2}{\partial v}
\end{array}\right|\,| ~du\,dv
\qquad\qquad\mbox{(expanding out the determinant)}\\[3pt]
&amp;=
|\,\left| \begin{array}{cc}
\frac{\partial v_1}{\partial u}&amp;\frac{\partial v_1}{\partial v}\\[3pt]
\frac{\partial v_2}{\partial u}&amp;\frac{\partial v_2}{\partial v}
\end{array}\right|\,| ~du\,dv
\qquad\qquad\mbox{(rearranging using properties of $2\times 2$ determinants)}
\\[2pt]
&amp;= |J(\underline{v})|\,du\,dv \,,\end{aligned}\]</span> where <span class="math inline">\(J(\underline{v})\)</span> is the Jacobian matrix of the transformation <span class="math inline">\(\underline{v}\)</span>. Now that we have calculated the area element under the diffeomorphism we can recalculate the integral using a Riemann sum with our new partition, with <span class="math inline">\(\Delta A_{k} =
|J(\underline{v})|\,du\,dv\)</span> :<br />
<span class="math display">\[\begin{aligned}
I &amp;=
\lim\limits_{N\to\infty}\sum\limits_{k=0}^N 
f(\underline{v}(u_k^*,v_k^*))\,\Delta A_k\\
&amp;= 
\lim\limits_{du_{i}dv_{j}\to 0}
\sum\limits_{i,j}f(\underline{v}(u_k^*,v_k^*))\,|J(\underline{v})|\,du_idv_j\\
&amp;=
\int_{U}f(\underline{v}(u,v))\,|J(\underline{v})|\,du\,dv\,.\end{aligned}\]</span> Note that <span class="math inline">\(U=\underline{w}(V)\)</span> is the area of integration in the new coordinate system, and that the limits of integration must be altered accordingly.</p>
<p>Let’s use this result to check the form of <span class="math inline">\(dA\)</span> used in example <a href="#circeg" data-reference-type="ref" data-reference="circeg">[circeg]</a>. In this case our ‘<span class="math inline">\(V\)</span>’ coordinates were <span class="math inline">\((x,y)\)</span> and our ‘<span class="math inline">\(U\)</span>’ ones were <span class="math inline">\((r,\theta)\)</span> with <span class="math inline">\(x=r\cos\theta\)</span>, <span class="math inline">\(y=r\sin\theta\)</span>, and so <span class="math display">\[\begin{aligned}
dA_{new} &amp;= |J(\underline{v})| \,dr\,d\theta  \\[2pt]
&amp;= 
% drd\theta \,
|\,\left|
\begin{array}{cc}
\frac{\partial x}{\partial r}&amp;\frac{\partial x}{\partial
\theta}\\[3pt]
\frac{\partial y}{\partial r}&amp;\frac{\partial
y}{\partial\theta}\end{array}\right|\,| ~dr\,d\theta\\[2pt]
&amp;=|\, \left|\begin{array}{cc}\cos\theta &amp; -r\sin\theta\\
\sin\theta &amp;r\cos\theta \end{array}\right| \,| ~dr\,d\theta\\
&amp;=r\,dr\,d\theta \,.\end{aligned}\]</span> This is the formula quoted in example <a href="#circeg" data-reference-type="ref" data-reference="circeg">[circeg]</a> and agrees with equation <span class="math inline">\(\eqref{eqn:arc}\)</span>. The Jacobian allows us to convert complicated integrals into easier ones by means of a variable change.</p>
<p>In summary:<br />
<span class="math display">\[\boxed{dA=dxdy = |J|\,du\,dv}\]</span></p>
<p>Changing variables for volume (triple) integrals is very similar to double integrals. Again we assume that there is a diffeomorphism <span class="math inline">\(\underline{U}\)</span> which maps the volume between the two coordinate systems <span class="math inline">\((W_1, W_2, W_3)\)</span> and <span class="math inline">\((U_1, U_2, U_3)\)</span>, and an inverse <span class="math inline">\(\underline{W}\)</span> which maps in the other direction, from <span class="math inline">\((U_1, U_2, U_3)\)</span> to <span class="math inline">\((W_1, W_2, W_3)\)</span>.</p>
<p>Then, much as before, <span class="math display">\[\int_V f(\underline{W})\,dW_1\,dW_2\,dW_3 =
\int_{\underline{U}(V)}f(\underline{W}(\underline{U}))\,|J(\underline{W})|\,dU_1\,dU_2\,dU_3\,,\]</span> where <span class="math inline">\(|J(\underline{W})|\)</span> is the magnitude of Jacobian, and <span class="math inline">\(J\)</span>, the Jacobian matrix or differential, is now the determinant of a 3-by-3 matrix of partial derivatives: <span class="math display">\[|J(\underline{W})| = |\left|\begin{array}{ccc}
\frac{\partial W_1}{\partial U_1}&amp;\frac{\partial W_1}{\partial
U_2}&amp;\frac{\partial W_1}{\partial U_3}\\[3pt]
\frac{\partial W_2}{\partial U_1}&amp;\frac{\partial W_2}{\partial
U_2}&amp;\frac{\partial W_2}{\partial U_3}\\[3pt]
\frac{\partial W_3}{\partial U_1}&amp;\frac{\partial W_3}{\partial
U_2}&amp;\frac{\partial W_3}{\partial U_3}\\
\end{array}\right||\,.\]</span></p>
<p>For example, for the usual Cartesian <span class="math inline">\(\longrightarrow\)</span> Spherical Polars coordinate change, take <span class="math inline">\(\underline{W}(r,\theta,\phi) = (x,y,z) = (r\sin\theta\cos\phi, r\sin\theta\sin\phi,
r\cos\theta)\)</span> and <span class="math inline">\(\underline{U} = (r, \theta, \phi)\)</span>. As can be calculated (exercise!), the magnitude of the Jacobian of this mapping is <span class="math inline">\(|J| = r^2\sin\theta\)</span>.</p>
<p>Just to re-iterate, this is a change of variables in all three dimensions (and NOT a parametrisation of a surface), so we need all three coordinates. We only fix <span class="math inline">\(r\)</span> to specific values in, for example, the limits of an integration.</p>
<div class="example">
<p>Let us use the coordinate change to re-evaluate the volume of a sphere of radius <span class="math inline">\(a\)</span>, found before in bonus example <a href="#spherevol" data-reference-type="ref" data-reference="spherevol">[spherevol]</a>: <span class="math display">\[\begin{aligned}
\int_V dV&amp;=\int_0^{2\pi}\int_0^{\pi}\int_0^a
r^2\sin\theta\,dr\,d\theta\,d\phi\\[2pt]
&amp;=\int_0^{2\pi}\int_0^{\pi} \frac{a^3}{3}\sin\theta\,d\theta\,d\phi\\[2pt]
&amp;=\int_0^{2\pi}\frac{2a^3}{3}\,d\phi
=\frac{4\pi a^3}{3}\,.\end{aligned}\]</span> This agrees with our previous calculation but the steps were fewer and easier!</p>
</div>
<p>One last example:</p>
<div class="example">
<p>Integrate <span class="math inline">\(f(x,y)=x^2+y^2\)</span> over the square shown in figure <a href="#fig:sqr" data-reference-type="ref" data-reference="fig:sqr">59</a>.</p>
<div class="center">
<figure>
<img src="sqr.jpg" id="fig:sqr" style="width:50.0%" alt="" /><figcaption> The area of integration, a square with sides of length <span class="math inline">\(\sqrt{2}\)</span>, shown with old coordinates <span class="math inline">\((x,y)\)</span> and new ones <span class="math inline">\((u,v)\)</span>.</figcaption>
</figure>
</div>
<p>Doing this in Cartesian coordinates <span class="math inline">\((x,y)\)</span> is possible, but would involve splitting the integral into two and having limits which are functions, for example <span class="math display">\[I = \int_0^1\int_{y=-x}^{y=x} (x^2+y^2)\,dy\,dx +
\int_1^2\int_{y=x-2}^{y=-x+2}(x^2+y^2)\,dy\,dx\textrm{.}\]</span> If we instead use coordinates <span class="math inline">\((u,v)\)</span>, which are given by taking the axes starting at the origin, along the sides of the square labelled <span class="math inline">\(u=0\)</span>, <span class="math inline">\(v=0\)</span>, we get a transformation <span class="math inline">\(x+y=u\)</span>, <span class="math inline">\(x-y=v\)</span>. This gives us <span class="math inline">\(x=\frac{1}{2}(u+v)\)</span> and <span class="math inline">\(y=\frac{1}{2}(u-v)\)</span>, which we can use to find the absolute value of the Jacobian: <span class="math display">\[|J| \,=\, |\,\left|\begin{array}{cc}\frac{\partial x}{\partial u} &amp;
\frac{\partial x}{\partial v}\\[3pt]
\frac{\partial y}{\partial u}&amp;\frac{\partial y}{\partial v}
\end{array}\right|\,| \,=\, |-\frac{1}{2}|\,=\,\frac{1}{2}\,.\]</span> So now we have the easier integral <span class="math display">\[I \,=\, 
\int_0^2\int_0^2 \frac{1}{2}(u^2+v^2)\frac{1}{2}\,du\,dv \,=\,
\int_0^2\int_0^2 \frac{1}{2}u^2\,du\,dv \,=\,
\frac{8}{3}\,.\]</span> Note this illustrates the need to take the absolute value of the Jacobian when changing variables – clearly the integral must be positive since it is the integral of an everywhere-positive function, while our answer would have been negative if we had used <span class="math inline">\(J\)</span> instead of <span class="math inline">\(|J|\)</span> in the above.</p>
</div>
</section>
</section>
<section id="sec:proofs" class="level1" data-number="10">
<h1 data-number="9"><span class="header-section-number">9</span> Proofs of the three big theorems (Non-Examinable)</h1>
<p>In this chapter we return to the ‘big three’ theorems, and indicate how they can be proved. We’ll begin with Green’s theorem, and work up from there. Don’t worry about memorising these proofs, but instead try to understand how they work. The chapter also includes a number of further examples which you may find useful in your revision.</p>
<section id="greens-theorem-in-the-plane" class="level2" data-number="10.1">
<h2 data-number="9.1"><span class="header-section-number">9.1</span> Green’s theorem in the plane</h2>
<p>Recall that the ‘coordinate’ version of the theorem reads as follows. Suppose <span class="math inline">\(P(x,y)\)</span> and <span class="math inline">\(Q(x,y)\)</span>, <span class="math inline">\((x,y)\in\mathbb{R}^2\)</span>, are continuously differentiable scalar fields in 2 dimensions, and suppose that <span class="math inline">\(C\)</span> is a simple closed curve in the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane, traversed anticlockwise and surrounding an area <span class="math inline">\(A\)</span>. Then <span class="math display">\[\begin{equation} % \label{eqn:greenproof}
\boxed{\,\oint_C (P(x,y)dx + Q(x,y)dy) = \int_A
\bigl(\frac{\partial Q}{\partial x} - \frac{\partial P}{\partial
y}\bigr)\,dx\,dy\,,\,} \end{equation}\]</span></p>
<table id="fig:greenproof" class="imageTable">
<caption> Area of integration, A, with boundary C. Plot (a) shows the curve split into left and right sections <span class="math inline">\(x=h_L(y)\)</span>, <span class="math inline">\(x=h_R(y)\)</span>, while plot (b) shows the curve split into upper and lower sections <span class="math inline">\(y = g_U(x)\)</span> and <span class="math inline">\(y = g_L(x)\)</span>.</caption>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="green2.png" title="fig:" id="fig:greenproof" style="width:50.0%" alt=" Area of integration, A, with boundary C. Plot (a) shows the curve split into left and right sections x=h_L(y), x=h_R(y), while plot (b) shows the curve split into upper and lower sections y = g_U(x) and y = g_L(x)." /></td>
<td style="text-align: center;"><img src="green.png" title="fig:" id="fig:greenproof" style="width:50.0%" alt=" Area of integration, A, with boundary C. Plot (a) shows the curve split into left and right sections x=h_L(y), x=h_R(y), while plot (b) shows the curve split into upper and lower sections y = g_U(x) and y = g_L(x)." /></td>
</tr>
<tr class="even">
<td style="text-align: center;">(a)</td>
<td style="text-align: center;">(b)</td>
</tr>
</tbody>
</table>
<p><strong>Proof of Green’s theorem in the plane:</strong> We’ll make the additional assumption that the area <span class="math inline">\(A\)</span> is both horizontally and vertically simple, meaning that each point in <span class="math inline">\(A\)</span> lies between exactly two boundary points (on <span class="math inline">\(C\)</span>) to its left and right, and also between exactly two boundary points above and below, as illustrated in figure <a href="#fig:greenproof" data-reference-type="ref" data-reference="fig:greenproof">61</a>. We’ll start with the right hand side of the theorem and look at the two terms, which we’ll label as 1⃝ and 2⃝, separately, remembering that we can interchange the order of integration by Fubini’s Theorem, and splitting up the integration region and its bounding curve in the two ways shown in the figure. We have <span class="math display">\[\begin{aligned}
RHS &amp;= 
\int_A \frac{\partial Q}{\partial
x}\,dx\,dy \,-\int_A\frac{\partial
P}{\partial y}\,dx\,dy\\[7pt]
&amp;=\underbrace{\int_A \frac{\partial Q}{\partial
x}\,dx\,dy}_{\text{\textcircled{1}}} \,\underbrace{-\,\int_A\frac{\partial
P}{\partial y}\,dy\,dx}_{\text{\textcircled{2}}}\end{aligned}\]</span> where Fubini’s theorem was used to swap the order of integration in the second term in going from the first to the second line. Now evaluating the two terms in turn, <span class="math display">\[\begin{aligned}
\textrm{\textcircled{1}}&amp;=\int_{y-}^{y+}\int_{h_L(y)}^{h_R(y)}\frac{\partial
Q}{\partial x}dx\,dy
= \int_{y-}^{y+} \Bigl[ Q(x,y)\Bigr]_{h_L(y)}^{h_R(y)}\,dy\\
&amp;= \int_{y-}^{y+} (Q(h_R,y)-Q(h_L,y))\,dy \quad\qquad~~\mbox{(now split the
integral)}\\
&amp;= \int_{y-}^{y+} Q(h_R,y)\,dy + \int_{y+}^{y-}
Q(h_L,y)\,dy\quad\mbox{(note change of limits in $2^{\rm nd}$ integral)}\\
&amp;= \oint_C Q\,dy\,.\end{aligned}\]</span></p>
<p>We follow a similar argument for 2⃝: <span class="math display">\[\begin{aligned}
\textrm{\textcircled{2}}
&amp;=&amp;\int_{x-}^{x+}\int_{g_L(x)}^{g_U(x)}-\frac{\partial P}{\partial y}dydx
\,=\, \int_{x-}^{x+} \Bigl[ -P(x,y)\Bigr]_{g_L(x)}^{g_U(x)}\,dx\\
&amp;=&amp; \int_{x-}^{x+} (-P(x,g_U)+P(x,g_L))\,dx \quad\qquad\mbox{(now split
the integral)}\\
&amp;=&amp; \int_{x+}^{x-} P(x,g_U)\,dx + \int_{x-}^{x+}
P(x,g_L)\,dx\quad\mbox{(note change of limits in $1^{\rm st}$ integral)}\\
&amp;=&amp; \oint_C P\,dx\,.\end{aligned}\]</span> The last steps in both calculations (1⃝ and 2⃝) are made using the fact that the curve <span class="math inline">\(C\)</span> can be split as in the diagram, i.e. <span class="math inline">\(C = h_L(y)\cup h_R(y) = g_U(x)\cup
g_L(x)\)</span>.</p>
<p>Finally we can bring 1⃝ and 2⃝ back together to see that 1⃝+2⃝ = LHS, as required by the theorem. (To prove the theorem for more complicated regions, divide it up into subregions first, and then add the results, noting that line integrals on bits of boundaries shared by two subregions will be traversed in opposite directions, and hence cancel.)</p>
</section>
<section id="stokes-theorem" class="level2" data-number="10.2">
<h2 data-number="9.2"><span class="header-section-number">9.2</span> Stokes’ theorem</h2>
<p>Stokes’ theorem generalises Green’s theorem in the plane, relating an integral over a surface <span class="math inline">\(S\)</span>, now in <span class="math inline">\(\mathbb{R}^3\)</span>, to the line integral over the boundary of <span class="math inline">\(S\)</span>, <span class="math inline">\(C\)</span>. This is most clearly seen by writing Green’s theorem in vector form as <span class="math display">\[\oint_C \underline{F}\cdot d\underline{x} = \int_A (\nabla\times
\underline{F})\cdot\underline{e}_3\,dx\,dy\,,\]</span> where <span class="math inline">\(\underline{e}_3\)</span> is the unit vector in the <span class="math inline">\(z\)</span> direction, <span class="math inline">\(\underline{F}(x,y,z) =
(P(x,y),Q(x,y),R)\)</span>, <span class="math inline">\(A\)</span> is a region in the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane, and <span class="math inline">\(C\)</span> is the curve which bounds <span class="math inline">\(A\)</span>, traversed anticlockwise when viewed from above.</p>
<p>Stokes’ looks much the same: <span class="math display">\[\boxed{\,\oint_C \underline{F}\cdot d\underline{x} = \int_S (\nabla\times
\underline{F})\cdot d\underline{A}\, }\]</span> where <span class="math inline">\(\underline{F}(x,y,z)\)</span> is now <em>any</em> continuously differentiable vector field in <span class="math inline">\(\mathbb{R}^3\)</span> and <span class="math inline">\(S\subset\mathbb{R}^3\)</span> is a smooth oriented surface which is bounded by the closed curve <span class="math inline">\(C\)</span>. As before, <span class="math inline">\(d\underline{A}\)</span> is shorthand for <span class="math inline">\(\widehat{\underline{n}}\,dA\)</span>, and <span class="math inline">\(\widehat{\underline{n}}\)</span> is a unit vector normal to the surface at the location of the area element <span class="math inline">\(dA\)</span>, pointing up when viewed from the side of the surface from which <span class="math inline">\(C\)</span> appears to be traversed anticlockwise.</p>
<p>Put simply, Stokes’ theorem relates the microscopic circulation (curl), of some quantity <span class="math inline">\(\underline{F}\)</span> on a surface to the total circulation around the boundary of that surface. As a warm-up to the full proof, let’s start by looking at this intuitively without specific vector fields or surfaces.</p>
<table id="fig:circ" class="imageTable">
<caption> Sketches of two vector fields over a surface. The black arrows represent the vector field and the red arrows the direction of the line integral around the boundary of the surface. Sketch (a) has the line integral approximately zero while for sketch (b) it is positive.</caption>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="circ1.png" title="fig:" id="fig:circ" style="width:50.0%" alt=" Sketches of two vector fields over a surface. The black arrows represent the vector field and the red arrows the direction of the line integral around the boundary of the surface. Sketch (a) has the line integral approximately zero while for sketch (b) it is positive." /></td>
<td style="text-align: center;"><img src="circ2.png" title="fig:" id="fig:circ" style="width:50.0%" alt=" Sketches of two vector fields over a surface. The black arrows represent the vector field and the red arrows the direction of the line integral around the boundary of the surface. Sketch (a) has the line integral approximately zero while for sketch (b) it is positive." /></td>
</tr>
<tr class="even">
<td style="text-align: center;">(a)</td>
<td style="text-align: center;">(b)</td>
</tr>
</tbody>
</table>
<p>Figure <a href="#fig:circ" data-reference-type="ref" data-reference="fig:circ">63</a> (adapted from <a href="http://www.youtube.com/watch?v=9iaYNaENVH4">http://www.youtube.com/watch?v=9iaYNaENVH4</a>) shows two vector fields over a surface and its bounding curve. The line integral part of Stokes’ theorem, <span class="math inline">\(\oint_C
\underline{F}\cdot d\underline{x}\)</span>, has been split into four sections, one along each edge of the surface. The orientation of the line integral has been chosen to be positive and is shown with red arrows.</p>
<p>Looking at the bottom of sketch (a), we see that field lines and path element <span class="math inline">\(d\underline{x}\)</span> are aligned therefore the dot product will be positive, along left and right sides respectively the field lines and <span class="math inline">\(d\underline{x}\)</span> are perpendicular therefore the line integral here contributes nothing, finally along the top field lines and <span class="math inline">\(d\underline{x}\)</span> are in opposite directions therefore giving us a negative dot product. Adding these to get the overall line integral will give us zero (or close to) as the top and bottom sections cancel each other. This is in agreement with what we would expect from the surface integral part of Stokes’ theorem, <span class="math inline">\(\int_S (\nabla\times\underline{F})\cdot\underline{dA}\)</span>, since the homogeneous field lines will not induce any rotation, so <span class="math inline">\(\nabla\times\underline{F} = 0\)</span>.</p>
<p>Conversely for the field shown in sketch (b), at all 4 sections of the line integral the field lines are parallel to <span class="math inline">\(d\underline{x}\)</span> and so the dot product will produce a positive result, making the overall line integral positive. Again this agrees with the surface integral part of Stokes’ theorem as the circular field lines will induce a rotation and so a positive curl, which in turn will cause the surface integral to be positive.</p>
<p>This is a very rough argument, far from a proof, but with any luck you can see how it might be that the surface integral of the curl of a vector field over <span class="math inline">\(S\)</span> is related to the line integral of the vector field around the bounding curve <span class="math inline">\(C\)</span>. Now for a more rigorous proof.</p>
<p><strong>Proof of Stokes’ theorem:</strong> The basic setup is a differentiable vector field, <span class="math inline">\(\underline{F}(x,y,z)\)</span>, and a surface <span class="math inline">\(S\subset\mathbb{R}^3\)</span> bounded by a closed curve <span class="math inline">\(C\)</span>, as shown in figure <a href="#fig:stoke" data-reference-type="ref" data-reference="fig:stoke">64</a>.</p>
<p>The surface <span class="math inline">\(S\)</span> can be described parametrically by a continuously differentiable map <span class="math inline">\(\underline{x}(u,v):U\to\mathbb{R}^3\)</span> with <span class="math inline">\(\underline{x}(u,v)=(x_1(u,v),x_2(u,v),x_3(u,v))\)</span> . If the boundary of the parameter domain <span class="math inline">\(U\subset\mathbb{R}^2\)</span> is a closed curve <span class="math inline">\(\widetilde C\)</span>, given parametrically as <span class="math inline">\(\underline{u}(t)=(u(t),v(t))\)</span>, <span class="math inline">\(t_1\le t\le t_2\)</span>, then the points of the boundary <span class="math inline">\(C\)</span> of <span class="math inline">\(S\)</span> are <span class="math inline">\(\underline{x}(\underline{u}(t))\)</span>, again with <span class="math inline">\(t_1\le t\le t_2\)</span>.</p>
<figure>
<img src="Stoke.png" id="fig:stoke" style="width:50.0%" alt="" /><figcaption> The surface <span class="math inline">\(S\subset\mathbb{R}^3\)</span> with its bounding curve <span class="math inline">\(C\)</span>. Also shown is the parameter domain <span class="math inline">\(U\subset\mathbb{R}^2\)</span> with its bounding curve <span class="math inline">\(\widetilde{C}\)</span>, in the parametrised coordinate system <span class="math inline">\(u,v\)</span>. Under the mapping <span class="math inline">\((u,v)\mapsto \underline{x}(u,v)\)</span>, <span class="math inline">\(\widetilde{C}\to C\)</span>.</figcaption>
</figure>
<p>Now consider the right hand side of Stokes’ theorem, writing everything as a two-dimensional area integral over the region <span class="math inline">\(U\)</span> in the <span class="math inline">\(u\)</span>-<span class="math inline">\(v\)</span> plane. Let’s write it out in full first – it will help us to appreciate the utility of index notation! <span class="math display">\[\begin{aligned}
I&amp;=\int_S(\nabla\times\underline{F})\cdot d\underline{A}
=\int_U(\nabla\times\underline{F})\cdot(\frac{\partial{\underline{x}}}{\partial
u}\times\frac{\partial{\underline{x}}}{\partial{v}})\,du\,dv\\[3pt]
&amp;=\int_U\left[\left(\frac{\partial F_3}{\partial x_2}-\frac{{\partial
F_2}}{{\partial x_3}}\right)\left(\frac{\partial x_2}{\partial
u}\frac{\partial x_3}{\partial v}-\frac{\partial x_2}{\partial
v}\frac{\partial x_3}{\partial u}\right)+\left(\frac{\partial
F_1}{\partial x_3}-\frac{{\partial F_3}}{{\partial
x_1}}\right)\left(\frac{\partial x_3}{\partial u}\frac{\partial
x_1}{\partial v}-\frac{\partial x_3}{\partial v}\frac{\partial
x_1}{\partial u}\right)\right.\\ 
&amp;\qquad+ \left.\left(\frac{\partial F_2}{\partial x_1}-\frac{\partial
F_1}{\partial x_2}\right)\left(\frac{\partial x_1}{\partial
u}\frac{\partial x_2}{\partial v}-\frac{\partial x_1}{\partial
v}\frac{\partial x_2}{\partial u}\right)\right]du\,dv\end{aligned}\]</span></p>
<p>Now we’ll rewrite the integrand using the epsilon and (Kronecker) delta symbols; the expression is much more concise, and can be manipulated as follows: <span class="math display">\[\begin{aligned}
(\nabla \times\underline{F})\cdot(\underline{x}_u\times
\underline{x}_v)=\epsilon_{ijk}\frac{\partial F_k}{\partial x_j}\,
\epsilon_{ilm}\frac{\partial{x_l}}{\partial{u}}\frac{\partial{x_m}}{\partial{v}}
&amp;=(\delta_{jl}\delta_{km}-\delta_{jm}\delta_{kl})
\frac{\partial F_k}{\partial x_j}
\frac{\partial{x_l}}{\partial{u}}\frac{\partial{x_m}}{\partial{v}}\\
&amp;=
\frac{\partial F_k}{\partial x_j}
\frac{\partial x_j}{\partial u}\frac{\partial x_k}{\partial v} - 
\frac{\partial F_k}{\partial x_j}
\frac{\partial x_k}{\partial u}\frac{\partial x_j}{\partial v}\\
&amp;=
\left(\frac{\partial F_k}{\partial x_j}\frac{\partial x_j}{\partial u}\right)
\frac{\partial x_k}{\partial v} - 
\left(\frac{\partial F_k}{\partial x_j}\frac{\partial x_j}{\partial v}\right)
\frac{\partial x_k}{\partial u}\\
&amp;=
\frac{\partial F_k}{\partial u}\frac{\partial x_k}{\partial v}-
\frac{\partial F_k}{\partial v}\frac{\partial x_k}{\partial u}
% \quad\textrm{replace dummy index to have same index}\\
% &amp;=&amp;\frac{\partial F_p}{\partial u}\frac{\partial x_p}{\partial
% v}-\frac{\partial F_p}{\partial v}\frac{\partial x_p}{\partial u}
~~\textrm{(using the chain rule in reverse)}\\[3pt]
&amp;=\frac{\partial}{\partial u}\left(F_k\frac{\partial x_k}{\partial
v}\right)-\cancel{F_k\frac{\partial^2x_k}{\partial u\partial v}} -
\frac{\partial}{\partial v}\left(F_k\frac{\partial x_k}{\partial
u}\right)+\cancel{F_k\frac{\partial^2x_k}{\partial v\partial
u}} \\
&amp;\qquad\qquad\qquad\qquad\qquad \textrm{(using the product rule in
reverse)}\\
&amp;=\frac{\partial}{\partial u}\left(F_k\frac{\partial x_k}{\partial
v}\right) -
\frac{\partial}{\partial v}\left(F_k\frac{\partial x_k}{\partial
u}\right)\end{aligned}\]</span> Written in this way, the surface integral <span class="math inline">\(I\)</span> has been expressed as an area integral, and as a bonus the integrand has turned out to be in just the right form to enable us to use Green’s theorem in the plane. The ‘plane’ is now the <span class="math inline">\(u\)</span>-<span class="math inline">\(v\)</span> plane, with <span class="math inline">\(P(u,v) =
\bigl(F_k\frac{\partial x_k}{\partial u}\bigr)\)</span> and <span class="math inline">\(Q(u,v) =
\bigl(F_k\frac{\partial x_k}{\partial v}\bigr)\)</span>. Hence, <span class="math display">\[\begin{aligned}
I&amp;= \int_U\left(\frac{\partial}{\partial
u}\left(F_k\frac{\partial x_k}{\partial v}\right) -
\frac{\partial}{\partial v}\left(F_k\frac{\partial x_k}{\partial
u}\right)\right)du\,dv\quad\textrm{(now use Green&#39;s theorem)}\\
&amp;=\oint_{\widetilde{C}}
\left(
F_k\frac{\partial x_k}{\partial u}du
+ 
F_k\frac{\partial x_k}{\partial v}dv
\right)
\quad\qquad\textrm{(note this is a line integral in the $u$,$v$
plane)}\\
&amp;=\int_{t_1}^{t_2}F_k
\left(
\frac{\partial x_k}{\partial u}\frac{du}{dt}
+
\frac{\partial x_k}{\partial v}\frac{dv}{dt}
\right)dt
\qquad\textrm{(now use chain rule in reverse on the term in brackets)}\\
&amp;=\int_{t_1}^{t_2}F_k\frac{dx_k}{dt}dt \,=\,
\oint_C\underline{F}\cdot d\underline{x}\,.\end{aligned}\]</span> Hence Stokes’ theorem follows from Green’s theorem in the plane, which was proved earlier.</p>
</section>
<section id="the-divergence-theorem" class="level2" data-number="10.3">
<h2 data-number="9.3"><span class="header-section-number">9.3</span> The divergence theorem</h2>
<p>The divergence theorem gives us a relationship between volume integrals and surface integrals, just as Stokes’ theorem related surface integrals to line integrals. Recall its content: if <span class="math inline">\(\underline{F}\)</span> is a continuously differentiable vector field defined over a volume <span class="math inline">\(V\subset\mathbb{R}^3\)</span> with bounding surface <span class="math inline">\(S\)</span>, then <span class="math display">\[\boxed{\int_S \underline{F}\cdot d\underline{A} = \int_V \nabla
\cdot \underline{F}\,dV}\]</span> As before, <span class="math inline">\(d\underline{A} = \widehat{\underline{n}}\,dA\)</span>, and now the unit normal <span class="math inline">\(\widehat{\underline{n}}\)</span> should be chosen to point <em>out</em> of the volume <span class="math inline">\(V\)</span>.</p>
<p><strong>Aside:</strong> It may not look like it, but the divergence theorem is actually a higher dimensional version of Green’s theorem in the plane. This can be seen by rewriting Green’s theorem as follows.</p>
<p>Recall Green’s theorem: <span class="math display">\[\begin{equation} \label{eqn:Green_div}
I = \oint_C Pdx + Qdy = \int_A\left(\frac{\partial Q}{\partial
x}-\frac{\partial P}{\partial y}\right) dx\,dy\,, \end{equation}\]</span> where <span class="math inline">\(C\)</span> is a closed curve which bounds an area <span class="math inline">\(A\)</span> in the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane. We can parametrise the curve with a parameter <span class="math inline">\(t\)</span> as <span class="math inline">\(\underline{x}(t) = (x(t),y(t))\)</span>; then the tangent at any point on the curve is given by <span class="math inline">\(\frac{d\underline{x}}{dt}\)</span>.</p>
<p>Now we can write the line integral in terms of <span class="math inline">\(t\)</span>: <span class="math display">\[\begin{equation} \label{eqn:param_G}
I = \oint_C\left(P\frac{dx}{dt} + Q\frac{dy}{dt}\right)dt\,, \end{equation}\]</span> and (though this may seem a little odd right now) let us define the following 2-D vectors: <span class="math display">\[\begin{aligned}
\underline{F} &amp;=&amp; (Q, -P)\\
\underline{N} &amp;=&amp; (\frac{dy}{dt}, -\frac{dx}{dt})\,,\end{aligned}\]</span> so that the integrand of equation <span class="math inline">\(\eqref{eqn:param_G}\)</span> can be written as the following dot product: <span class="math display">\[\begin{equation} \label{eqn:interG}
I = \oint_C \underline{F}\cdot\underline{N}\,dt\,. \end{equation}\]</span> Now <span class="math inline">\(\underline{N}\)</span> is normal to the curve <span class="math inline">\(C\)</span>, as can be checked by taking its dot product with the tangent <span class="math inline">\(\frac{d\underline{x}}{dt}\)</span>: <span class="math display">\[\underline{N}\cdot\frac{d\underline{x}}{dt} = \frac{dy}{dt}\frac{dx}{dt} -
\frac{dx}{dt}\frac{dy}{dt} = 0.\]</span> We may also write: <span class="math display">\[\underline{N} = \widehat{\underline{n}}\,|\underline{N}| =
\widehat{\underline{n}}\sqrt{\bigl({\textstyle\frac{dy}{dt}}\bigr)^2 +
\bigl({\textstyle\frac{dx}{dt}}\bigr)^2} = \widehat{\underline{n}}\frac{ds}{dt}\,,\]</span> where <span class="math inline">\(s\)</span> is the arc length and <span class="math inline">\(\widehat{\underline{n}}\)</span> is the unit normal. Now we can write equation <span class="math inline">\(\eqref{eqn:interG}\)</span> as <span class="math inline">\(I = \oint_C
\underline{F}\cdot\widehat{\underline{n}}\frac{ds}{dt}\,dt = \oint_C
\underline{F}\cdot\widehat{\underline{n}}\,ds\)</span>.</p>
<p>Finally with <span class="math inline">\(\underline{F} = (Q, -P)\)</span> we can rewrite the RHS of equation <span class="math inline">\(\eqref{eqn:Green_div}\)</span> as <span class="math inline">\(\int_A \nabla\cdot\underline{F}\,dA\)</span> and so we get Green’s theorem in the following form: <span class="math display">\[\oint_C \underline{F}\cdot\widehat{\underline{n}}\,ds=\int_A \nabla\cdot\underline{F}\,dA\\
\]</span> which is clearly a lower dimensional form of the divergence theorem <span class="math display">\[\int_S \underline{F}\cdot \widehat{\underline{n}}\,dA = \int_V \nabla \cdot
\underline{F}\,dV.\]</span> This is another example of the analogies between the big theorems that were mentioned at the end of section 10.1. With this aside out of the way, we return to the proof of the full theorem.</p>
<p><strong>Proof of the divergence theorem:</strong> Suppose that, in components, the vector field in the statement of the theorem is <span class="math inline">\(\underline{F}=(F_1,F_2,F_3)\)</span>. Then we can write <span class="math display">\[\underline{F}=
\underline{F}_1+
\underline{F}_2+
\underline{F}_3\]</span> where <span class="math inline">\(\underline{F}_1=F_1\,\underline{e}_1\)</span>, <span class="math inline">\(\underline{F}_2=F_2\,\underline{e}_2\)</span> and <span class="math inline">\(\underline{F}_3=F_3\,\underline{e}_3\)</span>. We’ll start by proving the theorem for <span class="math inline">\(\underline{F}_3\)</span>. Suppose that <span class="math inline">\(V\)</span> projects onto a region <span class="math inline">\(A\)</span> in the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane, and assume further that <span class="math inline">\(V\)</span> is vertically simple, meaning that each point in the interior of <span class="math inline">\(V\)</span> lies between exactly two points above and below it on the boundary of <span class="math inline">\(V\)</span>, with all three of these points projecting onto the same point on the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane in the interior of <span class="math inline">\(A\)</span>. This means that <span class="math inline">\(S\)</span>, the boundary of <span class="math inline">\(V\)</span>, can be split into two halves as <span class="math inline">\(S=S_L\cup
S_U\)</span> where <span class="math inline">\(S_L\)</span> (‘lower’) contains all of the ‘below’ points on <span class="math inline">\(S\)</span>, and <span class="math inline">\(S_U\)</span> (‘upper’) contains all of the ‘above’ points, as illustrated in figure <a href="#fig:ulsplit" data-reference-type="ref" data-reference="fig:ulsplit">65</a>.</p>
<div class="center">
<figure>
<img src="divergenceproof.png" id="fig:ulsplit" style="width:50.0%" alt="" /><figcaption> A vertically simple volume, and the corresponding split of its boundary <span class="math inline">\(S\)</span> as <span class="math inline">\(S=S_L\cup S_U\)</span>.</figcaption>
</figure>
</div>
<p>Much as in method 2 for doing surface integrals, we’ll parametrise <span class="math inline">\(S_L\)</span> and <span class="math inline">\(S_U\)</span> using <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, with the <span class="math inline">\(z\)</span> coordinates of points on the two surfaces being given by two functions <span class="math inline">\(g\)</span> and <span class="math inline">\(h\)</span>, say, so that on <span class="math inline">\(S_L\)</span>, <span class="math inline">\(z=g(x,y)\)</span>, while on <span class="math inline">\(S_U\)</span>, <span class="math inline">\(z=h(x,y)\)</span>.</p>
<p>Now consider the volume integral side of the divergence theorem, a triple integral in <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span>. Opting to do the <span class="math inline">\(z\)</span> integral first, which by Fubini’s theorem is allowed, we have <span class="math display">\[\begin{aligned}
\int_V\nabla\cdot\underline{F}_3\,dV 
&amp;=\iint_A\left( \int_{g(x,y)}^{h(x,y)}\frac{\partial F_3}{\partial
z}\,dz\right)dx\,dy \\[3pt]
&amp;=\iint_A\bigl[F_3(x,y,z) \bigr]_{z=g(x,y)}^{z=h(x,y)}\,dx\,dy \\[3pt]
&amp;=\iint_A\bigl(F_3(x,y,h(x,y,z)) -F_3(x,y,g(x,y))\bigr)\,dx\,dy=(*)\,.\end{aligned}\]</span> On the other (‘surface’) side of the theorem, we can write <span class="math display">\[\int_S\underline{F}_3\cdot d\underline{A} =
\int_{S_U}\underline{F}_3\cdot d\underline{A} -
\int_{S_L}\underline{F}_3\cdot d\underline{A}\]</span> where both surface integrals on the RHS are to be taken with ‘upwards’ pointing (i.e. positive <span class="math inline">\(z\)</span> component) normals. Note that all normals in the integral on the LHS point out of <span class="math inline">\(V\)</span>, which on <span class="math inline">\(S_L\)</span> means downwards. The minus sign in front of the second term on the RHS converts the ‘upwards-normals’ integral to the downwards-normals version, so as to match the LHS.</p>
<p>Now treat <span class="math inline">\(S_L\)</span> as a parametrised surface with coordinates <span class="math inline">\(\underline{x}(x,y)=(x,y,g(x,y))\)</span>. By method 1, we have <span class="math display">\[\begin{aligned}
\int_{S_L}\underline{F}_3\cdot d\underline{A} 
&amp;=
\iint_A\underline{F}_3(\underline{x}(x,y))\cdot
\left(\frac{\partial\underline{x}}{\partial x} \times
\frac{\partial\underline{x}}{\partial y} \right)dx\,dy\\[3pt]
&amp;=
\iint_A{F}_3(x,y,g(x,y))\,\underline{e}_3\cdot
\left( (1,0,g_x) \times (0,1,g_y) \right)dx\,dy \\[3pt]
&amp;=
\iint_A{F}_3(x,y,g(x,y))\,\underline{e}_3\cdot
(-g_x,-g_y,1)\,dx\,dy 
=
\iint_A{F}_3(x,y,g(x,y))\, dx\,dy \,.\end{aligned}\]</span> Likewise, <span class="math display">\[\int_{S_U}\underline{F}_3\cdot d\underline{A} 
=
\iint_A{F}_3(x,y,h(x,y))\, dx\,dy\]</span> and hence <span class="math display">\[\int_S\underline{F}_3\cdot d\underline{A} =
\iint_A\bigl( {F}_3(x,y,h(x,y)) -{F}_3(x,y,g(x,y)) \bigr) dx\,dy =
(*)\]</span> and we’ve proved that <span class="math display">\[\int_V\nabla\cdot\underline{F}_3\,dV = \int_S\underline{F}_3\cdot d\underline{A}\,.\]</span> In the same way (but doing the <span class="math inline">\(x\)</span> or <span class="math inline">\(y\)</span> integrals first) <span class="math display">\[\int_V\nabla\cdot\underline{F}_1\,dV = \int_S\underline{F}_1\cdot d\underline{A}~\,\]</span> and <span class="math display">\[\int_V\nabla\cdot\underline{F}_2\,dV = \int_S\underline{F}_2\cdot d\underline{A}\,.\]</span> Adding these up and using <span class="math inline">\(\underline{F}= \underline{F}_1+ \underline{F}_2+ \underline{F}_3\)</span>, <span class="math display">\[\int_V\nabla\cdot\underline{F}\,dV = \int_S\underline{F}\cdot d\underline{A}\,,\]</span> as required. Notice that this is very similar to the way that Green’s theorem in the plane was proved earlier. Given the aside that began this subsection, this might not come as a huge surprise.</p>
</section>
<section id="further-examples" class="level2" data-number="10.4">
<h2 data-number="9.4"><span class="header-section-number">9.4</span> Further examples</h2>
<div class="example">
<p>Verify Stokes’ theorem for the vector field <span class="math inline">\(\underline{F}(x,y,z) = (y,z,x)\)</span> and the parabolic surface <span class="math inline">\(z=1-(x^2+y^2)\)</span>, <span class="math inline">\(z\geq 0\)</span>, shown in figure <a href="#fig:parab" data-reference-type="ref" data-reference="fig:parab">66</a>.</p>
<div class="center">
<figure>
<img src="parab.jpg" id="fig:parab" style="width:50.0%" alt="" /><figcaption> Parabolic surface <span class="math inline">\(z=1-(x^2+y^2)\)</span>.</figcaption>
</figure>
</div>
<p>We first need to find the bounding curve <span class="math inline">\(C\)</span>, in order to calculate the line integral part of Stokes’ theorem. It can be found, see figure, by locating the intersection of the surface and the <span class="math inline">\(z=0\)</span> plane. <span class="math display">\[z=0=1-(x^2+y^2) ~~ \Rightarrow~ x^2+y^2=1,~~\textrm{the unit
circle.}\]</span> Next we are going to parametrise the curve and calculate <span class="math inline">\(I_1\equiv \oint_C\underline{F}\cdot d\underline{x}\)</span>. As seen earlier, a parametrisation for a unit circle in <span class="math inline">\(\mathbb{R}^2\)</span> is <span class="math display">\[x(t)= \cos t~,\quad
y(t)= \sin t\,,\]</span> and to situate it in the <span class="math inline">\(z=0\)</span> plane we simply set <span class="math inline">\(z(t)=0\)</span>. Using this we can write <span class="math inline">\(\underline{x}(t)\)</span>, <span class="math inline">\(\underline{F}(\underline{x}(t))\)</span> and <span class="math inline">\(d\underline{x}(t)/dt\)</span> in terms of the parameter <span class="math inline">\(t\)</span>: <span class="math display">\[\begin{aligned}
\underline{x}(t)&amp;=(\cos t,\sin t,0)\,;\\[3pt]
\underline{F}(\underline{x}(t)) &amp;=(\sin t,0,\cos t)\,;\\[1pt]
\frac{d\underline{x}(t)}{dt}&amp;=(-\sin t, \cos t,0)\,.\end{aligned}\]</span></p>
<p>So now we are ready to do the line integral: <span class="math display">\[\begin{aligned}
I_1 = \oint_C\underline{F}\cdot d\underline{x}
&amp;= \int_0^{2\pi} (\sin t, 0,\cos t)\cdot
(-\sin t, \cos t,0)\,dt\\
&amp;=\int_0^{2\pi} -\sin^2 t\,dt\\
&amp;={\textstyle\frac{1}{2}}\int_0^{2\pi}(\cos(2 t)-1)\,dt \,=\, -\pi\,.\end{aligned}\]</span></p>
<p>Now let’s tackle the surface integral: <span class="math inline">\(I_2\equiv\int_S(\nabla\times\underline{F})\cdot d\underline{A}\)</span>. We will start in Cartesian coordinates and calculate the integrand using ‘method 2’, the level surface method. First off, <span class="math display">\[\nabla\times\underline{F} = \left|\begin{matrix}
\underline{e}_1&amp;\underline{e}_2&amp;\underline{e}_3\\
\frac{\partial}{\partial x}&amp;\frac{\partial}{\partial y}&amp;\frac{\partial}{\partial z}\\
y&amp;z&amp;x
\end{matrix}\right| = (-1,-1,-1)\,.\]</span> Next we recall from section 9 how to calculate the area element <span class="math inline">\(d\underline{A} = \widehat{\underline{n}}\,dA\)</span>. Since we can express our surface as a level set of a scalar field i.e. <span class="math inline">\(f(x,y,z) = z+x^2+y^2 = 1\)</span>, and <span class="math display">\[\nabla f(x,y,z) = \frac{\partial f}{\partial x}\underline{e}_1 +
\frac{\partial f}{\partial y}\underline{e}_2 + \frac{\partial f}{\partial
z}\underline{e}_3 = (2x,2y,1)\,,\]</span> our integrand is given by: <span class="math display">\[(\nabla\times \underline{F})\cdot d\underline{A} = \frac{(-1,-1,-1)\cdot
(2x,2y,1)}{\underline{e}_3\cdot(2x,2y,1)}dx\,dy = (-2x-2y-1)\,dx\,dy\,,\]</span> which leaves us ready to compute the double integral: <span class="math display">\[I_2=\int_{x^2+y^2\le 1}(-2x-2y-1)\,dx\,dy\,.\]</span> Quickest at this stage is to spot that the integration region is symmetrical in both the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> directions, so the integrals of <span class="math inline">\(-2x\)</span> and <span class="math inline">\(-2y\)</span> both vanish; this leaves us with <span class="math display">\[I_2=\int_{x^2+y^2\le 1}(-1)\,dx\,dy=-\mbox{(area of unit disk)}=-\pi\,.\]</span> Alternatively, we change to polar coordinates (<span class="math inline">\(x=r\cos
\theta\)</span>, <span class="math inline">\(y=r\sin \theta\)</span>), with the two parameters <span class="math inline">\(r\)</span> and <span class="math inline">\(\theta\)</span> running between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> and <span class="math inline">\(0\)</span> and <span class="math inline">\(2\pi\)</span> respectively. (Projecting the surface integral onto the <span class="math inline">\(x\)</span>,<span class="math inline">\(y\)</span> plane so that our region for the double integral is the unit circle.) The change of variables replaces <span class="math inline">\(dA = dx\,dy\)</span> by <span class="math inline">\(dA = rdrd\theta\)</span>; this comes from the Jacobian, as discussed in section 10.5. Hence <span class="math display">\[\begin{aligned}
I_2= \int_{S}(\nabla\times\underline{F})\cdot d\underline{A}
&amp;=\int_0^{2\pi}\!\int_0^1 (-2r\cos\theta-2r\sin\theta
-1)\,r\,dr\,d\theta\\[2pt]
&amp;=\int_0^{2\pi}
\left(
-{\textstyle\frac{2}{3}}\cos\theta-{\textstyle\frac{2}{3}}\sin\theta-{\textstyle\frac{1}{2}}
\right)d\theta\\
&amp;=\left[-{\textstyle\frac{2}{3}}\sin\theta+{\textstyle\frac{2}{3}}\cos\theta-
{\textstyle\frac{1}{2}} \theta\right]_0^{2\pi} \,=\, -\pi\,.\end{aligned}\]</span> Either way, we have obtained the same result as before, and <span class="math inline">\(\oint_C\underline{F}\cdot d\underline{x} =
\int_S(\nabla\times\underline{F})\cdot d\underline{A}\)</span>, as required.</p>
</div>
<div class="example">
<p>Use the divergence theorem to compute <span class="math display">\[\int_S\underline{F}\cdot d\underline{A}\]</span> where <span class="math inline">\(\underline{F}=(y^2z,y^3,xz)\)</span> and <span class="math inline">\(S\)</span> is the surface of the cube <span class="math inline">\(|x|\le 1\)</span> , <span class="math inline">\(|y|\le 1\)</span> , <span class="math inline">\(0\le z\le 2\)</span> .<br />
Answer: <span class="math inline">\(\nabla\cdot\underline{F}=3y^2+x\)</span>, so <span class="math display">\[\begin{aligned}
\int_S\underline{F}\cdot d\underline{A}
&amp;= \int_V(3y^2+x)\,dV\\
&amp;= \int_{-1}^1 \int_{-1}^1 \int_{0}^2 (3y^2+x)\,dz\,dx\,dy\\
&amp;= 2\int_{-1}^1 \int_{-1}^1 (3y^2+x)\,dx\,dy\\
&amp;= 2\int_{-1}^1 \left[3y^2x+\frac{1}{2}x^2\right]_{-1}^1 \,dx\,dy\\
&amp;= 2\int_{-1}^1 6y^2\,dy = \frac{12}{3}\left[y^3\right]^1_{-1}=8\,.\end{aligned}\]</span></p>
</div>
<div class="example">
<p>Verify the divergence theorem by calculating both left and right hand sides of <span class="math display">\[\int_S \underline{F}\cdot d\underline{A} = \int_V \nabla\cdot\underline{F}\,dV\,,\]</span> when <span class="math inline">\(\underline{F} = (7x, 0, -z)\)</span>, <span class="math inline">\(S\)</span> is the sphere <span class="math inline">\(x^2+y^2+z^2 = 4\)</span>, and <span class="math inline">\(V\)</span> is the volume inside it.</p>
<p>Let us start with the surface integral. Since the surface is a sphere, which does not sit in a single-valued fashion above any single plane, we use the parametric form: <span class="math inline">\(\int_S \underline{F}\cdot d\underline{A} = \int_U
\underline{F}(\underline{x}(u,v))\cdot(\underline{x}_u\times\underline{x}_v)\,du\,dv\)</span>. As in section 9, the (radius <span class="math inline">\(2\)</span>) sphere can be parametrised as <span class="math inline">\(\underline{x}(u,v) = (2\sin(u)\cos(v), 2\sin(u)\sin(v), 2\cos(u))\)</span>, with <span class="math inline">\(0\le u\le \pi\)</span>, <span class="math inline">\(0\le v\le 2\pi\)</span>, and so (as we calculated in example 7 above) <span class="math inline">\((\underline{x}_u\times\underline{x}_v) = 2\sin(u)\,\underline{x}\)</span>. Now we construct our integral in terms of the parameters <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span>: <span class="math display">\[\begin{aligned}
\oint_U \underline{F}(\underline{x}(u,v))\cdot(\underline{x}_u\times\underline{x}_v)\,du\,dv &amp;=
\int_0^{\pi}\int_0^{2\pi}(14\sin(u)\cos(v), 0, -2\cos(u))\cdot
(2\sin(u)\underline{x})\,dv\,du\\
&amp;= \int_0^{\pi}\int_0^{2\pi} (56\sin^3(u)\cos^2(v) -
8\cos^2(u)\sin(u))\,dv\,du\\
&amp;= \int_0^{\pi}\left[56\sin^3(u)\left(\frac{v}{2}
+\frac{\sin(2v)}{4}\right)-8\cos^2(u)\sin(u)v\right]_0^{2\pi}\,du\\
&amp;= \int_0^{\pi} (56\pi\sin^3(u)-16\pi\cos^2(u)\sin(u))\,du\\
&amp;=\int_0^{\pi}(56\pi\sin(u)(1-\cos^2(u))-16\pi\cos^2(u)\sin(u))\,du\\
&amp;= \int_0^{\pi}(-72\pi\sin(u)\cos^2(u)+56\pi\sin(u))\,du\\
&amp;= \left[-72\pi\frac{(-\cos^3(u))}{3}+56\pi(-\cos(u))\right]_0^{\pi}
=64\,\pi\,.\end{aligned}\]</span> Next, the volume integral. The first step is to calculate the divergence of <span class="math inline">\(\underline{F}\)</span>: <span class="math display">\[\nabla\cdot\underline{F} = \left(\frac{\partial}{\partial x},
\frac{\partial}{\partial y}, \frac{\partial}{\partial
z}\right)\cdot(7x, 0, -z) = 6\,.\]</span> Hence the integral is <span class="math display">\[\int_V6\,dV \,=\, 6\left(\frac{4}{3}\pi r^3\right) \,=\, 64\,\pi\,.\]</span> This was much simpler than the surface integral, and in fact we didn’t have to integrate at all – we just used the formula for the volume of a sphere!</p>
</div>
<div class="example">
<p>Evaluate the line integral <span class="math inline">\(\oint_C
\underline{F}\cdot d\underline{x}\)</span> with <span class="math inline">\(\underline{F} = (y, \frac{z}{2}, \frac{3y}{2})\)</span> around the curve <span class="math inline">\(C\)</span> given by the intersection of the sphere <span class="math inline">\(x^2+y^2+z^2
= 6z\)</span>, and the plane <span class="math inline">\(z=x+3\)</span>. The curve is a circle lying in the plane <span class="math inline">\(z=x+3\)</span>. If we use Stokes’ theorem then we need to think about how to set up the surface integral for a surface with <span class="math inline">\(C\)</span> as its boundary. If we do this by using <span class="math inline">\(x,y\)</span> as parameters then we will need the projection of <span class="math inline">\(C\)</span> onto the <span class="math inline">\(x,y\)</span>-plane which is given by: <span class="math inline">\(x^2 +
y^2 + (x+3)^2 = 6(x+3) = 2x^2 + y^2=9\)</span>, an ellipse.</p>
<div class="center">
<figure>
<img src="circ_plane.jpg" id="fig:circ_plane" style="width:50.0%" alt="" /><figcaption> Intersection of sphere <span class="math inline">\(x^2+y^2+z^2-6z=0\)</span> and plane <span class="math inline">\(z=x+3\)</span>.</figcaption>
</figure>
</div>
<p>The line integral can be done directly, or we can apply Stokes’ theorem: <span class="math inline">\(\oint_C \underline{F}\cdot
d\underline{x} = \int_S (\nabla\times\underline{F})\cdot d\underline{A}\)</span>. The easiest surface to consider that has <span class="math inline">\(C\)</span> as its boundary is the flat disk <span class="math inline">\(S\)</span> in the <span class="math inline">\(z=x+3\)</span> plane (we could have used either parts of the sphere that have <span class="math inline">\(C\)</span> as boundary but that would be more complcated).</p>
<p>Let’s start by calculating the curl of <span class="math inline">\(F\)</span>: <span class="math display">\[\nabla\times\underline{F} = \left|\begin{matrix}
\underline{e}_1&amp;\underline{e}_2&amp;\underline{e}_3\\
\frac{\partial}{\partial x}
&amp;\frac{\partial}{\partial y}&amp;\frac{\partial}{\partial z}\\
y&amp;z/2&amp;3y/2
\end{matrix}\right| = (1,0,-1)\]</span> And now let’s find <span class="math inline">\(d\underline{A}\)</span> using method 2, describing <span class="math inline">\(S\)</span> as (part of) a level set and parametrising it using <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>: <span class="math display">\[d\underline{A}= {\nabla f \over {\bf e}_3\cdot\nabla f}\,dx\,dy\]</span> Taking <span class="math inline">\(f(x,y,z)=z-x\)</span> so the plane is <span class="math inline">\(f(x,y,z)=3\)</span>, <span class="math inline">\(\nabla f = (-1,0,1)\)</span> , <span class="math inline">\(\underline{e}_3\cdot\nabla f=1\)</span> , and our integrand is <span class="math inline">\((\nabla\times\underline{F}).d\underline{A} =
-2\,dx\,dy\)</span>. The region of integration <span class="math inline">\(A\)</span> is the interior of the ellipse <span class="math inline">\(2x^2+y^2=9\)</span> in the <span class="math inline">\(x\)</span>,<span class="math inline">\(y\)</span> plane. Finally we can use a simple change of variables to convert the ellipse to a circle and make the area integration even simpler: if we set <span class="math inline">\(\bar{x}=\sqrt{2}x\)</span>, <span class="math inline">\(d\bar{x}=\sqrt{2}dx\)</span>, then our ellipse becomes the circle <span class="math inline">\(\bar{x}^2 + y^2=9\)</span>, and we can apply the usual coordinate transformations as follows (<span class="math inline">\(\bar{A}\)</span> (a circle) is the transformation of region <span class="math inline">\(A\)</span> (an ellipse)): <span class="math display">\[\begin{aligned}
\int_S(\nabla\times\underline{F})\cdot d\underline{A}
&amp;=-2\int_A dx\,dy = -\sqrt{2} \int_{\bar{A}}d\bar{x}\,dy\\
&amp;=-\sqrt{2}\int_0^{2\pi}\int_0^3 r\,dr\,d\theta\\
&amp;= -\sqrt{2}\int_0^{2\pi} {\textstyle\frac{9}{2}}\,d\theta\,=\, -9\sqrt{2}\pi\,.\end{aligned}\]</span></p>
<p>Alternatively, we can do the line integral directly around the ellipse <span class="math inline">\(2x^2+y^2=9\)</span>. This can be written in the standard form as <span class="math inline">\(\frac{x^2}{(3/\sqrt{2})^2}+\frac{y^2}{3^2}=1\)</span> and using the parametrisation from the table in section 9.1, <span class="math inline">\(x(t)=\frac{3}{\sqrt{2}}\cos(t)\)</span>, <span class="math inline">\(y(t) = 3\sin(t)\)</span> and so <span class="math inline">\(z(t) =
x(t)+3 =
\frac{3}{\sqrt{2}}\cos(t) +3\)</span>. We can then find the line element along the path to be <span class="math inline">\(d\underline{x} =
(\frac{-3}{\sqrt{2}}\sin(t), 3\cos(t),
\frac{-3}{\sqrt{2}}\sin(t))\,dt\)</span>, and so the integral is <span class="math display">\[\begin{aligned}
\oint_C\underline{F}\cdot d\underline{x}
&amp;= \int_0^{2\pi}(3\sin(t), {\textstyle\frac{3}{2\sqrt{2}}}\cos(t) + {\textstyle\frac{3}{2}},
{\textstyle\frac{9}{2}}\sin(t))\cdot({\textstyle\frac{-3}{\sqrt{2}}}\sin(t), 3\cos(t),
{\textstyle\frac{-3}{\sqrt{2}}}\sin(t))\,dt\\
&amp;= \int_0^{2\pi}\left(-{\textstyle\frac{9}{\sqrt{2}}}\sin^2t +
{\textstyle\frac{9}{2\sqrt{2}}}\cos^2t + {\textstyle\frac{9}{2}}\cos t -
{\textstyle\frac{27}{2\sqrt{2}}}\sin^2t\right) dt\\
&amp;= -{\textstyle\frac{9}{\sqrt{2}}}\pi + {\textstyle\frac{9}{2\sqrt{2}}}\pi -
{\textstyle\frac{27}{2\sqrt{2}}}\pi = -9\sqrt{2}\pi\,,\end{aligned}\]</span> as before.</p>
</div>
<div class="example">
<p>The next example is a little more general: Suppose <span class="math inline">\(\underline{B}(\underline{x})\)</span> is defined everywhere in <span class="math inline">\(\mathbb{R}^3\)</span>, and that <span class="math inline">\(S\)</span> is a closed surface in <span class="math inline">\(\mathbb{R}^3\)</span>. Show that <span class="math inline">\(\int_S(\nabla\times\underline{B})\cdot d\underline{A} = 0\)</span>, (i) using Stokes’ theorem, and (ii) using the divergence theorem.</p>
<ul>
<li><p>Using Stokes’ theorem, the proof takes a little work. First imagine the closed surface split into two surfaces <span class="math inline">\(S_+\)</span> and <span class="math inline">\(S_-\)</span>, bounded by the curves <span class="math inline">\(C\)</span> and <span class="math inline">\(\bar{C}\)</span> respectively, as shown in figure <a href="#fig:split" data-reference-type="ref" data-reference="fig:split">68</a>.</p>
<div class="center">
<figure>
<img src="split.png" id="fig:split" style="width:50.0%" alt="" /><figcaption> The closed surface is split into two open surfaces; <span class="math inline">\(S_+\)</span> is bounded (positively) by curve <span class="math inline">\(C\)</span> and <span class="math inline">\(S_-\)</span> is bounded by <span class="math inline">\(\bar{C}\)</span>. The unit normal is oriented outwards as usual. Note that <span class="math inline">\(\bar{C}\)</span> is just <span class="math inline">\(C\)</span> traversed backwards.</figcaption>
</figure>
</div>
<p>Now: <span class="math display">\[\int_S(\nabla\times\underline{B})\cdot d\underline{A}  =
\int_{S_+}(\nabla\times\underline{B})\cdot d\underline{A}
+\int_{S_-}(\nabla\times\underline{B})\cdot d\underline{A}\,.\]</span> Next, apply Stokes’ theorem: <span class="math display">\[\begin{aligned}
\int_{S_+}(\nabla\times\underline{B})\cdot d\underline{A} +\int_{S_-}(\nabla\times\underline{B})\cdot d\underline{A} &amp;= \oint_C\underline{B}\cdot d\underline{x} +\oint_{\bar{
C}}\underline{B}\cdot d\underline{x}\\
&amp;= \oint_C\underline{B}\cdot d\underline{x} -\oint_{
C}\underline{B}\cdot d\underline{x}=0\,.\end{aligned}\]</span></p></li>
<li><p>Using the divergence theorem, the result is a little easier to see: <span class="math display">\[\int_S(\nabla\times\underline{B})\cdot d\underline{A} =
\int_V\nabla\cdot(\nabla\times\underline{B})\,dV = \int_V 0\,dV = 0\,,\]</span> since the divergence of a curl is zero. Try to prove it using index notation!</p></li>
</ul>
</div>
<div class="example">
<p>One final quick example: show that the volume enclosed by a closed surface <span class="math inline">\(S\)</span> is <span class="math inline">\(\frac{1}{3}\int_S\underline{x}\cdot d\underline{A}\)</span>.</p>
<p>First off, remember that <span class="math inline">\(\underline{x} = (x,y,z)\)</span>. Now let’s show that <span class="math inline">\(\frac{1}{3}\int_S\underline{x}\cdot d\underline{A}\)</span> is indeed equal to volume by applying the divergence theorem: <span class="math display">\[{\textstyle\frac{1}{3}}\int_S\underline{x}\cdot d\underline{A} = {\textstyle\frac{1}{3}}\int_V \nabla \cdot
\underline{x}\,dV = \int_VdV = V,~\mbox{as required.}\]</span></p>
</div>
<hr />
<p>One last request: if you spot any typos in these notes, or if you find that anything is particularly obscure, please let me know! (At <code>s.m.fearn@durham.ac.uk</code>)</p>
</section>
</section>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>For a more powerful result special to complex analysis, look up <em>Goursat’s theorem</em>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<script>
function doNumbering() {
	// The syntax to read the structured data from the yaml is horrible, template literals fix the problem but probably aren't widely supported enough. Escaping line breaks is browser dependant. I don't know if there's a better way?
	// Note that the data from the yaml file is manipulated into an array, and then parsed back into strings later, but I didn't want to deal with the pandoc templating syntax longer than necessary.
	var supportedEnvsArrayString = ' .definition;;; .theorem;;; .lemma;;; .example;;; .exampleqed;;; .proposition;;; .remark;;; .corollary;;; .exercise;;; .question';
	var supportedEnvsArray = supportedEnvsArrayString.split("|||");
	supportedEnvsArray = supportedEnvsArray.map(inner => inner.split(";;;"));
	var numberWithin = '1';
	var counterOffset = '-1';
	var subcounterOffset = '';
	var problemCounter = '';
	const partLabels = 'abcdefghijklmnopqrstuvwxyz'.split('');
	
	// counterOffset may be negative, and by default if specified on the command line this gets string concatenated with the default given in the yaml config and this then causes a problem. Can be fixed by removing the default in the config file and converting to an int, but this causes a NaN error if no value is suplied on the command line, so if NaN set to 0.
	counterOffset = parseInt(counterOffset);
	if (isNaN(counterOffset)) {
		counterOffset = 0;
	}
	
	subcounterOffset = parseInt(subcounterOffset);
	if (isNaN(subcounterOffset)) {
		subcounterOffset = 0;
	}
	
	problemCounter = parseInt(problemCounter);
	if (isNaN(problemCounter)) {
		problemCounter = 1;
	}
	
	function sanitiseSelector(selector) {
		// tex labels often have colons in which need escaping. There may be other escaping needed here. Unfortunately neither encodeURI nor encodeURIComponent do what I need, so use regex to do the escaping manually.
		var sanitised = selector.replace(/\:/g,"\\\:");
		sanitised = sanitised.replace(/(^[\d])/,"\\3$1 ");
		sanitised = sanitised.replace(/\//g,"\\\/");
		return sanitised
	}
	
	function labelLinks() {
		var refs = document.querySelectorAll("a[data-reference-type=ref]")
		for (ref of refs) {
			// Escape colons (or other) from the link title.
			var ref_label = sanitiseSelector(ref.getAttribute("data-reference"));
			// Hopefully ref is a reference to a div or a section, which should have the associated id. If so, we just need the data-number from the relevant DOM item.
			var ref_to = document.querySelector("#"+ref_label);
			if (ref_to !== null) {
				var ref_number = ref_to.getAttribute("data-number");
			} else {
				// If ref is being used for an equation, then we need to try to parse the mathjax divs. This is fragile, but try to find the span which corresponds to the equation number we need.
				try {
					var mathjax_ref = "#mjx-eqn-"+ref_label;
					ref_to = document.querySelector(mathjax_ref);
					// Since this is a ref, we don't want the parens to be returned, so find the equation number and strip the parens.
					var ref_number = ref_to.querySelector(".mjx-char").innerHTML.replace(/[()]/g,"");
					ref.setAttribute("href",mathjax_ref);
				}
				// If we can't find a place to link to, just indicate a missing link.
				catch (err){
					var ref_number = "???"
				}
			}
			ref.innerHTML = ref_number;
		};
	}
	
	function numberEnvs() {
		for (var levelSpec = 0; levelSpec <= numberWithin; levelSpec++) {
			var reqLevels = document.querySelectorAll(".level"+levelSpec);
			for (var level of reqLevels) {
				levelCount = level.getAttribute("data-number");
				levelCount = String(parseFloat(levelCount)+(counterOffset));
				console.log(counterOffset);
				levelCount = levelCount+(("."+subcounterOffset).repeat(numberWithin-levelSpec));
				for (var counter of supportedEnvsArray) {
					var envCount = 1;
					var envs = level.querySelectorAll(counter.join(", "));
					for (var env of envs) {
						env.setAttribute("data-number",levelCount+"."+envCount);
						envCount += 1;
					}
				}
			}
		}
	}
	
	function numberFigs() {
		// Figures should either be in a figure environment, or a table with image class imageTable thanks to the tableCaps filter.
		figs = document.querySelectorAll("figure, .imageTable");
		var fig_no = 1
		console.log(figs);
		for (var fig of figs) {
			console.log(fig);
			var cap
			// For figures, we want to move the id to the figure, and set the data-number on both the figure and the figcaption
			if (fig.nodeName == "FIGURE") {
				cap = fig.querySelector("figcaption");
				var img = fig.querySelector("img, embed")
				if (img) {
					var img_id = img.getAttribute("id");
					fig.setAttribute("id",img_id);
					img.removeAttribute("id");
				}
			// for tables (which must be .imageTable due to the querySelector above), we want to set the data-number on the table and the caption
			} else if (fig.nodeName == "TABLE") {
				cap = fig.querySelector("caption");
			}
			cap.setAttribute("data-number",fig_no);
			fig.setAttribute("data-number",fig_no);
			fig_no += 1;
		}
	}
	
	function numberGlobals() {
		// This function numbers any environments that just use a global counter, such as a problem number on a problems sheet, where there are no sections to number with respect to.
		probsols = document.querySelectorAll(".problem, .solution");
		var prob_no = problemCounter;
		var partNo = 0;
		for (var probsol of probsols) {
			if (probsol.className == "problem"){
				prob_no +=1;
				partNo = 0;
				probsol.setAttribute("data-number",prob_no);
			}
			else {
				if (probsol.parentNode.nodeName == "LI") {
					var partLabel = partLabels[partNo];
					probsol.setAttribute("data-number",prob_no.toString()+partLabel);
					partNo +=1;
				}
				else{
					probsol.setAttribute("data-number",prob_no);
				}
			}
			
		}
		// sols = document.querySelectorAll(".solution");
// 		var sol_no = problemCounter;
// 		for (var sol of sols) {
// 			sol.setAttribute("data-number",sol_no);
// 			sol_no +=1
// 		}
	}
	
	// labelLinks() should occur last, so that the data-numbers have been correctly set first.
	numberEnvs();
	numberFigs();
	numberGlobals();
	labelLinks();
}
</script><script>
	var imageDir = './Figs/'
	imgs = document.querySelectorAll("img");
	for (var img of imgs) {
		imgsrc = img.getAttribute("src");
		img.setAttribute("src",imageDir.concat(imgsrc));
	}
</script></body>
</html>
