<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Codes III: Topic 6 Problems</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <link rel="stylesheet" href="https://samfearn.github.io/latex.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <script type="text/x-mathjax-config">
  	MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "ams"} } });
  	// I need to wait until MathJax has finished before running the numbering script
  	MathJax.Hub.Register.StartupHook("End",function(){doNumbering()});
  </script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Codes III: Topic 6 Problems</h1>
</header>
<p>****The following questions are concerned with Chapter 6: Polynomials and Codes.****</p>
<div class="problem">
<p>a) Show in general (and by contradiction) that if in a ring <span class="math inline">\(R\)</span> we have <span class="math inline">\(a \neq 0, b\neq 0\)</span>, but <span class="math inline">\(ab=0\)</span>, then there is no <span class="math inline">\(a^{-1}\)</span> or <span class="math inline">\(b^{-1}\)</span> in <span class="math inline">\(R\)</span>. b) Use <span class="math inline">\(R = {\mathbb F}_2[x]/(x^3 + x^2 + x + 1)\)</span> to provide an example of this: for each (nontrivial) factor of <span class="math inline">\(x^3 + x^2 + x + 1\)</span>, find all its multiples in <span class="math inline">\(R\)</span>, to show that none of them is 1. (You are finding two rows of the multiplication table for <span class="math inline">\(R\)</span>.)</p>
</div>
<div class="solution">
<p>a) Suppose <span class="math inline">\(a \neq 0, b\neq 0\)</span>, but <span class="math inline">\(ab=0\)</span>. If <span class="math inline">\(a^{-1}\)</span> exists then we have <span class="math inline">\(b = 1 b = (a^{-1}a) b  = a^{-1} (ab) = a^{-1}\cdot 0 = 0\)</span>, which is a contradiction. b) In <span class="math inline">\(R\)</span>, <span class="math inline">\((x+1)(x^2 +1) = x^3 + x^2 + x + 1 = 0\)</span>. <span class="math display">\[\begin{array}{c||c|c|c|c|c|c|c}
\times  &amp; 1 &amp; x  &amp; x+1 &amp; x^2 &amp; x^2 +1 &amp; x^2 + x &amp; x^2 + x + 1  \\
\hline \hline
 x+1 &amp; x+1 &amp;x^2 + x &amp; x^2 + 1 &amp; x + 1  &amp; 0 &amp; x^2 + 1 &amp; x^2 + x   \\
 \hline 
 x^2+1 &amp; x^2 + 1 &amp; x^2 + 1 &amp; 0  &amp; x^2+1 &amp; 0 &amp; 0 &amp; x^2 + 1 \\
\end{array}\]</span></p>
</div>
<div class="problem">
<p>Which elements of <span class="math inline">\({\mathbb F}_5\)</span> are primitive? Which elements of <span class="math inline">\({\mathbb F}_7\)</span> are primitive?</p>
</div>
<div class="solution">
<p>In <span class="math inline">\({\mathbb F}_5\)</span>, the powers of 2 are <span class="math inline">\(2^0 =1, 2^1 =2, 2^2 = 4, 2^3 = 8 = 3\)</span>. Similarly the powers of 3 are 1, 3, 9=4, 27=2. So 2 and 3 are primitive in <span class="math inline">\({\mathbb F}_5\)</span>. But the powers of 4 are only 4 and 1, so 4 is not primitive. In <span class="math inline">\({\mathbb F}_7\)</span> the powers of 3 are 1, 3, 2, 6, 4, 5, and the powers of 5 are 1, 5, 4, 6, 2, 3. So 3 and 5 are primitive. But the powers of 2 and 4 are all 1, 2 and 4, and the powers of 6 are only 1 and 6.</p>
</div>
<div class="problem">
<p>Working in <span class="math inline">\({\mathbb F}_7\)</span>, express each non-zero element as a power of 3. If <span class="math inline">\(a= 3^i\)</span> then what is <span class="math inline">\(a^{-1}\)</span>, in terms of <span class="math inline">\(i\)</span>? Now find a primitive element of <span class="math inline">\({\mathbb F}_{11}\)</span>, and answer the corresponding question.</p>
</div>
<div class="solution">
<p><span class="math display">\[{\mathbb F}_7 : \begin{array}{c|ccccccc}

         i  &amp; 0 &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6  \\
\hline 
        3^i &amp; 1 &amp; 3 &amp; 2 &amp; 6 &amp; 4 &amp; 5 &amp; 1 \\
 (3^i)^{-1} &amp; 1 &amp; 5 &amp; 4 &amp; 6 &amp; 2 &amp; 3 &amp; 1
 \end{array} 
 \;\;\;\; {\mathbb F}_{11}:
 \begin{array}{c|ccccccccccc}

         i  &amp; 0 &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 &amp; 8 &amp; 9 &amp; 10 \\
\hline 
        2^i &amp; 1 &amp; 2 &amp; 4 &amp; 8 &amp; 5 &amp; 10 &amp; 9 &amp; 7 &amp; 3 &amp; 6 &amp; 1 \\
 (2^i)^{-1} &amp; 1 &amp; 6 &amp; 3 &amp; 7 &amp; 9 &amp; 10 &amp; 5 &amp; 8 &amp; 4 &amp; 2 &amp; 1
 \end{array}\]</span> In <span class="math inline">\({\mathbb F}_7\)</span> we have <span class="math inline">\(3^6 = 3^0 = 1\)</span>, so <span class="math inline">\(a^{-1} = (3^i)^{-1} = 3^{6-i}\)</span>. Similarly, in <span class="math inline">\({\mathbb F}_{11}\)</span>, where <span class="math inline">\(2^{10} =  1\)</span>, we have <span class="math inline">\((2^i)^{-1} = 2^{10-i}\)</span>. (The other primitive elements of <span class="math inline">\({\mathbb F}_{11}\)</span> you could use are 8, 7, and 6.)</p>
</div>
<div class="problem">
<p>In <span class="math inline">\({\mathbb F}_7\)</span>, for which <span class="math inline">\(1 \le i \le 6\)</span> is <span class="math inline">\(3^i\)</span> a primitive element? In <span class="math inline">\({\mathbb F}_{11}\)</span>, for which <span class="math inline">\(1 \le i \le 10\)</span> is <span class="math inline">\(2^i\)</span> a primitive element? Can you generalise this idea? If <span class="math inline">\(a\)</span> is a primitive element in <span class="math inline">\({\mathbb F}_p\)</span>, for which <span class="math inline">\(1 \le i \le p-1\)</span> is <span class="math inline">\(a^i\)</span> a primitive element?</p>
</div>
<div class="solution">
<p>In <span class="math inline">\({\mathbb F}_7\)</span>, only <span class="math inline">\(3 = 3^1\)</span> and <span class="math inline">\(5 = 3^5\)</span> are primitive elements. The other powers all share a factor with 6, so <span class="math inline">\(2^3 = (3^2)^3 = 3^6 = 1\)</span>; <span class="math inline">\(6^2 = (3^3)^2 = 3^6 =1\)</span>; <span class="math inline">\(4^3 = (3^4)^3 = 3^{12} =1\)</span>. Similarly in <span class="math inline">\({\mathbb F}_{11}\)</span>, only <span class="math inline">\(2 = 2^1\)</span>, <span class="math inline">\(8 = 2^3\)</span>, <span class="math inline">\(7 = 2^7\)</span>, and <span class="math inline">\(6 = 2^9\)</span> are primitive elements, because only 1, 3, 7 and 9 do not share a factor with 10, and <span class="math inline">\(2^{10}\)</span> is 1, so again the powers of other powers of 2 get back to 10 “too soon". In general, in <span class="math inline">\({\mathbb F}_p\)</span>, there are <span class="math inline">\(p-1\)</span> non-zero elements, and since <span class="math inline">\(a\)</span> is primitive we know that <span class="math inline">\(a^{p-1} = 1\)</span>, but <span class="math inline">\(a^i\neq 1\)</span> for <span class="math inline">\(1\leq i &lt; p-1\)</span>. So, similarly, the element <span class="math inline">\(a^i\)</span> a primitive if and only if <span class="math inline">\(i\)</span> is prime to (shares no factor with) <span class="math inline">\(p-1\)</span>.</p>
</div>
<div class="problem">
<p>In lectures we used the field <span class="math inline">\({\mathbb F}_8 = {\mathbb F}_2[x]/(x^3 + x + 1)\)</span>. What happens if, instead, we divide <span class="math inline">\({\mathbb F}_2[x]\)</span> out by other <span class="math inline">\(f(x)\)</span> of degree 3 over <span class="math inline">\({\mathbb F}_2\)</span>? By considering polynomials of smaller degree, show that <span class="math inline">\(x^3 + x + 1\)</span> and <span class="math inline">\(x^3 + x^2 +1\)</span> are irreducible, but <span class="math inline">\(x^3 + x^2 +x + 1\)</span> is reducible, and show how it factors. (It follows that <span class="math inline">\({\mathbb F}_2[x]/(x^3 + x^2 + 1)\)</span> is also the field <span class="math inline">\({\mathbb F}_8\)</span> (see Q83) but <span class="math inline">\({\mathbb F}_2[x]/(x^3 + x^2 + x + 1)\)</span> is a ring (see Q78).)</p>
</div>
<div class="solution">
<p>Let <span class="math inline">\(f(x) \in {\mathbb F}_2[x]\)</span> be of degree 3, with non-zero constant term (otherwise <span class="math inline">\(x\)</span> is obviously a factor). Then one factor must be <span class="math inline">\(x+1\)</span>, and the other could be <span class="math inline">\(x^2 + 1 = (x+1)^2\)</span>, or <span class="math inline">\(x^2 + x+ 1\)</span>. So the reducible options are <span class="math inline">\(x^3 + x^ 2 + x+ 1\)</span> and <span class="math inline">\(x^3 + 1\)</span>, and the irreducible ones are <span class="math inline">\(x^3  + x+ 1\)</span> and <span class="math inline">\(x^3 + x^ 2 + 1\)</span>.</p>
</div>
<div class="problem">
<p>a) Find all the powers of <span class="math inline">\(x\)</span> in <span class="math inline">\({\mathbb F}_8 = {\mathbb F}_2[x]/(x^3 + x^2 + 1)\)</span>. That is, make a table giving each <span class="math inline">\(x^i,\; 0 \leq i\leq 7\)</span>, in the form <span class="math inline">\(a_2 x^2 + a_1 x + a_0\)</span>. b) Use your table to find <span class="math inline">\(x^4 + x^5\)</span> in the form <span class="math inline">\(x^i\)</span>, and <span class="math inline">\((x^2 + x + 1)( x^2 + x)\)</span> in the form <span class="math inline">\(a_2 x^2 + a_1 x + a_0\)</span>.</p>
</div>
<div class="solution">
<p>a)<span class="math display">\[\begin{array}{c||c|c|c|c|c|c|c|c}
i &amp;  0 &amp; 1 &amp; 2  &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7  \\
\hline 
 x^i &amp; 1 &amp; x &amp; x^2  &amp; x^2 + 1  &amp; x^2 + x +1 &amp; x+1 &amp; x^2 + x &amp; 1   
 \end{array}\]</span> b) <span class="math inline">\(x^4 + x^5 = (x^2 + x +1) + (x+1) = x^2\)</span>, and <span class="math inline">\((x^2 + x + 1)( x^2 + x) = x^4\cdot x^6 = x^{10} = x^3 = x^2 + 1\)</span>.</p>
</div>
<div class="problem">
<p>Consider <span class="math inline">\({\mathbb F}_3[x]/(x^2+1)\)</span>. Show that in this version of <span class="math inline">\({\mathbb F}_9\)</span>, <span class="math inline">\(x\)</span> is not a primitive element, but <span class="math inline">\(x+1\)</span> is a primitive element. (Thus, we say that <span class="math inline">\(x^2+1\)</span> is not a primitive polynomial over <span class="math inline">\({\mathbb F}_3\)</span>.)</p>
</div>
<div class="solution">
<p>First, notice that in <span class="math inline">\({\mathbb F}_3\)</span>, <span class="math inline">\(x^2 + 1 = 0\)</span> has no roots, so <span class="math inline">\(x^2 + 1\)</span> is irreducible, and so <span class="math inline">\({\mathbb F}_9 = {\mathbb F}_3[x]/(x^2+1)\)</span> is indeed a field. In this field, since we identify <span class="math inline">\(x^2+1\)</span> with 0, we have <span class="math inline">\(x^2 = -1 = 2\)</span>. We can therefore compute the powers of <span class="math inline">\(x\)</span> as <span class="math display">\[\begin{array}{c||c|c|c|c|c}
i &amp;  0 &amp; 1 &amp; 2  &amp; 3 &amp; 4 \\
\hline 
 x^i &amp; 1 &amp; x &amp; 2 &amp; 2x &amp; 1
 \end{array}\]</span> The powers of <span class="math inline">\(x\)</span> do not include all 8 non-zero elements of <span class="math inline">\({\mathbb F}_9\)</span>, and so <span class="math inline">\(x\)</span> is not primitive in <span class="math inline">\({\mathbb F}_3[x]/(x^2+1)\)</span>, and so <span class="math inline">\((x^2+1)\)</span> is not a primitive polynomial over <span class="math inline">\({\mathbb F}_3\)</span>.</p>
<p>If we now consider powers of <span class="math inline">\((x+1)\)</span>, we find that <span class="math display">\[\begin{aligned}
 		(x+1)^2 &amp;= x^2 + 2x + 1 = 2x \\
		(x+1)^3 &amp;= 2x(x+1) = 2x^2 + 2x = 2x-2 = 2x+1 \\
		(x+1)^4 &amp;= ((x+1)^2)^2 = (2x)^2 = 4x^2 = x^2 = 2,
 	\end{aligned}\]</span> and so we can complete a table of powers of <span class="math inline">\((x+1)\)</span> as <span class="math display">\[\begin{array}{c||c|c|c|c|c|c|c|c|c}
 i &amp;  0 &amp; 1 &amp; 2  &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 &amp; 8 \\
 \hline 
  x^i &amp; 1 &amp; x+1 &amp; 2x &amp; 2x+1 &amp; 2 &amp; 2x+2 &amp; x &amp; x+2 &amp; 1
  \end{array}\]</span> Since this does contain include all 8 non-zero elements of <span class="math inline">\({\mathbb F}_9\)</span>, <span class="math inline">\((x+1)\)</span> is primitive in <span class="math inline">\({\mathbb F}_3[x]/(x^2+1)\)</span>.</p>
</div>
<div class="problem">
<p>By considering possible roots, show that <span class="math inline">\(x^3 + 2x + 1\)</span> is irreducible in <span class="math inline">\({\mathbb F}_3[x]\)</span>. Use Proposition 6.9 to show that <span class="math inline">\({\mathbb F}_3[x]/(x^3 + 2x + 1)\)</span> is a field <span class="math inline">\({\mathbb F}_q\)</span>, and find <span class="math inline">\(q\)</span>. By writing each <span class="math inline">\(x^i,\; 0 \leq i\leq 13\)</span>, in the form <span class="math inline">\(a_2 x^2 + a_1 x + a_0\)</span>, show that <span class="math inline">\(x^3 + 2x + 1\)</span> is a primitive polynomial over <span class="math inline">\({\mathbb F}_3\)</span>. Why do we <span><em>not</em></span> need to calculate the <span class="math inline">\(x^i,\;14 \leq i\leq 26\)</span>, to know this?</p>
</div>
<div class="solution">
<p>If <span class="math inline">\(f(x) = x^3 + 2x+ 1\)</span> factors in <span class="math inline">\({\mathbb F}_3[x]\)</span>, it must factor into a linear and a quadratic term. Thus it must have a root in <span class="math inline">\({\mathbb F}_3\)</span>, But we have <span class="math inline">\(f(0) =1\; f(1) = 4 = 1, \; f(2) = 13 = 1\)</span>, so it is irreducible. We have the requirements for prop 6.3 with <span class="math inline">\(p =3, r=3\)</span>, so <span class="math inline">\({\mathbb F}_3[x]/(x^3 + 2x + 1)\)</span> is the field <span class="math inline">\({\mathbb F}_{27}\)</span>. <span class="math display">\[\begin{array}{c||c|c|c|c|c|c|c}
i &amp;  0 &amp; 1 &amp; 2  &amp; 3 &amp; 4 &amp; 5 &amp; 6  \\
\hline 
 x^i &amp; 1 &amp; x &amp; x^2  &amp; x + 2  &amp; x^2 + 2x &amp; 2x^2 + x + 2 &amp; x^2 + x + 1 
 \end{array}\]</span> <span class="math display">\[\begin{array}{c||c|c|c|c|c|c|c}
i &amp; 7 &amp;  8 &amp; 9 &amp; 10 &amp; 11 &amp; 12 &amp; 13\\
\hline 
 x^i &amp; x^2 + 2x + 2  &amp; 2x^2 + 2 &amp; x+1 &amp; x^2 + x  &amp; x^2 + x + 2  &amp; x^2 + 2 &amp;  2   
 \end{array}\]</span> From now on, <span class="math inline">\(x^{13 + i} = 2x^ i\)</span>, so we will not get to 1 until <span class="math inline">\(x^{26}\)</span>. (You could also argue that the order of the element <span class="math inline">\(x\)</span> must divide the order of the multiplicative group <span class="math inline">\({\mathbb F}_{27} - \{0\}\)</span>, which is 26. So if the order of <span class="math inline">\(x\)</span> is not 2 or 13, it must be 26.) So <span class="math inline">\(x\)</span> is primitive in this version of <span class="math inline">\({\mathbb F}_{27}\)</span>, so by definition <span class="math inline">\(x^3 + 2x + 1\)</span> is a primitive polynomial over <span class="math inline">\({\mathbb F}_3\)</span>.</p>
</div>
<div class="problem">
<p>Let <span class="math inline">\(a\)</span> be a primitive element in the field <span class="math inline">\({\mathbb F}_q\)</span>, where the prime power <span class="math inline">\(q = p^r\)</span>. a) For which <span class="math inline">\(1 \le i \le q-1\)</span> is <span class="math inline">\(a^i\)</span> a primitive element? (See Q81; explain if you can. For a formal proof, you need Lagrange’s Theorem - the order of a subgroup divides the order of the group.) b) Show that if <span><em>every</em></span> <span class="math inline">\(a \in {\mathbb F}_q, a \ne 0, a \ne 1\)</span> is primitive, then <span class="math inline">\(p=2\)</span>. c) Show that the converse is not true: for some values of <span class="math inline">\(r\)</span>, <span class="math inline">\({\mathbb F}_{2^r}\)</span> has other non-primitive elements. d) Show that any irreducible polynomial of degree 3 or 5 in <span class="math inline">\({\mathbb F}_2[x]\)</span> is a primitive polynomial over <span class="math inline">\({\mathbb F}_2\)</span>.</p>
</div>
<div class="solution">
<p>a) <span class="math inline">\(a^i\)</span> is primitive <span class="math inline">\(\Leftrightarrow\)</span> <span class="math inline">\(i\)</span> shares no factors with <span class="math inline">\(q-1\)</span> <span class="math inline">\(\Rightarrow\)</span>, contrapositive: If <span class="math inline">\(i\)</span> shares a factor with <span class="math inline">\(q-1\)</span>, then we have <span class="math inline">\(ki = m(q-1)\)</span>, with <span class="math inline">\(k&lt;q-1, m&lt;i\)</span>. But then <span class="math inline">\((a^i)^k = 1\)</span>, so <span class="math inline">\(a^i\)</span> is not primitive. <span class="math inline">\(\Leftarrow\)</span>, contrapositive: The powers of <span class="math inline">\(a^i\)</span> form a subgroup of the multiplicative group <span class="math inline">\({\mathbb F}_q - {0}\)</span>. The order <span class="math inline">\(k\)</span> of this subgroup divides <span class="math inline">\(q-1\)</span>, so there is some <span class="math inline">\(k\)</span> which divides <span class="math inline">\(q-1\)</span> such that <span class="math inline">\((a^i)^k = 1\)</span>, so <span class="math inline">\(ki = m(q-1)\)</span>. If <span class="math inline">\(a^i\)</span> is not primitive, then <span class="math inline">\(k&lt;q-1\)</span>, so <span class="math inline">\(i\)</span> must share a factor with <span class="math inline">\(q-1\)</span>. b) If every <span class="math inline">\(a^i\)</span> is primitive, then by part a) every <span class="math inline">\(1&lt;i&lt;q-1\)</span> shares no factor with <span class="math inline">\(q-1\)</span>. This is true if and only if <span class="math inline">\(q-1\)</span> is prime. If the prime <span class="math inline">\(p \neq 2\)</span>, then <span class="math inline">\(q=p^r\)</span> is odd, so <span class="math inline">\(q-1\)</span> is even, so not prime. (Strictly, <span class="math inline">\(p=3\)</span>, <span class="math inline">\(r=1\)</span> gives <span class="math inline">\(q-1 =2\)</span> which is prime, so in this small case we also have every element primitive.) c) <span class="math inline">\(2^4 =16\)</span>, <span class="math inline">\(2^6 = 64\)</span>, and 15 and 63 are not prime, so <span class="math inline">\({\mathbb F}_{16}\)</span> and <span class="math inline">\({\mathbb F}_{64}\)</span> have non-primitive elements. d) An irreducible polynomial <span class="math inline">\(f(x)\)</span> is called primitive over <span class="math inline">\({\mathbb F}_p\)</span> if, when we form the field <span class="math inline">\({\mathbb F}_q = {\mathbb F}_p[x] / (f(x))\)</span>, the element <span class="math inline">\(x\)</span> is primitive in this field. If <span class="math inline">\(f(x)\)</span> has degree 3, then <span class="math inline">\({\mathbb F}_q = {\mathbb F}_2[x] / (f(x)) = {\mathbb F}_8\)</span>. So <span class="math inline">\(q-1 = 7\)</span>, which is prime, and as in part b) every element, including <span class="math inline">\(x\)</span>, must be primitive. Similarly if <span class="math inline">\(f(x)\)</span> has degree 5, then <span class="math inline">\({\mathbb F}_q = {\mathbb F}_2[x] / (f(x)) = {\mathbb F}_{32}\)</span>, and <span class="math inline">\(q-1 = 31\)</span>, which is also prime.</p>
</div>
<div class="problem">
<p>Using <span class="math inline">\({\mathbb F}_4 ={\mathbb F}_2[x]/(x^2+x+1)\)</span>, a) Construct a check-matrix, and then a generator-matrix for Ham<span class="math inline">\(_4(2)\)</span>. b) Decode the received word, <span class="math inline">\(y = (x, x, x+1, 1, x)\)</span>. c) Construct a generator-matrix and a check-matrix for the extended Hamming code H<span class="math inline">\(\widehat{\text {am}}_4(2)\)</span>. d) Show that for H<span class="math inline">\(\widehat{\text {am}}_4(2)\)</span>, some received words do not have a unique nearest neighbour.</p>
</div>
<div class="solution">
<p>a) In this field, we just have to remember that <span class="math inline">\(x^2 = x+1\)</span>. So <span class="math inline">\(L_{(0,1)} = \{(0,1),(0,x),(0,x+1)\}\)</span>,<span class="math inline">\(L_{(1,0)} = \{(1,0),(x,0), (x+1,0)\},\;L_{(1,1)} = \{(1,1),(x,x),(x+1,x+1)\}\)</span>,<span class="math inline">\(L_{(1,x)} = \{(1,x),(x,x+1),(x+1,1)\},\;L_{(1,x+1)} = \{(1,x+1),(x,1),(x+1,x)\}.\)</span> Then one choice is <span class="math inline">\(H =\left(\begin{matrix} 
 1 &amp; 0 &amp; 1 &amp; 1 &amp; 1\\
  0 &amp; 1 &amp; 1 &amp; x &amp; x+1\\
      \end{matrix}\right)\)</span>, and (using Proposition 4.5) <span class="math inline">\(G =\left(\begin{matrix} 
  1 &amp; 1 &amp; 1 &amp; 0 &amp; 0\\
 1 &amp; x &amp; 0 &amp; 1 &amp; 0\\
  1 &amp; x+1 &amp; 0 &amp; 0 &amp; 1\\ \end{matrix}\right)\)</span>. b) With this <span class="math inline">\(H\)</span>, <span class="math inline">\(S(y) = (x,x)\)</span>, which is <span class="math inline">\(x\)</span> times the third column of <span class="math inline">\(H\)</span>, so we assume the error-vector is <span class="math inline">\(x{\bf e}_3 = (0,0,x,0,0)\)</span>, and decode to <span class="math inline">\((x,x,1,1,x)\)</span>. But if you have a different <span class="math inline">\(H\)</span>, you have a different (though equivalent) code, and the decoding will be different. For example, with <span class="math inline">\(H&#39; =\left(\begin{matrix} 
 1 &amp; 0 &amp; x+1 &amp; x+1 &amp; x \\
  0 &amp; 1 &amp; 1 &amp; x &amp; x \\
      \end{matrix}\right)\)</span>, the given <span class="math inline">\(y\)</span> is actually a codeword. c) By the definition, <span class="math inline">\(\widehat{H} =\left(\begin{matrix} 
 1 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 0\\
 0 &amp; 1 &amp; 1 &amp; x &amp; x+1 &amp; 0\\
 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
      \end{matrix}\right)\)</span>,and by Proposition 5.9 <span class="math inline">\(\widehat{G} =\left(\begin{matrix} 
  1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 1\\
 1 &amp; x &amp; 0 &amp; 1 &amp; 0 &amp; x\\
  1 &amp; x+1 &amp; 0 &amp; 0 &amp; 1 &amp; x+1\\ \end{matrix}\right)\)</span> d) Any Hamming code has <span class="math inline">\(d=3\)</span>, so we know that no two columns of <span class="math inline">\(H\)</span> are dependent. But then because of their last entries 1, no three columns of <span class="math inline">\(\widehat{H}\)</span> can be dependent. Because they are of length 3, any 4 columns of <span class="math inline">\(\widehat{H}\)</span> are dependent, so for H<span class="math inline">\(\widehat{\text {am}}_4(2)\)</span>, <span class="math inline">\(d=4\)</span>. (This is the same idea as for Corollary 5.8. But here the codes are not strictly binary ...) It follows (see Q16a) that for any pair of codewords <span class="math inline">\({\bf c}_1, {\bf c}_2\)</span> with <span class="math inline">\(d({\bf c}_1, {\bf c}_2) = 4\)</span>, there is a word <span class="math inline">\({\bf y}\)</span> with <span class="math inline">\(d({\bf c}_1,{\bf y}) = d({\bf c}_2, {\bf y}) = 2\)</span>. In other words, H<span class="math inline">\(\widehat{\text {am}}_4(2)\)</span>, having <span class="math inline">\(d\)</span> even, is not perfect.</p>
</div>
<div class="problem">
<p>Using <span class="math inline">\({\mathbb F}_4 ={\mathbb F}_2[x]/(x^2+x+1)\)</span>, let <span class="math inline">\(C \subseteq {\mathbb F}_4^4\)</span> have check-matrix <span class="math inline">\(H = \left(\begin{matrix} 
 1 &amp; x+1 &amp; x &amp; 1\\
 0 &amp; x+1 &amp; 1 &amp; x\\
      \end{matrix}\right)\)</span>. Find <span class="math inline">\(d(C)\)</span>.</p>
</div>
<div class="solution">
<p>We can see that no column is a multiple of another (the <span class="math inline">\(L_v\)</span> for Q87 confirm this). But the last three columns add to <span class="math inline">\({\bf 0}\)</span> (and in any case, <span class="math inline">\(d \leq n-k+1\)</span>), so <span class="math inline">\(d(c) = 3\)</span>.</p>
</div>
<div class="problem">
<p>Using <span class="math inline">\({\mathbb F}_4 ={\mathbb F}_2[x]/(x^2+x+1)\)</span>, let <span class="math inline">\(C  = \langle(1,1)\rangle \subseteq {\mathbb F}_4^2\)</span>. a) Make a decoding array for <span class="math inline">\(C\)</span> and use it to decode <span class="math inline">\((x,0),\; (1,x),\; (x+1,x),\)</span> and <span class="math inline">\((0,1)\)</span>. b) <span class="math inline">\(C\)</span> is transmitted over a 4-ary symmetric channel with symbol-error probability <span class="math inline">\(p\)</span>. Find the chance that a received word is successfully decoded by your array. c) Now make a syndrome look-up table for <span class="math inline">\(C\)</span>, and decode the same words as in a). Does it decode them to the same codewords? If not, could you make a syndrome look-up table that <span><em>does</em></span> decode like the array?</p>
</div>
<div class="solution">
<p>a) The code <span class="math inline">\(C  = \langle(1,1)\rangle  = \{ (0,0),(1,1),(x,x), (x+1,x+1)\} \subseteq {\mathbb F}_4^2\)</span>, so the array could be: <span class="math display">\[\begin{array}{c|ccc}
 (0,0)  &amp; (1,1) &amp; (x,x) &amp; (x+1,x+1)\\ \hline
 (0,1)  &amp; (1,0) &amp; (x, x+1) &amp; (x+1,x)\\
 (x,0)  &amp; (x+1,1) &amp; (0,x) &amp; (1,x+1)\\
 (x+1,0)  &amp; (x,1) &amp; (1,x) &amp; (0,x+1)\\
 \end{array}\]</span> With this array (and there are many others!) we decode <span class="math inline">\((x,0)\)</span> to <span class="math inline">\((0,0)\)</span>, <span class="math inline">\((1,x)\)</span> to <span class="math inline">\((x,x)\)</span>, <span class="math inline">\((x+1,x)\)</span> to <span class="math inline">\((x+1,x+1)\)</span> and <span class="math inline">\((0,1)\)</span> to <span class="math inline">\((0,0)\)</span>. b) We use Proposition 2.11; that is, we add the probabilities of the error-vectors in the first column. This gives <span class="math inline">\((1-p)^2 + 3 (1-p)p/3\)</span>. c) A generator matrix for <span class="math inline">\(C\)</span> is <span class="math inline">\(G= (1 \;1)\)</span>, so (by Proposition 4.5) a check matrix is also <span class="math inline">\(H= (1 \; 1)\)</span>, and the syndrome of a word is just the sum of its entries. So two possible syndrome look-up tables would be</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Syndrome <span class="math inline">\(S({\bf x})\)</span></th>
<th style="text-align: center;">Error-vector <span class="math inline">\({\bf x}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\((0,0)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(1\)</span></td>
<td style="text-align: center;"><span class="math inline">\((0,1)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(x\)</span></td>
<td style="text-align: center;"><span class="math inline">\((x,0)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(x+1\)</span></td>
<td style="text-align: center;"><span class="math inline">\((x+1,0)\)</span></td>
</tr>
</tbody>
</table>
<p>and</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Syndrome <span class="math inline">\(S({\bf x})\)</span></th>
<th style="text-align: center;">Error-vector <span class="math inline">\({\bf x}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\((0,0)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(x+1\)</span></td>
<td style="text-align: center;"><span class="math inline">\((x+1,0)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(x\)</span></td>
<td style="text-align: center;"><span class="math inline">\((x,0)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(1\)</span></td>
<td style="text-align: center;"><span class="math inline">\((1,0)\)</span></td>
</tr>
</tbody>
</table>
<p>. The first one decodes like the array above, because it tells us to subtract the same assumed error-vectors. The second does not.</p>
</div>
<div class="problem">
<p>Using <span class="math inline">\({\mathbb F}_4 ={\mathbb F}_2[x]/(x^2+x+1)\)</span>, let <span class="math inline">\(C \subseteq {\mathbb F}_4^6\)</span> have check-matrix <span class="math inline">\(H = \left(\begin{matrix} 
 1 &amp; 0 &amp; 0 &amp; 1 &amp; x &amp; 0\\
 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; x\\
 0 &amp; 0 &amp; 1 &amp; x &amp; 0 &amp; 1\\
      \end{matrix}\right)\)</span>. a) Find <span class="math inline">\(d(C)\)</span>. b) How many rows would there be in a syndrome look-up table for <span class="math inline">\(C\)</span>? To cut the table shorter, let us only include syndromes <span class="math inline">\(S({\bf x})\)</span> with <span class="math inline">\(w({\bf x})\leq 1\)</span>. Also, we can condense several lines into one by using <span class="math inline">\(\lambda {\bf e}_j\)</span> as our <span class="math inline">\({\bf x}\)</span>’s, where <span class="math inline">\(\lambda\)</span> stands for any non-zero element of <span class="math inline">\({\mathbb F}_4\)</span>. c) Make a shortened table like this and use it to decode (if possible) the received words <span class="math inline">\((1,1,1,1,1,1)\)</span>,<span class="math inline">\((0,\,0,\,0,\,x,\, 1,\, x+1),(x,\,1,\,0,\,x+1,\,x,\,1)\)</span> <span class="math inline">\((0,\,x+1,\,0,\,x+1,\,x,\,1), (1,\,0,\,x,\,1,\, 0,\, x),(1,\,x,\,0,\,x+1,\,x,\,1)\)</span>. d) How many received words can we decode using this table?</p>
</div>
<div class="solution">
<p>a) By the positions of the zeros, no column is a multiple of another, but <span class="math inline">\(x \cdot \text{col}.1 + \text{col}.2 +\text{col}.5 = {\bf 0}\)</span>, so <span class="math inline">\(d(C)= 3\)</span> b) Since <span class="math inline">\(q = 4, n=6, r=n-k = 3\)</span>, so <span class="math inline">\(k=3\)</span>, we would have <span class="math inline">\(q^{n-k} = 4^{6-3} = 64\)</span> rows. c) <span class="math display">\[\begin{array}{|c|c|c|c|c|}
\text{Syndrome }S({\bf x}) &amp; \text{Error-vector }{\bf x}&amp; &amp;
\text{Syndrome }S({\bf x}) &amp; \text{Error-vector }{\bf x}\\
\hline \hline
(0,0,0) &amp;  (0,0,0,0,0,0) &amp; &amp; &amp; \\
\lambda (1,0,0) &amp; \lambda(1,0,0,0,0,0) &amp; &amp;\lambda(1,0,x)  &amp; \lambda(0,0,0,1,0,0) \\
\lambda (0,1,0) &amp; \lambda(0,1,0,0,0,0) &amp; &amp;\lambda(x,1,0) &amp; \lambda(0,0,0,0,1,0) \\
\lambda (0,0,1) &amp; \lambda(0,0,1,0,0,0) &amp; &amp;\lambda(0,x,1) &amp; \lambda(0,0,0,0,0,1) \\
 \end{array}\]</span> <span class="math display">\[\begin{array}{|c|c|c|c|}
 {\bf y}&amp; S({\bf y}) &amp;  \text{corresponding}\; {\bf x}&amp; \text{decode?}\\
 \hline
 (1,1,1,1,1,1) &amp; (x,x,x) &amp;  \text{none} &amp; \text{ table fails} \\
 (0,\,0,\,0,\,x,\, 1,\, x+1) &amp; (0,0,0) &amp; (0,0,0,0,0,0) &amp; (0,\,0,\,0,\,x,\, 1,\, x+1)\\
 (x,\,1,\,0,\,x+1,\,x,\,1) &amp; (x,1,0) &amp; 1(0,0,0,0,1,0) &amp;  (x,\,1,\,0,\,x+1,\,x+1,\,1) \\
 (0,\,x+1,\,0,\,x+1,\,x,\,1) &amp; (0,x+1,0)&amp; (x+1)(0,1,0,0,0,0)&amp; (0,\,0,\,0,\,x+1,\,x,\,1) \\
 (1,\,0,\,x,\,1,\, 0,\, x) &amp;  (0, x+1, x)&amp; x(0,0,0,0,0,1)&amp; (1,\,0,\,x,\,1,\, 0,\, 0) \\
 (1,\,x,\,0,\,x+1,\,x,\,1) &amp; (1,x,0)&amp;  \text{none} &amp; \text{ table fails} \\
 \end{array}\]</span> d) We can decode anything in any <span class="math inline">\(S({\bf c}, 1)\)</span> round some codeword <span class="math inline">\({\bf c}\)</span>, and these spheres are disjoint. There are <span class="math inline">\(4^3 = 64\)</span> codewords, and <span class="math inline">\(|S({\bf c}, 1)| = 1+ 6\cdot 3= 19\)</span>. So we can decode <span class="math inline">\(64 \times 19 = 1216\)</span> words out of a possible <span class="math inline">\(4^6 = 4096 = |{\mathbb F}_4^6|\)</span>. (In the “table fails" cases, we could still find a nearest neighbour - see Q69.)</p>
</div>
<div class="problem">
<p>This question uses <span class="math inline">\({\mathbb F}_8 ={\mathbb F}_2[x]/(x^3+x+1)\)</span>. To help you do arithmetic in this field, first make or find the table expressing each <span class="math inline">\(x^i,\; 0 \leq i\leq 7\)</span>, in the form <span class="math inline">\(a_2 x^2 + a_1 x + a_0\)</span>. a) Let <span class="math inline">\(C = \langle \{ (x,\,x^2,\,x^2+x,\,x^2+1), (0,\,0,\,x^2,\,x), (x+1,\,x^2+x,\,0,\,x^2+1) \} \rangle \subseteq {\mathbb F}_8^4\)</span>. Find a generator- and a check-matrix for <span class="math inline">\(C\)</span>, and its parameters <span class="math inline">\([n, k, d]\)</span>. b) Use your generator-matrix to encode <span class="math inline">\((x^2,\, x^2+1)\)</span>, and to channel-decode <span class="math inline">\((x,\,x^2,\, x^2+x,\, x^2 + 1)\)</span>.</p>
</div>
<div class="solution">
<p>a) In <span class="math inline">\({\mathbb F}_8 = {\mathbb F}_2[x]/(x^3+x+1)\)</span>, we identify the polynomial <span class="math inline">\(x^3+x+1\)</span> with zero, so we therefore have the identity <span class="math inline">\(x^3 = x^2+1\)</span> (since our coefficients are in <span class="math inline">\({\mathbb F}_2\)</span>). We can then calculate higher powers of <span class="math inline">\(x\)</span> as follows: <span class="math display">\[\begin{aligned}
		x^3 =&amp;\ x+1 \\
		x^4 =&amp;\ x^2 + x \\
		x^5 =&amp;\ x^3 + x^2 = x^2 + x + 1 \\
		x^6 =&amp;\ x^3 + x^2 + x = (x+1) + x^2 + x = x^2 + 1 \\
		x^7 =&amp;\ x^3 + x = 1.
	\end{aligned}\]</span></p>
<p>Putting this into a table like before for easy referral: <span class="math display">\[\begin{array}{c||c|c|c|c|c|c|c|c}
i  &amp; 0  &amp; 1  &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 \\
\hline 
 x^i &amp; 1 &amp; x &amp; x^2 &amp; x+1 &amp; x^2 + x &amp; x^2+x+1 &amp; x^2 + 1 &amp; 1 \\
\end{array}\]</span></p>
<p>Now to find a generator matrix for the code, we first need to put the elements of the spanning set as the rows of a matrix and then row-reduce to check for linear dependence. <span class="math display">\[\begin{aligned}
	&amp;\begin{pmatrix}
		x &amp; x^2 &amp; x^2+x &amp; x^2+1 \\
		0 &amp; 0 &amp; x^2 &amp; x \\
		x+1 &amp; x^2+x &amp; 0 &amp; x^2 + 1
	\end{pmatrix}
	\overset{M_1(x^2+1)}{\longrightarrow} \begin{pmatrix}
		1 &amp; x &amp; x+1 &amp; x^2+x+1 \\
		0 &amp; 0 &amp; x^2 &amp; x \\
		x+1 &amp; x^2+x &amp; 0 &amp; x^2 + 1
	\end{pmatrix}\\
	\overset{A_{1\,3}(x+1)}{\longrightarrow} &amp;\begin{pmatrix}
		1 &amp; x &amp; x+1 &amp; x^2+x+1 \\
		0 &amp; 0 &amp; x^2 &amp; x \\
		0 &amp; 0 &amp; x^2+1 &amp; x^2+x+1
	\end{pmatrix}
	\overset{A_{2\,3}(x^4)}{\longrightarrow} \begin{pmatrix}
		1 &amp; x &amp; x+1 &amp; x^2+x+1 \\
		0 &amp; 0 &amp; x^2 &amp; x \\
		0 &amp; 0 &amp; 0 &amp; 0
	\end{pmatrix}
\end{aligned}\]</span> Since there’s an all 0 row, we should now remove this, and then continue to row reduce. <span class="math display">\[\begin{pmatrix}
		1 &amp; x &amp; x+1 &amp; x^2+x+1 \\
		0 &amp; 0 &amp; x^2 &amp; x \\
	\end{pmatrix}
	\overset{M_2(x^5)}{\longrightarrow}
	\begin{pmatrix}
			1 &amp; x &amp; x+1 &amp; x^2+x+1 \\
			0 &amp; 0 &amp; 1 &amp; x^2+1 \\
	\end{pmatrix}
	\overset{A_{2\,1}(x+1)}{\longrightarrow} 
	\begin{pmatrix}
			1 &amp; x &amp; 0 &amp; x+1 \\
			0 &amp; 0 &amp; 1 &amp; x^2+1 \\
	\end{pmatrix} = G.\]</span> <span class="math inline">\(G\)</span> is therefore a generator matrix for <span class="math inline">\(C\)</span>. We can now use the <span class="math inline">\(G\leftrightarrow H\)</span> algorithm to find a check matrix. The matrix <span class="math inline">\(G\)</span> is already in RREF, with leading 1s in columns 1 and 3, so a basis for <span class="math inline">\(C^{\perp}\)</span> (and hence the rows of a check-matrix) is given by <span class="math display">\[{\bf v}_2 = (x,1,0,0),\quad {\bf v}_4 = (x+1,0,x^2+1,1),\]</span> and hence a check matrix for <span class="math inline">\(C\)</span> is given by <span class="math display">\[H = \begin{pmatrix}
	x &amp; 1 &amp; 0 &amp; 0 \\
	x+1 &amp; 0 &amp; x^2 + 1 &amp; 1
\end{pmatrix}.\]</span> By considering the generator matrix, we easily see that we have <span class="math inline">\(n=4\)</span> and <span class="math inline">\(k=2\)</span>, and by considering the check-matrix, we see we have <span class="math inline">\(d=2\)</span> using Theorem 4.11 (since the final two columns are linearly dependent).</p>
<p>b) To encode <span class="math inline">\({\bf x}=(x^2,x^2+1)\)</span>, we calculate <span class="math inline">\({\bf c}_1 = {\bf x}\cdot G\)</span>, <span class="math display">\[{\bf c}_1 = (x^2,x^2+1)\begin{pmatrix}
			1 &amp; x &amp; 0 &amp; x+1 \\
			0 &amp; 0 &amp; 1 &amp; x^2+1 \\
	\end{pmatrix} = (x^2, x+1, x^2 + 1, 0).\]</span> To channel-decode <span class="math inline">\({\bf c}_2 = (x,x^2,x^2+x,x^2+1)\)</span>, we need to find <span class="math inline">\({\bf m}= (m_1,m_2)\)</span> such that <span class="math inline">\({\bf m}\cdot G = {\bf c}_2\)</span>. By considering the positions of the leading 1s, we see that we must have <span class="math inline">\({\bf m}= (x,x^2+x)\)</span>.</p>
</div>
<div class="problem">
<p>This question uses <span class="math inline">\({\mathbb F}_9 ={\mathbb F}_3[x]/(x^2+x+2)\)</span>. To help you do arithmetic in this field, first make or find the table expressing each <span class="math inline">\(x^i,\; 0 \leq i\leq 8\)</span>, in the form <span class="math inline">\(a_1 x + a_0\)</span>. Let <span class="math inline">\(C = \langle \{ (0,\,x+1,\,2x+1,\,x,\,1), (1,\,0,\,0,\,2,\,x), (2,\,1,\,0,\,x+2,\,x) \} \rangle \subseteq {\mathbb F}_9^5\)</span>. Find a generator- and a check-matrix for <span class="math inline">\(C\)</span>, and its parameters <span class="math inline">\([n, k, d]\)</span>. (To find <span class="math inline">\(d\)</span>, it may help to re-write <span class="math inline">\(H\)</span> with entries <span class="math inline">\(x^i\)</span>.)</p>
</div>
<div class="solution">
<p>In lectures we made the table <span class="math display">\[\begin{array}{c||c|c|c|c|c|c|c|c|c}
i  &amp; 0  &amp; 1  &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 &amp; 8 \\
\hline 
 x^i &amp; 1 &amp; x &amp; 2x+1  &amp; 2x+2 &amp; 2 &amp; 2x &amp; x+2 &amp; x+1 &amp; 1 \\
\end{array}.\]</span> To find the generator-matrix we must row-reduce: <span class="math display">\[\left(\begin{matrix} 
1 &amp; 0  &amp; 0  &amp; 2   &amp; x \\
2 &amp; 1  &amp; 0  &amp; x+2 &amp; x\\
0 &amp; x+1 &amp; 2x+1 &amp; x &amp; 1\\
      \end{matrix}\right)
      \overset{A_{1,2}(1)}{\longrightarrow}
      \left(\begin{matrix} 
1 &amp; 0  &amp; 0  &amp; 2   &amp; x \\
0 &amp; 1  &amp; 0  &amp; x+1 &amp; 2x\\
0 &amp; x+1 &amp; 2x+1 &amp; x &amp; 1\\
      \end{matrix}\right) \\
\overset{A_{2,3}(2x+2)}{\longrightarrow}
      \left(\begin{matrix} 
1 &amp; 0  &amp; 0  &amp; 2   &amp; x \\
0 &amp; 1  &amp; 0  &amp; x+1 &amp; 2x\\
0 &amp; 0 &amp; 2x+1 &amp; 1 &amp; 2\\
      \end{matrix}\right)
 \overset{M_3(x+2)}{\longrightarrow}
      \left(\begin{matrix} 
1 &amp; 0  &amp; 0  &amp; 2   &amp; x \\
0 &amp; 1  &amp; 0  &amp; x+1 &amp; 2x\\
0 &amp; 0 &amp; 1 &amp; x+2 &amp; 2x+1\\
      \end{matrix}\right) = G\]</span> So in fact the original three vectors were linearly independent, and any of these matrices is a generator -matrix for <span class="math inline">\(C\)</span>. Then by Proposition 4.5 <span class="math inline">\(H =\left(\begin{matrix} 
1 &amp; 2x+2 &amp; 2x+1 &amp; 1 &amp; 0   \\
2x &amp; x &amp; x+2 &amp;0 &amp; 1  \\
\end{matrix}\right) =  
\left(\begin{matrix} 
1 &amp; x^3 &amp; x^2 &amp; 1 &amp; 0   \\
x^5 &amp; x &amp; x^6 &amp;0 &amp; 1  \\
\end{matrix}\right) 
.\)</span> No column of the check-matrix <span class="math inline">\(H\)</span> is a multiple of another. (From top to bottom of columns 1, 2, 3, we multiply by <span class="math inline">\(x^5, x^6, x^4\)</span> respectively.) But clearly columns 4, 5 and any one other are linearly dependent (and anyway, we know <span class="math inline">\(d \leq 3\)</span>). So <span class="math inline">\(d(C) = 3\)</span>.</p>
</div>
<div class="problem">
<p>Prove that for <span class="math inline">\(f(x)\)</span> in <span class="math inline">\({\bf R}_n = {\mathbb F}_q[x]/(x^n -1)\)</span>, its span <span class="math inline">\(\langle f(x) \rangle\)</span> is a cyclic code. (This is Proposition 6.14. Use Proposition 6.12 to prove it.)</p>
</div>
<div class="solution">
<p>We must prove properties i) and ii) of Proposition 6.12. We can write <span class="math inline">\(a(x), b(x) \in \langle f(x) \rangle\)</span> as <span class="math inline">\(a&#39;(x)f(x), b&#39;(x)f(x)\)</span> for some <span class="math inline">\(a&#39;(x), b&#39;(x) \in {\bf R}_n\)</span> But then for i) <span class="math inline">\(a(x)+ b(x) = (a&#39;(x)+ b&#39;(x))f(x) \in \langle f(x) \rangle\)</span> and for ii) <span class="math inline">\(r(x)a(x) = (r(x)a&#39;(x))f(x) \in \langle f(x) \rangle\)</span> as required.</p>
</div>
<div class="problem">
<p>Let <span class="math inline">\(g(x) \in {\bf R}_n = {\mathbb F}_q[x]/(x^n -1)\)</span> be monic, of degree <span class="math inline">\(r\)</span>, and be a factor of <span class="math inline">\(x^n -1\)</span>. a) By considering the check-polynomial <span class="math inline">\(h(x)\)</span>, show that any element of <span class="math inline">\(C = \langle g(x) \rangle\)</span> has degree <span class="math inline">\(\ge r\)</span>. b) Show that, with these conditions, <span class="math inline">\(g(x)\)</span> is the generator-polynomial of <span class="math inline">\(\langle g(x) \rangle\)</span>. c) Deduce that there is a 1-1 correspondence between monic factors of <span class="math inline">\(x^n -1\)</span> and cyclic codes in <span class="math inline">\({\bf R}_n\)</span>.</p>
</div>
<div class="solution">
<p>a) Let <span class="math inline">\(g(x)h(x)= x^n-1\)</span> in <span class="math inline">\({\mathbb F}_q^n\)</span>. Then <span class="math inline">\(h(x)\)</span> is the check-polynomial of <span class="math inline">\(C\)</span>, and has degree <span class="math inline">\(n-r=k\)</span>. Any element of <span class="math inline">\(C\)</span> is <span class="math inline">\(a(x)g(x)\)</span> for some <span class="math inline">\(a(x) \in {\bf R}_n\)</span>, and <span class="math inline">\(a(x) = q(x)h(x) + r(x)\)</span> for some <span class="math inline">\(r(x)\)</span> of degree <span class="math inline">\(&lt;k\)</span>. Then in <span class="math inline">\({\mathbb F}_q^n[x]\)</span>, <span class="math inline">\(a(x)g(x)= g(x)[q(x)h(x) + r(x)] = q(x)g(x)h(x) + g(x)r(x) =q(x)(x^n-1) + g(x)r(x)\)</span>. This is <span class="math inline">\(g(x)r(x)\)</span> in <span class="math inline">\({\bf R}_n\)</span>. But since <span class="math inline">\(0 \leq deg(r(x)) &lt; k\)</span>, we know <span class="math inline">\(r \leq deg(g(x)r(x))&lt;n\)</span> in <span class="math inline">\({\mathbb F}_q^n[x]\)</span>, so there is no further reduction to be done when we go to <span class="math inline">\({\bf R}_n\)</span>, and indeed in <span class="math inline">\({\bf R}_n\)</span>, <span class="math inline">\(deg(a(x)g(x)) = deg(g(x)r(x)) \geq r\)</span> also. b) As in the proof of Theorem 6.15 i), there cannot be two monic polynomials of least degree in <span class="math inline">\(C\)</span>. So any other monic polynomial in <span class="math inline">\(C\)</span> has degree <span class="math inline">\(&gt; r\)</span>. Thus <span class="math inline">\(g(x)\)</span> is the generator-polynomial of <span class="math inline">\(\langle g(x) \rangle\)</span>. c) From Proposition 6.14 we know that any code <span class="math inline">\(\langle g(x) \rangle\)</span> is a cyclic code, and from Theorem 6.15 that any cyclic code has a generator-matrix as described (correspondence is surjective). But also, if <span class="math inline">\(g_1(x)\)</span> and <span class="math inline">\(g_2(x)\)</span> are monic factors of <span class="math inline">\(x^n-1\)</span>, and <span class="math inline">\(C = \langle g_1(x) \rangle = \langle g_2(x) \rangle\)</span>, then by b) they are both the unique generator-polynomial of <span class="math inline">\(C\)</span>, so must be the same (injectivity).</p>
</div>
<div class="problem">
<p>Find all ternary cyclic codes of block-length 3. These can be regarded as both subrings (in fact, ideals) in the ring <span class="math inline">\({\bf R}_3 = {\mathbb F}_3[x]/(x^3 -1)\)</span> and subspaces of the vector space <span class="math inline">\({\mathbb F}_3^3\)</span>. So, first find the generator-polynomial of each, and then a generator-matrix for each. Two of the codes are trivial. For the two which are not trivial, find their parameters <span class="math inline">\([n, k, d]\)</span>. How are they related?</p>
</div>
<div class="solution">
<p>Since in <span class="math inline">\({\mathbb F}_3[x]\)</span> we have <span class="math inline">\(x^3-1 = (x-1)^3\)</span>, the factors of <span class="math inline">\(x^3-1\)</span> are: <span class="math inline">\(1\)</span>, <span class="math inline">\(x-1 = 2+x\)</span>, <span class="math inline">\((x-1)^2 = 1 + x + x^2\)</span>, and <span class="math inline">\((x-1)^3\)</span>. By Theorem 6.15 these generate all the codes we want in <span class="math inline">\({\bf R}_3\)</span>, but of course <span class="math inline">\(x^3-1 = 0\)</span> in <span class="math inline">\({\bf R}_3\)</span>. Then by Proposition 6.17 we can also write out the generator-matrices, and from these it is easy to find check-matrices and parameters.</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: center;">generator-</td>
<td style="text-align: center;">generator-</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">check-</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">polynomial</td>
<td style="text-align: center;">matrix</td>
<td style="text-align: center;">code in <span class="math inline">\({\mathbb F}_3^3\)</span></td>
<td style="text-align: center;">matrix</td>
<td style="text-align: center;"><span class="math inline">\(( n, k,d)\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(I_3\)</span></td>
<td style="text-align: center;">all of <span class="math inline">\({\mathbb F}_3^3\)</span></td>
<td style="text-align: center;"><span class="math inline">\((0 \;\; 0 \;\;0 )\)</span>?</td>
<td style="text-align: center;"><span class="math inline">\((3,3,1)\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(2 + x\)</span></td>
<td style="text-align: center;"><span class="math inline">\(A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\{ (0,0,0), (2,1,0), (0,2,1),
(1,2,0), (0,1,2), (2,0,1),
(1,0,2), (1,1,1), (2,2,2) \}\)</span></td>
<td style="text-align: center;"><span class="math inline">\((1 \;\;1 \;\;1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\((3,2,2)\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(1+x+x^2\)</span></td>
<td style="text-align: center;"><span class="math inline">\((1 \;\;1 \;\;1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\{ (0,0,0), (1,1,1), (2,2,2)\}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(B\)</span></td>
<td style="text-align: center;"><span class="math inline">\((3,1,3)\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;"><span class="math inline">\((0\;\;0\;\;0)\)</span>?</td>
<td style="text-align: center;"><span class="math inline">\(\{(0,0,0)\}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(I_3\)</span></td>
<td style="text-align: center;"><span class="math inline">\((3,0,??)\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>(In the table, the ?? acknowledges that the last, trivial code does not really have a minimum distance, because it only has one word. Also, ? admits that though <span class="math inline">\((0\;0\;0)\)</span> does check or generate the code, it does not fully qualify as a check- or generator-matrix. In each case, if you think about dimensions, it should really have <span class="math inline">\(0\)</span> rows and its rows should be linearly independent. The vector <span class="math inline">\((0, 0, 0)\)</span> is linearly dependent all by itself.) From the matrices, it is clear that the two non-trivial codes (second and third in the table) are dual to each other (as are the two trivial codes).</p>
</div>
<div class="problem">
<p>a) By considering possible roots, factor <span class="math inline">\(x^3 -1\)</span> in the ring of polynomials <span class="math inline">\({\mathbb F}_7[x]\)</span>. b) Using these factors, find all the non-trivial 7-ary cyclic codes of block-length 3. (There are six of them). Give a generator-polynomial and a generator-matrix for each. c) Let <span class="math inline">\(C\)</span> be the one of these codes with generator-matrix <span class="math inline">\(G = \left(\begin{matrix} 
 3 &amp; 1 &amp; 0 \\
 0 &amp; 3 &amp; 1 \\
      \end{matrix}\right)\)</span>. By finding <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> such that <span class="math inline">\(x_1(3,1,0) + x_2 (0,3,1) = (1,2,6)\)</span>, show that <span class="math inline">\((1,2,6) \in C\)</span>. (In effect, you are channel decoding.) In the same way, show that <span class="math inline">\((2,6,1)\)</span> and <span class="math inline">\((6,1,2)\)</span> (the cyclic shifts of <span class="math inline">\((1,2,6)\)</span>) are in <span class="math inline">\(C\)</span>, but <span class="math inline">\((1,6,2)\)</span> is not.</p>
</div>
<div class="solution">
<p>a) In <span class="math inline">\({\mathbb F}_7\)</span>, we have that <span class="math inline">\(1^3 = 1\)</span>, <span class="math inline">\(2^3 = 8 = 1\)</span>, and <span class="math inline">\(4^3 = 64 = 1\)</span>. These are therefore all roots of <span class="math inline">\(x^3-1=0\)</span>, and so <span class="math inline">\((x^3-1)=(x-1)(x-2)(x-4)\)</span>.</p>
<p>b) Non-trivial factors <span class="math inline">\(g_i(x)\)</span> of <span class="math inline">\((x^3-1)\)</span> generate non-trivial cyclic codes of block length 3 in <span class="math inline">\(R_3 = {\mathbb F}_7[x]/(x^3-1)\)</span>, with generator matrices <span class="math inline">\(G_i\)</span>. Explicitly, we have the following:</p>
<ul>
<li><p><span class="math inline">\(g_1(x) = (x-1) = 6 + x\)</span>, which gives the generator matrix <span class="math inline">\(G_1 = \begin{pmatrix}
		6 &amp; 1 &amp; 0 \\
		0 &amp; 6 &amp; 1
	\end{pmatrix}\)</span>.</p></li>
<li><p><span class="math inline">\(g_2(x) = (x-2) = 5 + x\)</span>, which gives the generator matrix <span class="math inline">\(G_2 = \begin{pmatrix}
		5 &amp; 1 &amp; 0 \\
		0 &amp; 5 &amp; 1
	\end{pmatrix}\)</span>.</p></li>
<li><p><span class="math inline">\(g_3(x) = (x-4) = 3 + x\)</span>, which gives the generator matrix <span class="math inline">\(G_3 = \begin{pmatrix}
		3 &amp; 1 &amp; 0 \\
		0 &amp; 3 &amp; 1
	\end{pmatrix}\)</span>.</p></li>
<li><p><span class="math inline">\(g_4(x) = (x-1)(x-2) = 2 + 4x + x^2\)</span>, which gives the generator matrix <span class="math inline">\(G_4 = \begin{pmatrix}
		2 &amp; 4 &amp; 1 \\
	\end{pmatrix}\)</span>.</p></li>
<li><p><span class="math inline">\(g_5(x) = (x-1)(x-4) = 4 + 2x + x^2\)</span>, which gives the generator matrix <span class="math inline">\(G_5 = \begin{pmatrix}
		4 &amp; 2 &amp; 1 \\
	\end{pmatrix}\)</span>.</p></li>
<li><p><span class="math inline">\(g_6(x) = (x-2)(x-4) = 1 + x + x^2\)</span>, which gives the generator matrix <span class="math inline">\(G_6 = \begin{pmatrix}
		1 &amp; 1 &amp; 1 \\
	\end{pmatrix}\)</span>.</p></li>
</ul>
<p>c) This is the code with generator matrix <span class="math inline">\(G_3\)</span> from above. Considering the positions of the zeros in <span class="math inline">\(G_3\)</span>, we see that the first position of the word <span class="math inline">\((1,\,2,\,6)\)</span> can only come from some multiple of the first row. We therefore need to take <span class="math inline">\(x_1 = 3^{-1} = 5\)</span>. Similarly, the only contribution to the final position comes from a multiple of the second row, so we need to take <span class="math inline">\(x_2 = 6\)</span>. We then have that <span class="math display">\[(1,\,2,\,6) = (5,\,6)\cdot \begin{pmatrix}
		3 &amp; 1 &amp; 0 \\
		0 &amp; 3 &amp; 1
	\end{pmatrix}\in C.\]</span> Using the same ideas, we find that <span class="math display">\[\begin{aligned}
		(2,\,6,\,1) &amp;= (3,\,1)\cdot \begin{pmatrix}
				3 &amp; 1 &amp; 0 \\
				0 &amp; 3 &amp; 1
			\end{pmatrix} \in C,\\
		(6,\,1,\,2) &amp;= (2,\,2)\cdot \begin{pmatrix}
				3 &amp; 1 &amp; 0 \\
				0 &amp; 3 &amp; 1
			\end{pmatrix} \in C.
	\end{aligned}\]</span> If we try to use the same idea to find <span class="math inline">\((1,\,6,\,2)\)</span> as the image of a message <span class="math inline">\((x_1,\,x_2)\)</span>, we would need to take <span class="math inline">\(x_1 =5\)</span> and <span class="math inline">\(x_2 = 2\)</span>. However, we find that <span class="math display">\[(5,\,2)\cdot \begin{pmatrix}
		3 &amp; 1 &amp; 0 \\
		0 &amp; 3 &amp; 1
	\end{pmatrix} = (1,\,4,\,2) \ne (1,\,6,\,2),\]</span> so <span class="math inline">\((1,\,6,\,2)\)</span> is not a codeword, as it is not the image in <span class="math inline">\(C\)</span> of any message.</p>
</div>
<div class="problem">
<p>Consider the code <span class="math inline">\(C\)</span> of Q96c. Write down its generator-polynomial <span class="math inline">\(g(x)\)</span> and its check-polynomial <span class="math inline">\(h(x)\)</span>. Use Proposition 6.20 to find out which of these polynomials are in <span class="math inline">\(C\)</span>: <span class="math inline">\(a(x) = 6x^2 + 2 x + 1, \; b(x) = 2 x^2 + 6x + 1\)</span>. Do your answers agree with Q96c?</p>
</div>
<div class="solution">
<p>The generator matrix for <span class="math inline">\(C\)</span> is <span class="math inline">\(g(x) = x-4 = 3+x\)</span>. Thus the check-matrix is <span class="math inline">\(h(x) = (x-1)(x-2)= x^2 + 4x +2\)</span>. We now use this to “check" <span class="math inline">\(a(x)\)</span> and <span class="math inline">\(b(x)\)</span>: <span class="math inline">\(a(x)h(x) = (6x^2 + 2 x + 1)(x^2 + 4x +2)
                           =  6x^4 + 26x^3 + 21x^2 + 8x+ 2
                           =  6x + 5 + 0 + 8x + 2 = 0\)</span> <span class="math inline">\(b(x)h(x) = (2x^2 + 6x + 1)(x^2 + 4x +2)
                           =  2x^4 + 0x^3 + 29x^2 + 16x+ 22
                           = 2x + x^2 + 2x + 2 = x^2 + 2x + 4 \neq 0\)</span> This agrees with Q96: <span class="math inline">\(a(x) \leftrightarrow (1,2,6) \in C\;;\;                         b(x) \leftrightarrow (1,6,2) \not\in C\)</span>.</p>
</div>
<div class="problem">
<p>In lectures, we found all the ternary cyclic codes of length 4. The codes we found (see Example 54) come in dual pairs, <span class="math inline">\(C\)</span> and <span class="math inline">\(C^\perp\)</span>. Find these pairs, and show that they are duals, a) by considering their generator- and check-matrices, and using ideas from Chapter 4, b) by considering their generator- and check-polynomials and using Proposition 6.22. (Remember that a polynomial can generate a code even if it is not that code’s unique, official generator-polynomial.)</p>
</div>
<div class="solution">
<p>Ternary cyclic codes of block-length 4 can be thought of as living in <span class="math inline">\(R_4 = {\mathbb F}_3/(x_4-1)\)</span> (where the codewords are polynomials of the form <span class="math inline">\(a_0+a_1x + a_2x^2 + a_3x^3\)</span>) <em>and</em> in <span class="math inline">\({\mathbb F}_3^4\)</span> (where the codewords are vectors <span class="math inline">\((a_0,\,a_1,\,a_2,\,a_3)\)</span>).</p>
<p>a) In <span class="math inline">\({\mathbb F}_3^4\)</span>, if <span class="math inline">\(C\)</span> is a <span class="math inline">\([4,k]\)</span> code, then <span class="math inline">\(C^\perp\)</span> is a <span class="math inline">\([4,4-k]\)</span> code. So then if the dimensions match, we have that <span class="math inline">\(C_j=C_i^\perp\)</span> if and only if <span class="math inline">\(G_j\)</span> is a check matrix for <span class="math inline">\(C_i\)</span>, and this is the case if and only if every row of <span class="math inline">\(G_i\)</span> is orthogonal to every row of <span class="math inline">\(G_j\)</span>. In particular, we therefore must have that <span class="math inline">\(G_i \cdot G_j\)</span> is a matrix of all zeros, of dimensions <span class="math inline">\(k \times (n-k)\)</span>.</p>
<p>Checking this, we see that <span class="math inline">\(C_5 = C_1^\perp\)</span>, as <span class="math inline">\(C_1={\mathbb F}_3^4\)</span> with dimension 4, and <span class="math inline">\(C_5 = \{{\bf 0}\}\)</span> with dimension 0. <span class="math inline">\(C_7 = C_3^\perp\)</span>, both of dimension 2. <span class="math inline">\(C_8 = C_2^\perp\)</span>, with <span class="math inline">\(\dim{C_8}=1\)</span> and <span class="math inline">\(\dim{C_2}=3\)</span>. <span class="math inline">\(C_4 = C_6^\perp\)</span>, with <span class="math inline">\(\dim{C_4}=1\)</span> and <span class="math inline">\(\dim{C_6}=3\)</span>.</p>
<p>b) In <span class="math inline">\(R_4={\mathbb F}_3/(x^4-1)\)</span>, we know from Proposition 6.22 that the reciprocal polynomial <span class="math inline">\(\bar{h}(x)\)</span>, found from the check polynomial <span class="math inline">\(h(x)\)</span>, generates the dual code. In particular, if we multiply <span class="math inline">\(\bar{h}(x)\)</span> by <span class="math inline">\(h_0^{-1}\)</span>, then we get a monic polynomial which is the generator polynomial for the dual code.</p>
<p><span class="math inline">\(C_1\)</span> has generator polynomial 1, and so check polynomial <span class="math inline">\(x^4-1\)</span> which is 0 in <span class="math inline">\(R_4\)</span>. The reciprocal polynomial is therefore 0, which generates the trivial code <span class="math inline">\(C_5\)</span>.</p>
<p><span class="math inline">\(C_2\)</span> has generator polynomial <span class="math inline">\(x+1\)</span>, and therefore has check-polynomial <span class="math inline">\((x-1)(x^2+1) = x^3 - x^2 + x + 1\)</span>, and reciprocal polynomial <span class="math inline">\(1-x+x^2-x^3\)</span>. This polynomial is not monic, but we can multiply by <span class="math inline">\(-1\)</span> to find the monic polynomial <span class="math inline">\(-1+x-x^2+x^3\)</span>, which is the generator polynomial for the dual code. Since this is also the generator polynomial for <span class="math inline">\(C_8\)</span>, we see that <span class="math inline">\(C_2^\perp = C_8\)</span>.</p>
<p><span class="math inline">\(C_3\)</span> has generator polynomial <span class="math inline">\(x^2+1\)</span> and therefore check-polynomial <span class="math inline">\((x-1)(x+1) = x^2-1\)</span>, and reciprocal polynomial <span class="math inline">\(1-x^2\)</span>. The generator polynomial for <span class="math inline">\(C_2^\perp\)</span> is therefore the monic polynomial <span class="math inline">\(-1+x^2\)</span>, which is the generator polynomial for <span class="math inline">\(C_7\)</span>, and so <span class="math inline">\(C_3^\perp = C_7\)</span>.</p>
<p>Finally, <span class="math inline">\(C_4\)</span> has generator polynomial <span class="math inline">\((x+1)(x^2+1)\)</span>, and therefore has check-polynomial <span class="math inline">\(x-1\)</span>, and reciprocal polynomial <span class="math inline">\(1-x\)</span>. The generator polynomial for <span class="math inline">\(C_4^\perp\)</span> is therefore the monic polynomial <span class="math inline">\(-1+x\)</span>, which is the generator polynomial for <span class="math inline">\(C_6\)</span>, and so <span class="math inline">\(C_4^\perp = C_6\)</span>.</p>
</div>
<div class="problem">
<p>a) In <span class="math inline">\({\mathbb F}_2[x]\)</span>, <span class="math inline">\(x^7-1 = (x^3 + x + 1)(x^4 + x^2 + x + 1)\)</span>. Let <span class="math inline">\(g(x) = (x^3 + x + 1) \in {\mathbb F}_2[x]\)</span>, and write out the generator-matrix <span class="math inline">\(G_1\)</span> for the cyclic code <span class="math inline">\(C_1 = \langle g(x) \rangle \subseteq {\bf R}_7 = {\mathbb F}_3[x]/(x^7 -1)\)</span>. b) Using just 3 EROs, row-reduce <span class="math inline">\(G_1\)</span> to standard form <span class="math inline">\((A\;|\; I)\)</span>. Find a check matrix <span class="math inline">\(H_1\)</span> for <span class="math inline">\(C_1\)</span>, and explain why <span class="math inline">\(C_1\)</span> is a Ham<span class="math inline">\(_2(3)\)</span> code. c) Using Proposition 6.22 find a check-polynomial <span class="math inline">\(h_1(x)\)</span> for <span class="math inline">\(C_1\)</span>, and a generator-polynomial <span class="math inline">\(g_2(x)\)</span> for code <span class="math inline">\(C_2 = C_1 ^\perp\)</span>. Write out a generator-matrix <span class="math inline">\(G_2\)</span> for the cyclic code <span class="math inline">\(C_2\)</span>. d) But of course <span class="math inline">\(H_1\)</span> is also a generator-matrix for <span class="math inline">\(C_2\)</span>. Use just one ERO to change <span class="math inline">\(G_2\)</span> to <span class="math inline">\(H_1\)</span>.</p>
</div>
<div class="solution">
<p>a) Using Theorem 6.15 and Proposition 6.17, since <span class="math inline">\(g(x)\)</span> is the generator polynomial for the code <span class="math inline">\(C_1\)</span>, a generator matrix for this code is <span class="math display">\[G_1 = \begin{pmatrix}
	1 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\
	0 &amp; 1 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\
	0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 1 &amp; 0\\
	0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 1
\end{pmatrix}.\]</span></p>
<p>b) Using 3 EROs, we have <span class="math display">\[G_1 = \begin{pmatrix}
	1 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\
	0 &amp; 1 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\
	0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 1 &amp; 0\\
	0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 1
\end{pmatrix} \overset{\substack{A_{24}(1)\\A_{13}(1)\\A_{14}(1)}}{\longrightarrow}
\begin{pmatrix}
	1 &amp; 1 &amp; 0 &amp; | &amp; 1 &amp; 0 &amp; 0 &amp; 0\\
	0 &amp; 1 &amp; 1 &amp; | &amp; 0 &amp; 1 &amp; 0 &amp; 0\\
	1 &amp; 1 &amp; 1 &amp; | &amp; 0 &amp; 0 &amp; 1 &amp; 0\\
	1 &amp; 0 &amp; 1 &amp; | &amp; 0 &amp; 0 &amp; 0 &amp; 1
	\end{pmatrix},\]</span> which is in the form <span class="math inline">\((A\ |\ I_4)\)</span>. Using Proposition 4.5, a check-matrix for <span class="math inline">\(C_1\)</span> is therefore <span class="math inline">\(H_1 = (I_3 \ |\ -A^t)\)</span>, or <span class="math display">\[H_1=\begin{pmatrix}
	1 &amp; 0 &amp; 0 &amp; | &amp; 1 &amp; 0 &amp; 1 &amp; 1\\
	0 &amp; 1 &amp; 0 &amp; | &amp; 1 &amp; 1 &amp; 1 &amp; 0\\
	0 &amp; 0 &amp; 1 &amp; | &amp; 0 &amp; 1 &amp; 1 &amp; 1
\end{pmatrix}.\]</span> This matrix has every non-zero vector of <span class="math inline">\({\mathbb F}_2^3\)</span> appearing as one of it’s columns, so it’s a check-matrix for <span class="math inline">\(\text{Ham}_2(3)\)</span>, and hence <span class="math inline">\(C_1 = \text{Ham}_2(3)\)</span>.</p>
<p>c) By Proposition 6.22, a check-polynomial for <span class="math inline">\(C_1\)</span> is <span class="math inline">\(h(x)=(x^4 + x^2 + x + 1)\)</span>, since we then have <span class="math inline">\(x^7-1 = g(x)h(x)\)</span>. The reciprocal polynomial <span class="math inline">\(\bar{h}(x) = 1 + x^2 + x^3 + x^4\)</span> is then a polynomial which generates the dual code. Since this is monic, this is the generator polynomial for <span class="math inline">\(C_2 = C_1^\perp\)</span>, and hence a generator matrix <span class="math inline">\(G_2\)</span> for <span class="math inline">\(C_2\)</span> is <span class="math display">\[G_2 = \begin{pmatrix}
	1 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 \\
	0 &amp; 1 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 0 \\
	0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 1 &amp; 1
\end{pmatrix}\]</span></p>
<p>d) We have <span class="math display">\[G_2 = \begin{pmatrix}
	1 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 \\
	0 &amp; 1 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 0 \\
	0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 1 &amp; 1
\end{pmatrix} \overset{A_{31}(1)}{\longrightarrow}
\begin{pmatrix}
	1 &amp; 0 &amp; 0 &amp; | &amp; 1 &amp; 0 &amp; 1 &amp; 1\\
	0 &amp; 1 &amp; 0 &amp; | &amp; 1 &amp; 1 &amp; 1 &amp; 0\\
	0 &amp; 0 &amp; 1 &amp; | &amp; 0 &amp; 1 &amp; 1 &amp; 1
\end{pmatrix} = H_1,\]</span> so <span class="math inline">\(H_1\)</span> and <span class="math inline">\(G_2\)</span> are both check matrices for <span class="math inline">\(C_1\)</span>, and generator matrices for <span class="math inline">\(C_2=C_1^\perp\)</span>.</p>
</div>
<div class="problem">
<p>In <span class="math inline">\({\bf R}_n\)</span>, let <span class="math inline">\(g(x)\)</span> and <span class="math inline">\(h(x)\)</span> be monic, and <span class="math inline">\(g(x)h(x) = x^n -1\)</span>. Then we know by Q94b that <span class="math inline">\(g(x)\)</span> and <span class="math inline">\(h(x)\)</span> are the generator-polynomials for <span class="math inline">\(C_1 = \langle g(x) \rangle\)</span> and <span class="math inline">\(C_2 = \langle h(x) \rangle\)</span> respectively. a) Specify polynomials which generate <span class="math inline">\(C_1 ^\perp\)</span> and <span class="math inline">\(C_2 ^\perp\)</span> respectively. b) By considering generator-matrices for <span class="math inline">\(C_1\)</span> and <span class="math inline">\(C_2 ^\perp\)</span>, show that these codes are equivalent. (So, we might say that <span class="math inline">\(C_1 = \langle g(x) \rangle\)</span> and <span class="math inline">\(C_2 = \langle h(x) \rangle\)</span> are “almost dual" to each other.) c) Conclude that in general, if <span class="math inline">\(g(x)\)</span> is monic and divides <span class="math inline">\(x^n -1\)</span>, then the codes <span class="math inline">\(\langle g(x) \rangle\)</span> and <span class="math inline">\(\langle \overline{g}(x) \rangle\)</span> are equivalent.</p>
</div>
<div class="solution">
<p>a) By Proposition 6.22 <span class="math inline">\(\overline{h}(x)\)</span> generates <span class="math inline">\(C_1 ^\perp\)</span> and <span class="math inline">\(\overline{g}(x)\)</span> generates <span class="math inline">\(C_2 ^\perp\)</span>. b) Let <span class="math inline">\(g(x) = g_0 + g_1x + \cdots + g_rx^r\)</span>. Then by Proposition 6.22, the generator-matrices for <span class="math inline">\(C_1 =\langle g(x)\rangle\)</span> and <span class="math inline">\(C_2^\perp =\langle \overline{g}(x)\rangle\)</span> are, respectively, <span class="math display">\[G = \left(\begin{matrix}
g_0 &amp; g_1 &amp; \cdots &amp; g_r &amp; &amp;  &amp;  &amp;\\
 &amp; g_0 &amp; g_1 &amp; \cdots &amp; g_r &amp;  &amp; 0 &amp;\\
&amp;  &amp; g_0 &amp; g_1 &amp; \cdots &amp; g_r &amp;    \\
&amp; 0&amp;  &amp; \ddots  &amp; \ddots &amp;   &amp; \ddots&amp; \\
 &amp; &amp; &amp; &amp; g_0 &amp; g_1 &amp; \cdots &amp; g_r \\
\end{matrix}\right), \;
 G&#39; =\left(\begin{matrix}
g_r &amp; g_{r-1} &amp; \cdots &amp; g_0 &amp; &amp;  &amp;  &amp;\\
 &amp; g_r &amp; g_{r-1} &amp; \cdots &amp; g_0 &amp;  &amp; 0 &amp;\\
&amp;  &amp; g_r &amp; g_{r-1} &amp; \cdots &amp; g_0 &amp;    \\
&amp; 0&amp;  &amp; \ddots  &amp; \ddots &amp;   &amp; \ddots&amp; \\
 &amp; &amp; &amp; &amp; g_r &amp; g_{r-1} &amp; \cdots &amp; g_0 \\
\end{matrix}\right) .\]</span> By reversing the order of the rows of <span class="math inline">\(G\)</span>, we get another generator-matrix for <span class="math inline">\(C_1\)</span>. But by then reversing the order of the columns we get <span class="math inline">\(G&#39;\)</span>, so by Proposition 3.7, <span class="math inline">\(C_2^\perp\)</span> is equivalent to <span class="math inline">\(C_1\)</span>. c) If <span class="math inline">\(g(x)\)</span> is monic and divides <span class="math inline">\(x^n -1\)</span>, then there must exist <span class="math inline">\(h(x)\)</span> as for a) and b), and the conclusion follows.</p>
</div>
<div class="problem">
<p>We can construct the Golay codes as cyclic codes. In <span class="math inline">\({\mathbb F}_2[x]\)</span>, <span class="math inline">\(x^{23} -1\)</span> factors as <span class="math display">\[(x-1)(x^{11} + x^{10} + x^6 + x^5 + x^4 + x^2 + 1)(x^{11} + x^9 + x^7 + x^6 + x^5 + x + 1) = (x-1)g_1(x)g_2(x).\]</span> Use Q100 to show that <span class="math inline">\(\langle g_1(x) \rangle\)</span> and <span class="math inline">\(\langle g_2(x) \rangle\)</span>, cyclic codes in <span class="math inline">\(R_{23} = {\mathbb F}_2[x]/(x^{23} -1)\)</span>, are equivalent. In fact, they are both equivalent to the binary Golay code <span class="math inline">\(\mathcal{G}_{23}\)</span> of Section 5.3.</p>
</div>
<div class="solution">
<p><span class="math inline">\(g_1(x)
    =  1x^{11} + 1x^{10} +0x^9 + 0 x^8 + 0 x^7 + 1x^6 + 1x^5 + 1x^4 + 0 x^3 + 1x^2 + 0x + 1 \;\;\;\)</span> <span class="math inline">\(g_2(x) = 1x^{11} + 0x^{10} +1x^9 + 0 x^8 + 1 x^7 + 1x^6 + 1x^5 + 0x^4 + 0 x^3 + 0x^2 + 1x + 1\)</span> So <span class="math inline">\(g_2(x) =\overline{g_1}(x)\)</span>. Since <span class="math inline">\(g_1(x)\)</span> is a monic factor of <span class="math inline">\(x^{23} -1\)</span> it follows from Q100 that <span class="math inline">\(\langle g_1(x) \rangle\)</span> and <span class="math inline">\(\langle g_2(x) \rangle\)</span> are equivalent.</p>
</div>
<div class="problem">
<p>Let <span class="math inline">\({\bf a}= (1,0,4,7), {\bf b}= (1,2,3,4) \in {\mathbb F}_{11}^4\)</span>. Find the minimum distance and a basis for the Reed-Solomon code RS<span class="math inline">\(_3 ({\bf a},{\bf b}) \subseteq {\mathbb F}_{11}^4\)</span>.</p>
</div>
<div class="solution">
<p>We use Proposition 6.24. Here <span class="math inline">\(n=4, k=3\)</span>. So as RS<span class="math inline">\(_3 ({\bf a},{\bf b})\)</span> is MDS we know <span class="math inline">\(d= n-k+1 = 2\)</span>. A basis is <span class="math inline">\(\{\varphi_{{\bf a},{\bf b}}(1), \varphi_{{\bf a},{\bf b}}(x),   \varphi_{{\bf a},{\bf b}}(x^2)\} = \{(1,2,3,4),(1,0,1,6),(1,0,4,9)\}\)</span>.</p>
</div>
<div class="problem">
<p>Let <span class="math inline">\({\bf a}= (0,1,2,3,4), {\bf b}= (1,1,1,1,1) \in {\mathbb F}_{7}^5\)</span>. Find a generator-matrix for each code RS<span class="math inline">\(_k ({\bf a},{\bf b}) \subseteq {\mathbb F}_7^5\)</span>, <span class="math inline">\(1 \le k \le 4\)</span>. Then find a check-matrix for each code.</p>
</div>
<div class="solution">
<p>Recall that the Reed-Solomon code is the image of the map <span class="math inline">\(\varphi_{{\bf a},{\bf b}}:P_k \to {\mathbb F}_q^n\)</span>. In this case we have <span class="math inline">\(q=7\)</span>, <span class="math inline">\(n=5\)</span> and <span class="math inline">\(\varphi_{{\bf a},{\bf b}}(f(x))=(b_1f(a_1),\,b_2f(a_2),\ldots,b_5f(a_5))\)</span>. By Proposition 6.24, the elements <span class="math inline">\(\varphi_{{\bf a},{\bf b}}(x^i)\)</span> for <span class="math inline">\(0\le i \le k\)</span> are a basis for <span class="math inline">\(\text{RS}_k({\bf a},{\bf b})\)</span>, and hence can be taken as the rows of a generator matrix for <span class="math inline">\(\text{RS}_k({\bf a},{\bf b})\)</span>.</p>
<p>We have <span class="math display">\[\begin{aligned}
	\varphi_{{\bf a},{\bf b}}(1) &amp;= (1,1,1,1,1) = {\bf b}\\
	\varphi_{{\bf a},{\bf b}}(x) &amp;= (f(a_1),f(a_2),f(a_3),f(a_4),f(a_5)) = (0,1,2,3,4) ={\bf a}\\
	\varphi_{{\bf a},{\bf b}}(x^2) &amp;= (0^2,1^2,2^2,3^2,4^2) = (0,1,4,2,2) \\
	\varphi_{{\bf a},{\bf b}}(x^3) &amp;= (0^3,1^3,2^3,3^3,4^3) = (0,1,1,6,1),
\end{aligned}\]</span> and so letting <span class="math inline">\(G_k\)</span> be the generator matrix for <span class="math inline">\(\text{RS}_k({\bf a},{\bf b})\)</span>, we have <span class="math display">\[\begin{aligned}
		G_1 &amp;= \begin{pmatrix}
			1 &amp; 1 &amp; 1 &amp; 1 &amp; 1
		\end{pmatrix} \qquad G_2 = \begin{pmatrix}
			1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
			0 &amp; 1 &amp; 2 &amp; 3 &amp; 4
		\end{pmatrix} \\
		G_3 &amp;= \begin{pmatrix}
			1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
			0 &amp; 1 &amp; 2 &amp; 3 &amp; 4 \\
			0 &amp; 1 &amp; 4 &amp; 2 &amp; 2
		\end{pmatrix} \qquad G_4 = \begin{pmatrix}
			1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
			0 &amp; 1 &amp; 2 &amp; 3 &amp; 4 \\
			0 &amp; 1 &amp; 4 &amp; 2 &amp; 2 \\
			0 &amp; 1 &amp; 6 &amp; 6 &amp; 1
		\end{pmatrix}.
	\end{aligned}\]</span></p>
<p>To find the check-matrices for each of these codes, we first find <span class="math inline">\({\bf c}\)</span> as in Proposition 6.25, <span class="math inline">\({\bf c}= H_4\)</span>, the check-matrix for <span class="math inline">\(\text{RS}_4({\bf a},{\bf b})\)</span>. We row reduce <span class="math inline">\(G_4\)</span> to <span class="math display">\[G&#39;_4 = \begin{pmatrix}
	1 &amp; 0 &amp; 0 &amp; 0 &amp; 6 \\
	0 &amp; 1 &amp; 0 &amp; 0 &amp; 4 \\
	0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
	0 &amp; 0 &amp; 0 &amp; 1 &amp; 4
\end{pmatrix},\]</span> which is in standard form <span class="math inline">\((I_4\ |\ A)\)</span>, and hence a check-matrix for <span class="math inline">\(\text{RS}_4({\bf a},{\bf b})\)</span> is <span class="math inline">\(H_4 = (-A^t\ |\ 1) = (1,3,6,3,1) = {\bf c}= \varphi_{{\bf a},{\bf c}}(1)\)</span>.</p>
<p>To find the remaining check-matrices, we then calculate <span class="math display">\[\begin{aligned}
		\varphi_{{\bf a},{\bf c}}(x) &amp;= (1 \times 0,3 \times 1,6 \times 2,3 \times 3,1 \times 4) = (0,3,5,2,4) \\
		\varphi_{{\bf a},{\bf c}}(x^2) &amp;= (1 \times 0^2,3 \times 1^2,6 \times 2^2,3 \times 3^2,1 \times 4^2) = (0,3,3,6,2) \\
		\varphi_{{\bf a},{\bf c}}(x^3) &amp;= (1 \times 0^3,3 \times 1^3,6 \times 2^3,3 \times 3^3,1 \times 4^3) = (0,3,6,4,1),
	\end{aligned}\]</span> and so if we let <span class="math inline">\(H_k\)</span> be the check-matrix for <span class="math inline">\(\text{RS}_k({\bf a},{\bf b})\)</span>, we have <span class="math display">\[H_3 = \begin{pmatrix}
			1 &amp; 3 &amp; 6 &amp; 3 &amp; 1 \\
			0 &amp; 3 &amp; 5 &amp; 2 &amp; 4
		\end{pmatrix} \quad H_2 = \begin{pmatrix}
			1 &amp; 3 &amp; 6 &amp; 3 &amp; 1 \\
			0 &amp; 3 &amp; 5 &amp; 2 &amp; 4 \\
			0 &amp; 3 &amp; 3 &amp; 6 &amp; 2
		\end{pmatrix} \quad H_1 = \begin{pmatrix}
			1 &amp; 3 &amp; 6 &amp; 3 &amp; 1 \\
			0 &amp; 3 &amp; 5 &amp; 2 &amp; 4 \\
			0 &amp; 3 &amp; 3 &amp; 6 &amp; 2 \\
			0 &amp; 3 &amp; 6 &amp; 4 &amp; 1
		\end{pmatrix}\]</span> as the remaining check-matrices.</p>
</div>
<div class="problem">
<p>Let <span class="math inline">\({\bf a}, {\bf b},\)</span> and <span class="math inline">\({\bf b}&#39;\)</span> be vectors in <span class="math inline">\({\mathbb F}_q^n\)</span>. Show that if RS<span class="math inline">\(_k ({\bf a},{\bf b})\)</span> and RS<span class="math inline">\(_k ({\bf a},{\bf b}&#39;)\)</span> are two Reed-Solomon codes, they are (monomially) equivalent. Deduce from this and Proposition 6.25 that [RS<span class="math inline">\(_k ({\bf a},{\bf b})]^\perp\)</span> and RS<span class="math inline">\(_{n-k} ({\bf a},{\bf b})\)</span> are equivalent.</p>
</div>
<div class="solution">
<p>For each <span class="math inline">\(f(x) \in { \bf P}_k\)</span>, we get the codeword <span class="math inline">\(\varphi_{{\bf a}, {\bf b}}\,(f(x)) = (b_1 f(a_1), \ldots, b_nf(a_n)) \in\)</span> RS<span class="math inline">\(_k ({\bf a},{\bf b})\)</span>, and the codeword <span class="math inline">\(\varphi_{{\bf a}, {\bf b}&#39;}\,(f(x)) = (b&#39;_1 f(a_1), \ldots, b&#39;_nf(a_n)) \in\)</span> RS<span class="math inline">\(_k ({\bf a},{\bf b}&#39;)\)</span>. So to make RS<span class="math inline">\(_k ({\bf a},{\bf b}&#39;)\)</span> from RS<span class="math inline">\(_k ({\bf a},{\bf b})\)</span>, we only need to multiply all entries in position <span class="math inline">\(j\)</span> by <span class="math inline">\(b&#39;_j \cdot b_j^{-1}\)</span>, for <span class="math inline">\(1 \leq j \leq n\)</span>. (We know that all <span class="math inline">\(b_j \ne 0\)</span>). By Proposition 6.25, [RS<span class="math inline">\(_k ({\bf a},{\bf b})]^\perp =\)</span> RS<span class="math inline">\(_{n-k} ({\bf a},{\bf c})\)</span> for some <span class="math inline">\({\bf c}\)</span>. But we have just shown that RS<span class="math inline">\(_{n-k} ({\bf a},{\bf c})\)</span> is (monomially) equivalent to RS<span class="math inline">\(_{n-k} ({\bf a},{\bf b})\)</span>.</p>
</div>
<div class="problem">
<p>Let <span class="math inline">\({\bf a}, {\bf a}&#39;,\)</span> and <span class="math inline">\({\bf b}\)</span> be vectors in <span class="math inline">\({\mathbb F}_q^n\)</span>, and RS<span class="math inline">\(_k ({\bf a},{\bf b})\)</span> and RS<span class="math inline">\(_k ({\bf a}&#39;,{\bf b})\)</span> be two Reed-Solomon codes. How could we pick <span class="math inline">\({\bf a}\)</span> and <span class="math inline">\({\bf a}&#39;\)</span> to make the codes (monomially) equivalent?</p>
</div>
<div class="solution">
<p>We can do this by making <span class="math inline">\({\bf a}&#39;\)</span> have the same entries as <span class="math inline">\({\bf a}\)</span>, but in a different order. In other words, for <span class="math inline">\(1\le j \le n\)</span>, we set <span class="math inline">\(a_j&#39; = a_{\sigma(j)}\)</span>, for some permutation <span class="math inline">\(\sigma\)</span> of <span class="math inline">\(\{1, \ldots, n\}\)</span>. Now we can’t just use <span class="math inline">\(\sigma\)</span> on the entries of the codewords, because that would permute the <span class="math inline">\(b_j\)</span> too. But we can go via RS<span class="math inline">\(_k ({\bf a}&#39;,{\bf 1})\)</span>, where <span class="math inline">\({\bf 1} = (1, \ldots, 1)\)</span>, as follows: By Q104, we know that RS<span class="math inline">\(_k ({\bf a},{\bf b})\)</span> is monomially equivalent to RS<span class="math inline">\(_k ({\bf a},{\bf 1})\)</span>. We then apply <span class="math inline">\(\sigma\)</span> to the entries of the codewords of RS<span class="math inline">\(_k ({\bf a},{\bf 1})\)</span>, to get the equivalent code RS<span class="math inline">\(_k ({\bf a}&#39;,{\bf 1})\)</span>, which is monomially equivalent to RS<span class="math inline">\(_k ({\bf a}&#39;,{\bf b})\)</span>. Since monomial equivalence is an equivalence relation (!), this chain of equivalences shows that RS<span class="math inline">\(_k ({\bf a},{\bf b})\)</span> and RS<span class="math inline">\(_k ({\bf a}&#39;,{\bf b})\)</span> are equivalent as required.</p>
</div>
<div class="problem">
<p>Of course, there are Reed-Solomon codes over non-prime fields. But we have a clash of notation: in Section 6.2 we used <span class="math inline">\(x\)</span> as an element of <span class="math inline">\({\mathbb F}_q\)</span>, and now in 6.5 it is the variable for our polynomials <span class="math inline">\(f(x) \in {\bf P}_k\)</span>. So here is just one small, easy question: Let <span class="math inline">\({\bf a}= (1,x,x+1), {\bf b}= (1,1,1) \in {\mathbb F}_{4}^3\)</span>. Find a generator-matrix and then a check-matrix for RS<span class="math inline">\(_2 ({\bf a},{\bf b}) \subseteq {\mathbb F}_4^3\)</span>,</p>
</div>
<div class="solution">
<p>By Proposition 6.24, <span class="math inline">\(G =
\left(\begin{matrix} 
 b_1 &amp; b_2 &amp; b_3 \\ 
 b_1a_1 &amp; b_2a_2 &amp; b_3a_3 \\
 \end{matrix}\right)=
      \left(\begin{matrix} 
 1 &amp; 1 &amp; 1 \\
 1 &amp; x &amp; x^2 \\
      \end{matrix}\right)\)</span>. Then we row reduce this, in <span class="math inline">\({\mathbb F}_4\)</span>: <span class="math inline">\(G
      \stackrel{A_{1,2}(1)}{\longrightarrow}
      \left(\begin{matrix} 
1 &amp; 1 &amp;  1 \\
0 &amp; x+1 &amp;  x \\
      \end{matrix}\right)
       \stackrel{M_{2}(x)}{\longrightarrow}
      \left(\begin{matrix} 
1 &amp; 1 &amp;  1 \\
0 &amp; 1 &amp;  x^2 \\
      \end{matrix}\right)
      \stackrel{A_{2,1}(1)}{\longrightarrow}
      \left(\begin{matrix} 
1 &amp; 0 &amp; x\\
0 &amp; 1  &amp; x^2\\
      \end{matrix}\right)\)</span> , and by Proposition 4.5 <span class="math inline">\(H = (x \;\;x+1 \;\;1)\)</span>.</p>
</div>
<script>
function doNumbering() {
	// The syntax to read the structured data from the yaml is horrible, template literals fix the problem but probably aren't widely supported enough. Escaping line breaks is browser dependant. I don't know if there's a better way?
	// Note that the data from the yaml file is manipulated into an array, and then parsed back into strings later, but I didn't want to deal with the pandoc templating syntax longer than necessary.
	var supportedEnvsArrayString = ' .definition;;; .theorem;;; .lemma;;; .example;;; .exampleqed;;; .proposition;;; .remark;;; .corollary;;; .exercise;;; .question';
	var supportedEnvsArray = supportedEnvsArrayString.split("|||");
	supportedEnvsArray = supportedEnvsArray.map(inner => inner.split(";;;"));
	var numberWithin = '1';
	var counterOffset = '';
	var subcounterOffset = '';
	var problemCounter = '77';
	const partLabels = 'abcdefghijklmnopqrstuvwxyz'.split('');
	
	// counterOffset may be negative, and by default if specified on the command line this gets string concatenated with the default given in the yaml config and this then causes a problem. Can be fixed by removing the default in the config file and converting to an int, but this causes a NaN error if no value is suplied on the command line, so if NaN set to 0.
	counterOffset = parseInt(counterOffset);
	if (isNaN(counterOffset)) {
		counterOffset = 0;
	}
	
	subcounterOffset = parseInt(subcounterOffset);
	if (isNaN(subcounterOffset)) {
		subcounterOffset = 0;
	}
	
	problemCounter = parseInt(problemCounter);
	if (isNaN(problemCounter)) {
		problemCounter = 1;
	}
	
	function sanitiseSelector(selector) {
		// tex labels often have colons in which need escaping. There may be other escaping needed here. Unfortunately neither encodeURI nor encodeURIComponent do what I need, so use regex to do the escaping manually.
		var sanitised = selector.replace(/\:/g,"\\\:");
		sanitised = sanitised.replace(/(^[\d])/,"\\3$1 ");
		sanitised = sanitised.replace(/\//g,"\\\/");
		return sanitised
	}
	
	function labelLinks() {
		var refs = document.querySelectorAll("a[data-reference-type=ref]")
		for (ref of refs) {
			// Escape colons (or other) from the link title.
			var ref_label = sanitiseSelector(ref.getAttribute("data-reference"));
			// Hopefully ref is a reference to a div or a section, which should have the associated id. If so, we just need the data-number from the relevant DOM item.
			var ref_to = document.querySelector("#"+ref_label);
			if (ref_to !== null) {
				var ref_number = ref_to.getAttribute("data-number");
			} else {
				// If ref is being used for an equation, then we need to try to parse the mathjax divs. This is fragile, but try to find the span which corresponds to the equation number we need.
				try {
					var mathjax_ref = "#mjx-eqn-"+ref_label;
					ref_to = document.querySelector(mathjax_ref);
					// Since this is a ref, we don't want the parens to be returned, so find the equation number and strip the parens.
					var ref_number = ref_to.querySelector(".mjx-char").innerHTML.replace(/[()]/g,"");
					ref.setAttribute("href",mathjax_ref);
				}
				// If we can't find a place to link to, just indicate a missing link.
				catch (err){
					var ref_number = "???"
				}
			}
			ref.innerHTML = ref_number;
		};
	}
	
	function numberEnvs() {
		for (var levelSpec = 0; levelSpec <= numberWithin; levelSpec++) {
			var reqLevels = document.querySelectorAll(".level"+levelSpec);
			for (var level of reqLevels) {
				levelCount = level.getAttribute("data-number");
				levelCount = String(parseFloat(levelCount)+(counterOffset));
				levelCount = levelCount+(("."+subcounterOffset).repeat(numberWithin-levelSpec));
				for (var counter of supportedEnvsArray) {
					var envCount = 1;
					var envs = level.querySelectorAll(counter.join(", "));
					for (var env of envs) {
						env.setAttribute("data-number",levelCount+"."+envCount);
						envCount += 1;
					}
				}
			}
		}
	}
	
	function numberFigs() {
		// Figures should either be in a figure environment, or a table with image class imageTable thanks to the tableCaps filter.
		figs = document.querySelectorAll("figure, .imageTable");
		var fig_no = 1
		for (var fig of figs) {
			var cap
			// For figures, we want to move the id to the figure, and set the data-number on both the figure and the figcaption
			if (fig.nodeName == "FIGURE") {
				cap = fig.querySelector("figcaption");
				var img = fig.querySelector("img, embed")
				if (img) {
					var img_id = img.getAttribute("id");
					fig.setAttribute("id",img_id);
					img.removeAttribute("id");
				}
			// for tables (which must be .imageTable due to the querySelector above), we want to set the data-number on the table and the caption
			} else if (fig.nodeName == "TABLE") {
				cap = fig.querySelector("caption");
			}
			cap.setAttribute("data-number",fig_no);
			fig.setAttribute("data-number",fig_no);
			fig_no += 1;
		}
	}
	
	function numberGlobals() {
		// This function numbers any environments that just use a global counter, such as a problem number on a problems sheet, where there are no sections to number with respect to.
		probsols = document.querySelectorAll(".problem, .solution");
		var prob_no = problemCounter;
		var partNo = 0;
		for (var probsol of probsols) {
			if (probsol.className == "problem"){
				prob_no +=1;
				partNo = 0;
				probsol.setAttribute("data-number",prob_no);
			}
			else {
				if (probsol.parentNode.nodeName == "LI") {
					var partLabel = partLabels[partNo];
					probsol.setAttribute("data-number",prob_no.toString()+partLabel);
					partNo +=1;
				}
				else{
					probsol.setAttribute("data-number",prob_no);
				}
			}
			
		}
		// sols = document.querySelectorAll(".solution");
// 		var sol_no = problemCounter;
// 		for (var sol of sols) {
// 			sol.setAttribute("data-number",sol_no);
// 			sol_no +=1
// 		}
	}
	
	// labelLinks() should occur last, so that the data-numbers have been correctly set first.
	numberEnvs();
	numberFigs();
	numberGlobals();
	labelLinks();
}
</script><script>
	var imageDir = ''
	imgs = document.querySelectorAll("img");
	for (var img of imgs) {
		imgsrc = img.getAttribute("src");
		img.setAttribute("src",imageDir.concat(imgsrc));
	}
</script></body>
</html>
